var Sm=p=>{throw TypeError(p)};var _u=(p,t,i)=>t.has(p)||Sm("Cannot "+i);var Kt=(p,t,i)=>(_u(p,t,"read from private field"),i?i.call(p):t.get(p)),_i=(p,t,i)=>t.has(p)?Sm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(p):t.set(p,i),Pe=(p,t,i,n)=>(_u(p,t,"write to private field"),n?n.call(p,i):t.set(p,i),i),xi=(p,t,i)=>(_u(p,t,"access private method"),i);var wm=(p,t,i,n)=>({set _(r){Pe(p,t,r,i)},get _(){return Kt(p,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();var xu={exports:{}},Ya={};var _m;function yv(){if(_m)return Ya;_m=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(n,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:p,type:n,key:c,ref:r!==void 0?r:null,props:l}}return Ya.Fragment=t,Ya.jsx=i,Ya.jsxs=i,Ya}var xm;function bv(){return xm||(xm=1,xu.exports=yv()),xu.exports}var S=bv(),Eu={exports:{}},mt={};var Em;function vv(){if(Em)return mt;Em=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(k){return k===null||typeof k!="object"?null:(k=b&&k[b]||k["@@iterator"],typeof k=="function"?k:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,C={};function _(k,H,q){this.props=k,this.context=H,this.refs=C,this.updater=q||x}_.prototype.isReactComponent={},_.prototype.setState=function(k,H){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,H,"setState")},_.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function M(){}M.prototype=_.prototype;function T(k,H,q){this.props=k,this.context=H,this.refs=C,this.updater=q||x}var R=T.prototype=new M;R.constructor=T,w(R,_.prototype),R.isPureReactComponent=!0;var O=Array.isArray;function N(){}var j={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function $(k,H,q){var W=q.ref;return{$$typeof:p,type:k,key:H,ref:W!==void 0?W:null,props:q}}function J(k,H){return $(k.type,H,k.props)}function tt(k){return typeof k=="object"&&k!==null&&k.$$typeof===p}function it(k){var H={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(q){return H[q]})}var pt=/\/+/g;function ht(k,H){return typeof k=="object"&&k!==null&&k.key!=null?it(""+k.key):H.toString(36)}function vt(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(N,N):(k.status="pending",k.then(function(H){k.status==="pending"&&(k.status="fulfilled",k.value=H)},function(H){k.status==="pending"&&(k.status="rejected",k.reason=H)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function B(k,H,q,W,st){var ot=typeof k;(ot==="undefined"||ot==="boolean")&&(k=null);var Q=!1;if(k===null)Q=!0;else switch(ot){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(k.$$typeof){case p:case t:Q=!0;break;case g:return Q=k._init,B(Q(k._payload),H,q,W,st)}}if(Q)return st=st(k),Q=W===""?"."+ht(k,0):W,O(st)?(q="",Q!=null&&(q=Q.replace(pt,"$&/")+"/"),B(st,H,q,"",function(Ms){return Ms})):st!=null&&(tt(st)&&(st=J(st,q+(st.key==null||k&&k.key===st.key?"":(""+st.key).replace(pt,"$&/")+"/")+Q)),H.push(st)),1;Q=0;var Nt=W===""?".":W+":";if(O(k))for(var Rt=0;Rt<k.length;Rt++)W=k[Rt],ot=Nt+ht(W,Rt),Q+=B(W,H,q,ot,st);else if(Rt=A(k),typeof Rt=="function")for(k=Rt.call(k),Rt=0;!(W=k.next()).done;)W=W.value,ot=Nt+ht(W,Rt++),Q+=B(W,H,q,ot,st);else if(ot==="object"){if(typeof k.then=="function")return B(vt(k),H,q,W,st);throw H=String(k),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return Q}function G(k,H,q){if(k==null)return k;var W=[],st=0;return B(k,W,"","",function(ot){return H.call(q,ot,st++)}),W}function Z(k){if(k._status===-1){var H=k._result;H=H(),H.then(function(q){(k._status===0||k._status===-1)&&(k._status=1,k._result=q)},function(q){(k._status===0||k._status===-1)&&(k._status=2,k._result=q)}),k._status===-1&&(k._status=0,k._result=H)}if(k._status===1)return k._result.default;throw k._result}var ft=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},St={map:G,forEach:function(k,H,q){G(k,function(){H.apply(this,arguments)},q)},count:function(k){var H=0;return G(k,function(){H++}),H},toArray:function(k){return G(k,function(H){return H})||[]},only:function(k){if(!tt(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return mt.Activity=y,mt.Children=St,mt.Component=_,mt.Fragment=i,mt.Profiler=r,mt.PureComponent=T,mt.StrictMode=n,mt.Suspense=h,mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,mt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return j.H.useMemoCache(k)}},mt.cache=function(k){return function(){return k.apply(null,arguments)}},mt.cacheSignal=function(){return null},mt.cloneElement=function(k,H,q){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var W=w({},k.props),st=k.key;if(H!=null)for(ot in H.key!==void 0&&(st=""+H.key),H)!V.call(H,ot)||ot==="key"||ot==="__self"||ot==="__source"||ot==="ref"&&H.ref===void 0||(W[ot]=H[ot]);var ot=arguments.length-2;if(ot===1)W.children=q;else if(1<ot){for(var Q=Array(ot),Nt=0;Nt<ot;Nt++)Q[Nt]=arguments[Nt+2];W.children=Q}return $(k.type,st,W)},mt.createContext=function(k){return k={$$typeof:c,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:l,_context:k},k},mt.createElement=function(k,H,q){var W,st={},ot=null;if(H!=null)for(W in H.key!==void 0&&(ot=""+H.key),H)V.call(H,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(st[W]=H[W]);var Q=arguments.length-2;if(Q===1)st.children=q;else if(1<Q){for(var Nt=Array(Q),Rt=0;Rt<Q;Rt++)Nt[Rt]=arguments[Rt+2];st.children=Nt}if(k&&k.defaultProps)for(W in Q=k.defaultProps,Q)st[W]===void 0&&(st[W]=Q[W]);return $(k,ot,st)},mt.createRef=function(){return{current:null}},mt.forwardRef=function(k){return{$$typeof:u,render:k}},mt.isValidElement=tt,mt.lazy=function(k){return{$$typeof:g,_payload:{_status:-1,_result:k},_init:Z}},mt.memo=function(k,H){return{$$typeof:f,type:k,compare:H===void 0?null:H}},mt.startTransition=function(k){var H=j.T,q={};j.T=q;try{var W=k(),st=j.S;st!==null&&st(q,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(N,ft)}catch(ot){ft(ot)}finally{H!==null&&q.types!==null&&(H.types=q.types),j.T=H}},mt.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},mt.use=function(k){return j.H.use(k)},mt.useActionState=function(k,H,q){return j.H.useActionState(k,H,q)},mt.useCallback=function(k,H){return j.H.useCallback(k,H)},mt.useContext=function(k){return j.H.useContext(k)},mt.useDebugValue=function(){},mt.useDeferredValue=function(k,H){return j.H.useDeferredValue(k,H)},mt.useEffect=function(k,H){return j.H.useEffect(k,H)},mt.useEffectEvent=function(k){return j.H.useEffectEvent(k)},mt.useId=function(){return j.H.useId()},mt.useImperativeHandle=function(k,H,q){return j.H.useImperativeHandle(k,H,q)},mt.useInsertionEffect=function(k,H){return j.H.useInsertionEffect(k,H)},mt.useLayoutEffect=function(k,H){return j.H.useLayoutEffect(k,H)},mt.useMemo=function(k,H){return j.H.useMemo(k,H)},mt.useOptimistic=function(k,H){return j.H.useOptimistic(k,H)},mt.useReducer=function(k,H,q){return j.H.useReducer(k,H,q)},mt.useRef=function(k){return j.H.useRef(k)},mt.useState=function(k){return j.H.useState(k)},mt.useSyncExternalStore=function(k,H,q){return j.H.useSyncExternalStore(k,H,q)},mt.useTransition=function(){return j.H.useTransition()},mt.version="19.2.3",mt}var Cm;function sh(){return Cm||(Cm=1,Eu.exports=vv()),Eu.exports}var et=sh(),Cu={exports:{}},Ka={},Tu={exports:{}},Mu={};var Tm;function Av(){return Tm||(Tm=1,(function(p){function t(B,G){var Z=B.length;B.push(G);t:for(;0<Z;){var ft=Z-1>>>1,St=B[ft];if(0<r(St,G))B[ft]=G,B[Z]=St,Z=ft;else break t}}function i(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var G=B[0],Z=B.pop();if(Z!==G){B[0]=Z;t:for(var ft=0,St=B.length,k=St>>>1;ft<k;){var H=2*(ft+1)-1,q=B[H],W=H+1,st=B[W];if(0>r(q,Z))W<St&&0>r(st,q)?(B[ft]=st,B[W]=Z,ft=W):(B[ft]=q,B[H]=Z,ft=H);else if(W<St&&0>r(st,Z))B[ft]=st,B[W]=Z,ft=W;else break t}}return G}function r(B,G){var Z=B.sortIndex-G.sortIndex;return Z!==0?Z:B.id-G.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;p.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();p.unstable_now=function(){return c.now()-u}}var h=[],f=[],g=1,y=null,b=3,A=!1,x=!1,w=!1,C=!1,_=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function R(B){for(var G=i(f);G!==null;){if(G.callback===null)n(f);else if(G.startTime<=B)n(f),G.sortIndex=G.expirationTime,t(h,G);else break;G=i(f)}}function O(B){if(w=!1,R(B),!x)if(i(h)!==null)x=!0,N||(N=!0,it());else{var G=i(f);G!==null&&vt(O,G.startTime-B)}}var N=!1,j=-1,V=5,$=-1;function J(){return C?!0:!(p.unstable_now()-$<V)}function tt(){if(C=!1,N){var B=p.unstable_now();$=B;var G=!0;try{t:{x=!1,w&&(w=!1,M(j),j=-1),A=!0;var Z=b;try{e:{for(R(B),y=i(h);y!==null&&!(y.expirationTime>B&&J());){var ft=y.callback;if(typeof ft=="function"){y.callback=null,b=y.priorityLevel;var St=ft(y.expirationTime<=B);if(B=p.unstable_now(),typeof St=="function"){y.callback=St,R(B),G=!0;break e}y===i(h)&&n(h),R(B)}else n(h);y=i(h)}if(y!==null)G=!0;else{var k=i(f);k!==null&&vt(O,k.startTime-B),G=!1}}break t}finally{y=null,b=Z,A=!1}G=void 0}}finally{G?it():N=!1}}}var it;if(typeof T=="function")it=function(){T(tt)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,ht=pt.port2;pt.port1.onmessage=tt,it=function(){ht.postMessage(null)}}else it=function(){_(tt,0)};function vt(B,G){j=_(function(){B(p.unstable_now())},G)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(B){B.callback=null},p.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<B?Math.floor(1e3/B):5},p.unstable_getCurrentPriorityLevel=function(){return b},p.unstable_next=function(B){switch(b){case 1:case 2:case 3:var G=3;break;default:G=b}var Z=b;b=G;try{return B()}finally{b=Z}},p.unstable_requestPaint=function(){C=!0},p.unstable_runWithPriority=function(B,G){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Z=b;b=B;try{return G()}finally{b=Z}},p.unstable_scheduleCallback=function(B,G,Z){var ft=p.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ft+Z:ft):Z=ft,B){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=Z+St,B={id:g++,callback:G,priorityLevel:B,startTime:Z,expirationTime:St,sortIndex:-1},Z>ft?(B.sortIndex=Z,t(f,B),i(h)===null&&B===i(f)&&(w?(M(j),j=-1):w=!0,vt(O,Z-ft))):(B.sortIndex=St,t(h,B),x||A||(x=!0,N||(N=!0,it()))),B},p.unstable_shouldYield=J,p.unstable_wrapCallback=function(B){var G=b;return function(){var Z=b;b=G;try{return B.apply(this,arguments)}finally{b=Z}}}})(Mu)),Mu}var Mm;function Sv(){return Mm||(Mm=1,Tu.exports=Av()),Tu.exports}var Du={exports:{}},Ee={};var Dm;function wv(){if(Dm)return Ee;Dm=1;var p=sh();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var n={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(h,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:h,containerInfo:f,implementation:g}}var c=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ee.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Ee.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,g)},Ee.flushSync=function(h){var f=c.T,g=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=f,n.p=g,n.d.f()}},Ee.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Ee.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Ee.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,y=u(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ee.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=u(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Ee.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=u(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ee.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=u(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Ee.requestFormReset=function(h){n.d.r(h)},Ee.unstable_batchedUpdates=function(h,f){return h(f)},Ee.useFormState=function(h,f,g){return c.H.useFormState(h,f,g)},Ee.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ee.version="19.2.3",Ee}var Nm;function _v(){if(Nm)return Du.exports;Nm=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Du.exports=wv(),Du.exports}var Rm;function xv(){if(Rm)return Ka;Rm=1;var p=Sv(),t=sh(),i=_v();function n(e){var s="https://react.dev/errors/"+e;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var s=e,a=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,(s.flags&4098)!==0&&(a=s.return),e=s.return;while(e)}return s.tag===3?a:null}function c(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function u(e){if(e.tag===31){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(n(188))}function f(e){var s=e.alternate;if(!s){if(s=l(e),s===null)throw Error(n(188));return s!==e?null:e}for(var a=e,o=s;;){var d=a.return;if(d===null)break;var m=d.alternate;if(m===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===a)return h(d),e;if(m===o)return h(d),s;m=m.sibling}throw Error(n(188))}if(a.return!==o.return)a=d,o=m;else{for(var v=!1,E=d.child;E;){if(E===a){v=!0,a=d,o=m;break}if(E===o){v=!0,o=d,a=m;break}E=E.sibling}if(!v){for(E=m.child;E;){if(E===a){v=!0,a=m,o=d;break}if(E===o){v=!0,o=m,a=d;break}E=E.sibling}if(!v)throw Error(n(189))}}if(a.alternate!==o)throw Error(n(190))}if(a.tag!==3)throw Error(n(188));return a.stateNode.current===a?e:s}function g(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e;for(e=e.child;e!==null;){if(s=g(e),s!==null)return s;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),tt=Symbol.iterator;function it(e){return e===null||typeof e!="object"?null:(e=tt&&e[tt]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Symbol.for("react.client.reference");function ht(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===pt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case _:return"Profiler";case C:return"StrictMode";case O:return"Suspense";case N:return"SuspenseList";case $:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case T:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case R:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case j:return s=e.displayName||null,s!==null?s:ht(e.type)||"Memo";case V:s=e._payload,e=e._init;try{return ht(e(s))}catch{}}return null}var vt=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},ft=[],St=-1;function k(e){return{current:e}}function H(e){0>St||(e.current=ft[St],ft[St]=null,St--)}function q(e,s){St++,ft[St]=e.current,e.current=s}var W=k(null),st=k(null),ot=k(null),Q=k(null);function Nt(e,s){switch(q(ot,s),q(st,e),q(W,null),s.nodeType){case 9:case 11:e=(e=s.documentElement)&&(e=e.namespaceURI)?qp(e):0;break;default:if(e=s.tagName,s=s.namespaceURI)s=qp(s),e=Vp(s,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(W),q(W,e)}function Rt(){H(W),H(st),H(ot)}function Ms(e){e.memoizedState!==null&&q(Q,e);var s=W.current,a=Vp(s,e.type);s!==a&&(q(st,e),q(W,a))}function Zi(e){st.current===e&&(H(W),H(st)),Q.current===e&&(H(Q),Ga._currentValue=Z)}var Ds,ta;function Ni(e){if(Ds===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);Ds=s&&s[1]||"",ta=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ds+e+ta}var ao=!1;function ro(e,s){if(!e||ao)return"";ao=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(s){var K=function(){throw Error()};if(Object.defineProperty(K.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(K,[])}catch(I){var U=I}Reflect.construct(e,[],K)}else{try{K.call()}catch(I){U=I}e.call(K.prototype)}}else{try{throw Error()}catch(I){U=I}(K=e())&&typeof K.catch=="function"&&K.catch(function(){})}}catch(I){if(I&&U&&typeof I.stack=="string")return[I.stack,U.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=o.DetermineComponentFrameRoot(),v=m[0],E=m[1];if(v&&E){var D=v.split(`
`),F=E.split(`
`);for(d=o=0;o<D.length&&!D[o].includes("DetermineComponentFrameRoot");)o++;for(;d<F.length&&!F[d].includes("DetermineComponentFrameRoot");)d++;if(o===D.length||d===F.length)for(o=D.length-1,d=F.length-1;1<=o&&0<=d&&D[o]!==F[d];)d--;for(;1<=o&&0<=d;o--,d--)if(D[o]!==F[d]){if(o!==1||d!==1)do if(o--,d--,0>d||D[o]!==F[d]){var X=`
`+D[o].replace(" at new "," at ");return e.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",e.displayName)),X}while(1<=o&&0<=d);break}}}finally{ao=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ni(a):""}function Kg(e,s){switch(e.tag){case 26:case 27:case 5:return Ni(e.type);case 16:return Ni("Lazy");case 13:return e.child!==s&&s!==null?Ni("Suspense Fallback"):Ni("Suspense");case 19:return Ni("SuspenseList");case 0:case 15:return ro(e.type,!1);case 11:return ro(e.type.render,!1);case 1:return ro(e.type,!0);case 31:return Ni("Activity");default:return""}}function Ah(e){try{var s="",a=null;do s+=Kg(e,a),a=e,e=e.return;while(e);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var lo=Object.prototype.hasOwnProperty,oo=p.unstable_scheduleCallback,co=p.unstable_cancelCallback,$g=p.unstable_shouldYield,Qg=p.unstable_requestPaint,He=p.unstable_now,Wg=p.unstable_getCurrentPriorityLevel,Sh=p.unstable_ImmediatePriority,wh=p.unstable_UserBlockingPriority,yr=p.unstable_NormalPriority,Zg=p.unstable_LowPriority,_h=p.unstable_IdlePriority,Jg=p.log,ty=p.unstable_setDisableYieldValue,ea=null,Ge=null;function Ji(e){if(typeof Jg=="function"&&ty(e),Ge&&typeof Ge.setStrictMode=="function")try{Ge.setStrictMode(ea,e)}catch{}}var qe=Math.clz32?Math.clz32:sy,ey=Math.log,iy=Math.LN2;function sy(e){return e>>>=0,e===0?32:31-(ey(e)/iy|0)|0}var br=256,vr=262144,Ar=4194304;function Ns(e){var s=e&42;if(s!==0)return s;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Sr(e,s,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,m=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var E=o&134217727;return E!==0?(o=E&~m,o!==0?d=Ns(o):(v&=E,v!==0?d=Ns(v):a||(a=E&~e,a!==0&&(d=Ns(a))))):(E=o&~m,E!==0?d=Ns(E):v!==0?d=Ns(v):a||(a=o&~e,a!==0&&(d=Ns(a)))),d===0?0:s!==0&&s!==d&&(s&m)===0&&(m=d&-d,a=s&-s,m>=a||m===32&&(a&4194048)!==0)?s:d}function ia(e,s){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&s)===0}function ny(e,s){switch(e){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xh(){var e=Ar;return Ar<<=1,(Ar&62914560)===0&&(Ar=4194304),e}function uo(e){for(var s=[],a=0;31>a;a++)s.push(e);return s}function sa(e,s){e.pendingLanes|=s,s!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ay(e,s,a,o,d,m){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var E=e.entanglements,D=e.expirationTimes,F=e.hiddenUpdates;for(a=v&~a;0<a;){var X=31-qe(a),K=1<<X;E[X]=0,D[X]=-1;var U=F[X];if(U!==null)for(F[X]=null,X=0;X<U.length;X++){var I=U[X];I!==null&&(I.lane&=-536870913)}a&=~K}o!==0&&Eh(e,o,0),m!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=m&~(v&~s))}function Eh(e,s,a){e.pendingLanes|=s,e.suspendedLanes&=~s;var o=31-qe(s);e.entangledLanes|=s,e.entanglements[o]=e.entanglements[o]|1073741824|a&261930}function Ch(e,s){var a=e.entangledLanes|=s;for(e=e.entanglements;a;){var o=31-qe(a),d=1<<o;d&s|e[o]&s&&(e[o]|=s),a&=~d}}function Th(e,s){var a=s&-s;return a=(a&42)!==0?1:ho(a),(a&(e.suspendedLanes|s))!==0?0:a}function ho(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function fo(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Mh(){var e=G.p;return e!==0?e:(e=window.event,e===void 0?32:pm(e.type))}function Dh(e,s){var a=G.p;try{return G.p=e,s()}finally{G.p=a}}var ts=Math.random().toString(36).slice(2),ge="__reactFiber$"+ts,Re="__reactProps$"+ts,sn="__reactContainer$"+ts,po="__reactEvents$"+ts,ry="__reactListeners$"+ts,ly="__reactHandles$"+ts,Nh="__reactResources$"+ts,na="__reactMarker$"+ts;function mo(e){delete e[ge],delete e[Re],delete e[po],delete e[ry],delete e[ly]}function nn(e){var s=e[ge];if(s)return s;for(var a=e.parentNode;a;){if(s=a[sn]||a[ge]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(e=Zp(e);e!==null;){if(a=e[ge])return a;e=Zp(e)}return s}e=a,a=e.parentNode}return null}function an(e){if(e=e[ge]||e[sn]){var s=e.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return e}return null}function aa(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e.stateNode;throw Error(n(33))}function rn(e){var s=e[Nh];return s||(s=e[Nh]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function de(e){e[na]=!0}var Rh=new Set,Oh={};function Rs(e,s){ln(e,s),ln(e+"Capture",s)}function ln(e,s){for(Oh[e]=s,e=0;e<s.length;e++)Rh.add(s[e])}var oy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kh={},Lh={};function cy(e){return lo.call(Lh,e)?!0:lo.call(kh,e)?!1:oy.test(e)?Lh[e]=!0:(kh[e]=!0,!1)}function wr(e,s,a){if(cy(s))if(a===null)e.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(s);return;case"boolean":var o=s.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(s);return}}e.setAttribute(s,""+a)}}function _r(e,s,a){if(a===null)e.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttribute(s,""+a)}}function Ri(e,s,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(s,a,""+o)}}function ti(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Bh(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function uy(e,s,a){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,s);if(!e.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,m=o.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,m.call(this,v)}}),Object.defineProperty(e,s,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function go(e){if(!e._valueTracker){var s=Bh(e)?"checked":"value";e._valueTracker=uy(e,s,""+e[s])}}function jh(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var a=s.getValue(),o="";return e&&(o=Bh(e)?e.checked?"true":"false":e.value),e=o,e!==a?(s.setValue(e),!0):!1}function xr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var hy=/[\n"\\]/g;function ei(e){return e.replace(hy,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function yo(e,s,a,o,d,m,v,E){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),s!=null?v==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+ti(s)):e.value!==""+ti(s)&&(e.value=""+ti(s)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),s!=null?bo(e,v,ti(s)):a!=null?bo(e,v,ti(a)):o!=null&&e.removeAttribute("value"),d==null&&m!=null&&(e.defaultChecked=!!m),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+ti(E):e.removeAttribute("name")}function zh(e,s,a,o,d,m,v,E){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.type=m),s!=null||a!=null){if(!(m!=="submit"&&m!=="reset"||s!=null)){go(e);return}a=a!=null?""+ti(a):"",s=s!=null?""+ti(s):a,E||s===e.value||(e.value=s),e.defaultValue=s}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=E?e.checked:!!o,e.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),go(e)}function bo(e,s,a){s==="number"&&xr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function on(e,s,a,o){if(e=e.options,s){s={};for(var d=0;d<a.length;d++)s["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=s.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+ti(a),s=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}s!==null||e[d].disabled||(s=e[d])}s!==null&&(s.selected=!0)}}function Ph(e,s,a){if(s!=null&&(s=""+ti(s),s!==e.value&&(e.value=s),a==null)){e.defaultValue!==s&&(e.defaultValue=s);return}e.defaultValue=a!=null?""+ti(a):""}function Fh(e,s,a,o){if(s==null){if(o!=null){if(a!=null)throw Error(n(92));if(vt(o)){if(1<o.length)throw Error(n(93));o=o[0]}a=o}a==null&&(a=""),s=a}a=ti(s),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o),go(e)}function cn(e,s){if(s){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=s;return}}e.textContent=s}var dy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Uh(e,s,a){var o=s.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="":o?e.setProperty(s,a):typeof a!="number"||a===0||dy.has(s)?s==="float"?e.cssFloat=a:e[s]=(""+a).trim():e[s]=a+"px"}function Ih(e,s,a){if(s!=null&&typeof s!="object")throw Error(n(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||s!=null&&s.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in s)o=s[d],s.hasOwnProperty(d)&&a[d]!==o&&Uh(e,d,o)}else for(var m in s)s.hasOwnProperty(m)&&Uh(e,m,s[m])}function vo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),py=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Er(e){return py.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Oi(){}var Ao=null;function So(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var un=null,hn=null;function Hh(e){var s=an(e);if(s&&(e=s.stateNode)){var a=e[Re]||null;t:switch(e=s.stateNode,s.type){case"input":if(yo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),s=a.name,a.type==="radio"&&s!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+ei(""+s)+'"][type="radio"]'),s=0;s<a.length;s++){var o=a[s];if(o!==e&&o.form===e.form){var d=o[Re]||null;if(!d)throw Error(n(90));yo(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(s=0;s<a.length;s++)o=a[s],o.form===e.form&&jh(o)}break t;case"textarea":Ph(e,a.value,a.defaultValue);break t;case"select":s=a.value,s!=null&&on(e,!!a.multiple,s,!1)}}}var wo=!1;function Gh(e,s,a){if(wo)return e(s,a);wo=!0;try{var o=e(s);return o}finally{if(wo=!1,(un!==null||hn!==null)&&(dl(),un&&(s=un,e=hn,hn=un=null,Hh(s),e)))for(s=0;s<e.length;s++)Hh(e[s])}}function ra(e,s){var a=e.stateNode;if(a===null)return null;var o=a[Re]||null;if(o===null)return null;a=o[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(n(231,s,typeof a));return a}var ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_o=!1;if(ki)try{var la={};Object.defineProperty(la,"passive",{get:function(){_o=!0}}),window.addEventListener("test",la,la),window.removeEventListener("test",la,la)}catch{_o=!1}var es=null,xo=null,Cr=null;function qh(){if(Cr)return Cr;var e,s=xo,a=s.length,o,d="value"in es?es.value:es.textContent,m=d.length;for(e=0;e<a&&s[e]===d[e];e++);var v=a-e;for(o=1;o<=v&&s[a-o]===d[m-o];o++);return Cr=d.slice(e,1<o?1-o:void 0)}function Tr(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function Mr(){return!0}function Vh(){return!1}function Oe(e){function s(a,o,d,m,v){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(a=e[E],this[E]=a?a(m):m[E]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Mr:Vh,this.isPropagationStopped=Vh,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Mr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Mr)},persist:function(){},isPersistent:Mr}),s}var Os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dr=Oe(Os),oa=y({},Os,{view:0,detail:0}),my=Oe(oa),Eo,Co,ca,Nr=y({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ca&&(ca&&e.type==="mousemove"?(Eo=e.screenX-ca.screenX,Co=e.screenY-ca.screenY):Co=Eo=0,ca=e),Eo)},movementY:function(e){return"movementY"in e?e.movementY:Co}}),Xh=Oe(Nr),gy=y({},Nr,{dataTransfer:0}),yy=Oe(gy),by=y({},oa,{relatedTarget:0}),To=Oe(by),vy=y({},Os,{animationName:0,elapsedTime:0,pseudoElement:0}),Ay=Oe(vy),Sy=y({},Os,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wy=Oe(Sy),_y=y({},Os,{data:0}),Yh=Oe(_y),xy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ty(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=Cy[e])?!!s[e]:!1}function Mo(){return Ty}var My=y({},oa,{key:function(e){if(e.key){var s=xy[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=Tr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ey[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mo,charCode:function(e){return e.type==="keypress"?Tr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dy=Oe(My),Ny=y({},Nr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kh=Oe(Ny),Ry=y({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mo}),Oy=Oe(Ry),ky=y({},Os,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ly=Oe(ky),By=y({},Nr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jy=Oe(By),zy=y({},Os,{newState:0,oldState:0}),Py=Oe(zy),Fy=[9,13,27,32],Do=ki&&"CompositionEvent"in window,ua=null;ki&&"documentMode"in document&&(ua=document.documentMode);var Uy=ki&&"TextEvent"in window&&!ua,$h=ki&&(!Do||ua&&8<ua&&11>=ua),Qh=" ",Wh=!1;function Zh(e,s){switch(e){case"keyup":return Fy.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var dn=!1;function Iy(e,s){switch(e){case"compositionend":return Jh(s);case"keypress":return s.which!==32?null:(Wh=!0,Qh);case"textInput":return e=s.data,e===Qh&&Wh?null:e;default:return null}}function Hy(e,s){if(dn)return e==="compositionend"||!Do&&Zh(e,s)?(e=qh(),Cr=xo=es=null,dn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return $h&&s.locale!=="ko"?null:s.data;default:return null}}var Gy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function td(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!Gy[e.type]:s==="textarea"}function ed(e,s,a,o){un?hn?hn.push(o):hn=[o]:un=o,s=vl(s,"onChange"),0<s.length&&(a=new Dr("onChange","change",null,a,o),e.push({event:a,listeners:s}))}var ha=null,da=null;function qy(e){Pp(e,0)}function Rr(e){var s=aa(e);if(jh(s))return e}function id(e,s){if(e==="change")return s}var sd=!1;if(ki){var No;if(ki){var Ro="oninput"in document;if(!Ro){var nd=document.createElement("div");nd.setAttribute("oninput","return;"),Ro=typeof nd.oninput=="function"}No=Ro}else No=!1;sd=No&&(!document.documentMode||9<document.documentMode)}function ad(){ha&&(ha.detachEvent("onpropertychange",rd),da=ha=null)}function rd(e){if(e.propertyName==="value"&&Rr(da)){var s=[];ed(s,da,e,So(e)),Gh(qy,s)}}function Vy(e,s,a){e==="focusin"?(ad(),ha=s,da=a,ha.attachEvent("onpropertychange",rd)):e==="focusout"&&ad()}function Xy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rr(da)}function Yy(e,s){if(e==="click")return Rr(s)}function Ky(e,s){if(e==="input"||e==="change")return Rr(s)}function $y(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var Ve=typeof Object.is=="function"?Object.is:$y;function fa(e,s){if(Ve(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var a=Object.keys(e),o=Object.keys(s);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!lo.call(s,d)||!Ve(e[d],s[d]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,s){var a=ld(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=s&&o>=s)return{node:a,offset:s-e};e=o}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=ld(a)}}function cd(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?cd(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function ud(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var s=xr(e.document);s instanceof e.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)e=s.contentWindow;else break;s=xr(e.document)}return s}function Oo(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}var Qy=ki&&"documentMode"in document&&11>=document.documentMode,fn=null,ko=null,pa=null,Lo=!1;function hd(e,s,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Lo||fn==null||fn!==xr(o)||(o=fn,"selectionStart"in o&&Oo(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),pa&&fa(pa,o)||(pa=o,o=vl(ko,"onSelect"),0<o.length&&(s=new Dr("onSelect","select",null,s,a),e.push({event:s,listeners:o}),s.target=fn)))}function ks(e,s){var a={};return a[e.toLowerCase()]=s.toLowerCase(),a["Webkit"+e]="webkit"+s,a["Moz"+e]="moz"+s,a}var pn={animationend:ks("Animation","AnimationEnd"),animationiteration:ks("Animation","AnimationIteration"),animationstart:ks("Animation","AnimationStart"),transitionrun:ks("Transition","TransitionRun"),transitionstart:ks("Transition","TransitionStart"),transitioncancel:ks("Transition","TransitionCancel"),transitionend:ks("Transition","TransitionEnd")},Bo={},dd={};ki&&(dd=document.createElement("div").style,"AnimationEvent"in window||(delete pn.animationend.animation,delete pn.animationiteration.animation,delete pn.animationstart.animation),"TransitionEvent"in window||delete pn.transitionend.transition);function Ls(e){if(Bo[e])return Bo[e];if(!pn[e])return e;var s=pn[e],a;for(a in s)if(s.hasOwnProperty(a)&&a in dd)return Bo[e]=s[a];return e}var fd=Ls("animationend"),pd=Ls("animationiteration"),md=Ls("animationstart"),Wy=Ls("transitionrun"),Zy=Ls("transitionstart"),Jy=Ls("transitioncancel"),gd=Ls("transitionend"),yd=new Map,jo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jo.push("scrollEnd");function mi(e,s){yd.set(e,s),Rs(s,[e])}var Or=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ii=[],mn=0,zo=0;function kr(){for(var e=mn,s=zo=mn=0;s<e;){var a=ii[s];ii[s++]=null;var o=ii[s];ii[s++]=null;var d=ii[s];ii[s++]=null;var m=ii[s];if(ii[s++]=null,o!==null&&d!==null){var v=o.pending;v===null?d.next=d:(d.next=v.next,v.next=d),o.pending=d}m!==0&&bd(a,d,m)}}function Lr(e,s,a,o){ii[mn++]=e,ii[mn++]=s,ii[mn++]=a,ii[mn++]=o,zo|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Po(e,s,a,o){return Lr(e,s,a,o),Br(e)}function Bs(e,s){return Lr(e,null,null,s),Br(e)}function bd(e,s,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,m=e.return;m!==null;)m.childLanes|=a,o=m.alternate,o!==null&&(o.childLanes|=a),m.tag===22&&(e=m.stateNode,e===null||e._visibility&1||(d=!0)),e=m,m=m.return;return e.tag===3?(m=e.stateNode,d&&s!==null&&(d=31-qe(a),e=m.hiddenUpdates,o=e[d],o===null?e[d]=[s]:o.push(s),s.lane=a|536870912),m):null}function Br(e){if(50<ja)throw ja=0,Yc=null,Error(n(185));for(var s=e.return;s!==null;)e=s,s=e.return;return e.tag===3?e.stateNode:null}var gn={};function tb(e,s,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xe(e,s,a,o){return new tb(e,s,a,o)}function Fo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Li(e,s){var a=e.alternate;return a===null?(a=Xe(e.tag,s,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=s,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,s=e.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function vd(e,s){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=s,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,s=a.dependencies,e.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),e}function jr(e,s,a,o,d,m){var v=0;if(o=e,typeof e=="function")Fo(e)&&(v=1);else if(typeof e=="string")v=av(e,a,W.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case $:return e=Xe(31,a,s,d),e.elementType=$,e.lanes=m,e;case w:return js(a.children,d,m,s);case C:v=8,d|=24;break;case _:return e=Xe(12,a,s,d|2),e.elementType=_,e.lanes=m,e;case O:return e=Xe(13,a,s,d),e.elementType=O,e.lanes=m,e;case N:return e=Xe(19,a,s,d),e.elementType=N,e.lanes=m,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break t;case M:v=9;break t;case R:v=11;break t;case j:v=14;break t;case V:v=16,o=null;break t}v=29,a=Error(n(130,e===null?"null":typeof e,"")),o=null}return s=Xe(v,a,s,d),s.elementType=e,s.type=o,s.lanes=m,s}function js(e,s,a,o){return e=Xe(7,e,o,s),e.lanes=a,e}function Uo(e,s,a){return e=Xe(6,e,null,s),e.lanes=a,e}function Ad(e){var s=Xe(18,null,null,0);return s.stateNode=e,s}function Io(e,s,a){return s=Xe(4,e.children!==null?e.children:[],e.key,s),s.lanes=a,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}var Sd=new WeakMap;function si(e,s){if(typeof e=="object"&&e!==null){var a=Sd.get(e);return a!==void 0?a:(s={value:e,source:s,stack:Ah(s)},Sd.set(e,s),s)}return{value:e,source:s,stack:Ah(s)}}var yn=[],bn=0,zr=null,ma=0,ni=[],ai=0,is=null,vi=1,Ai="";function Bi(e,s){yn[bn++]=ma,yn[bn++]=zr,zr=e,ma=s}function wd(e,s,a){ni[ai++]=vi,ni[ai++]=Ai,ni[ai++]=is,is=e;var o=vi;e=Ai;var d=32-qe(o)-1;o&=~(1<<d),a+=1;var m=32-qe(s)+d;if(30<m){var v=d-d%5;m=(o&(1<<v)-1).toString(32),o>>=v,d-=v,vi=1<<32-qe(s)+d|a<<d|o,Ai=m+e}else vi=1<<m|a<<d|o,Ai=e}function Ho(e){e.return!==null&&(Bi(e,1),wd(e,1,0))}function Go(e){for(;e===zr;)zr=yn[--bn],yn[bn]=null,ma=yn[--bn],yn[bn]=null;for(;e===is;)is=ni[--ai],ni[ai]=null,Ai=ni[--ai],ni[ai]=null,vi=ni[--ai],ni[ai]=null}function _d(e,s){ni[ai++]=vi,ni[ai++]=Ai,ni[ai++]=is,vi=s.id,Ai=s.overflow,is=e}var ye=null,Vt=null,Tt=!1,ss=null,ri=!1,qo=Error(n(519));function ns(e){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ga(si(s,e)),qo}function xd(e){var s=e.stateNode,a=e.type,o=e.memoizedProps;switch(s[ge]=e,s[Re]=o,a){case"dialog":xt("cancel",s),xt("close",s);break;case"iframe":case"object":case"embed":xt("load",s);break;case"video":case"audio":for(a=0;a<Pa.length;a++)xt(Pa[a],s);break;case"source":xt("error",s);break;case"img":case"image":case"link":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"input":xt("invalid",s),zh(s,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":xt("invalid",s);break;case"textarea":xt("invalid",s),Fh(s,o.value,o.defaultValue,o.children)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||s.textContent===""+a||o.suppressHydrationWarning===!0||Hp(s.textContent,a)?(o.popover!=null&&(xt("beforetoggle",s),xt("toggle",s)),o.onScroll!=null&&xt("scroll",s),o.onScrollEnd!=null&&xt("scrollend",s),o.onClick!=null&&(s.onclick=Oi),s=!0):s=!1,s||ns(e,!0)}function Ed(e){for(ye=e.return;ye;)switch(ye.tag){case 5:case 31:case 13:ri=!1;return;case 27:case 3:ri=!0;return;default:ye=ye.return}}function vn(e){if(e!==ye)return!1;if(!Tt)return Ed(e),Tt=!0,!1;var s=e.tag,a;if((a=s!==3&&s!==27)&&((a=s===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||ou(e.type,e.memoizedProps)),a=!a),a&&Vt&&ns(e),Ed(e),s===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));Vt=Wp(e)}else if(s===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));Vt=Wp(e)}else s===27?(s=Vt,bs(e.type)?(e=fu,fu=null,Vt=e):Vt=s):Vt=ye?oi(e.stateNode.nextSibling):null;return!0}function zs(){Vt=ye=null,Tt=!1}function Vo(){var e=ss;return e!==null&&(je===null?je=e:je.push.apply(je,e),ss=null),e}function ga(e){ss===null?ss=[e]:ss.push(e)}var Xo=k(null),Ps=null,ji=null;function as(e,s,a){q(Xo,s._currentValue),s._currentValue=a}function zi(e){e._currentValue=Xo.current,H(Xo)}function Yo(e,s,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,o!==null&&(o.childLanes|=s)):o!==null&&(o.childLanes&s)!==s&&(o.childLanes|=s),e===a)break;e=e.return}}function Ko(e,s,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var m=d.dependencies;if(m!==null){var v=d.child;m=m.firstContext;t:for(;m!==null;){var E=m;m=d;for(var D=0;D<s.length;D++)if(E.context===s[D]){m.lanes|=a,E=m.alternate,E!==null&&(E.lanes|=a),Yo(m.return,a,e),o||(v=null);break t}m=E.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(n(341));v.lanes|=a,m=v.alternate,m!==null&&(m.lanes|=a),Yo(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function An(e,s,a,o){e=null;for(var d=s,m=!1;d!==null;){if(!m){if((d.flags&524288)!==0)m=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(n(387));if(v=v.memoizedProps,v!==null){var E=d.type;Ve(d.pendingProps.value,v.value)||(e!==null?e.push(E):e=[E])}}else if(d===Q.current){if(v=d.alternate,v===null)throw Error(n(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Ga):e=[Ga])}d=d.return}e!==null&&Ko(s,e,a,o),s.flags|=262144}function Pr(e){for(e=e.firstContext;e!==null;){if(!Ve(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Fs(e){Ps=e,ji=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function be(e){return Cd(Ps,e)}function Fr(e,s){return Ps===null&&Fs(e),Cd(e,s)}function Cd(e,s){var a=s._currentValue;if(s={context:s,memoizedValue:a,next:null},ji===null){if(e===null)throw Error(n(308));ji=s,e.dependencies={lanes:0,firstContext:s},e.flags|=524288}else ji=ji.next=s;return a}var eb=typeof AbortController<"u"?AbortController:function(){var e=[],s=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){s.aborted=!0,e.forEach(function(a){return a()})}},ib=p.unstable_scheduleCallback,sb=p.unstable_NormalPriority,ne={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $o(){return{controller:new eb,data:new Map,refCount:0}}function ya(e){e.refCount--,e.refCount===0&&ib(sb,function(){e.controller.abort()})}var ba=null,Qo=0,Sn=0,wn=null;function nb(e,s){if(ba===null){var a=ba=[];Qo=0,Sn=Jc(),wn={status:"pending",value:void 0,then:function(o){a.push(o)}}}return Qo++,s.then(Td,Td),s}function Td(){if(--Qo===0&&ba!==null){wn!==null&&(wn.status="fulfilled");var e=ba;ba=null,Sn=0,wn=null;for(var s=0;s<e.length;s++)(0,e[s])()}}function ab(e,s){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=s;for(var d=0;d<a.length;d++)(0,a[d])(s)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Md=B.S;B.S=function(e,s){dp=He(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&nb(e,s),Md!==null&&Md(e,s)};var Us=k(null);function Wo(){var e=Us.current;return e!==null?e:Gt.pooledCache}function Ur(e,s){s===null?q(Us,Us.current):q(Us,s.pool)}function Dd(){var e=Wo();return e===null?null:{parent:ne._currentValue,pool:e}}var _n=Error(n(460)),Zo=Error(n(474)),Ir=Error(n(542)),Hr={then:function(){}};function Nd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rd(e,s,a){switch(a=e[a],a===void 0?e.push(s):a!==s&&(s.then(Oi,Oi),s=a),s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,kd(e),e;default:if(typeof s.status=="string")s.then(Oi,Oi);else{if(e=Gt,e!==null&&100<e.shellSuspendCounter)throw Error(n(482));e=s,e.status="pending",e.then(function(o){if(s.status==="pending"){var d=s;d.status="fulfilled",d.value=o}},function(o){if(s.status==="pending"){var d=s;d.status="rejected",d.reason=o}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,kd(e),e}throw Hs=s,_n}}function Is(e){try{var s=e._init;return s(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Hs=a,_n):a}}var Hs=null;function Od(){if(Hs===null)throw Error(n(459));var e=Hs;return Hs=null,e}function kd(e){if(e===_n||e===Ir)throw Error(n(483))}var xn=null,va=0;function Gr(e){var s=va;return va+=1,xn===null&&(xn=[]),Rd(xn,e,s)}function Aa(e,s){s=s.props.ref,e.ref=s!==void 0?s:null}function qr(e,s){throw s.$$typeof===b?Error(n(525)):(e=Object.prototype.toString.call(s),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)))}function Ld(e){function s(z,L){if(e){var P=z.deletions;P===null?(z.deletions=[L],z.flags|=16):P.push(L)}}function a(z,L){if(!e)return null;for(;L!==null;)s(z,L),L=L.sibling;return null}function o(z){for(var L=new Map;z!==null;)z.key!==null?L.set(z.key,z):L.set(z.index,z),z=z.sibling;return L}function d(z,L){return z=Li(z,L),z.index=0,z.sibling=null,z}function m(z,L,P){return z.index=P,e?(P=z.alternate,P!==null?(P=P.index,P<L?(z.flags|=67108866,L):P):(z.flags|=67108866,L)):(z.flags|=1048576,L)}function v(z){return e&&z.alternate===null&&(z.flags|=67108866),z}function E(z,L,P,Y){return L===null||L.tag!==6?(L=Uo(P,z.mode,Y),L.return=z,L):(L=d(L,P),L.return=z,L)}function D(z,L,P,Y){var ct=P.type;return ct===w?X(z,L,P.props.children,Y,P.key):L!==null&&(L.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===V&&Is(ct)===L.type)?(L=d(L,P.props),Aa(L,P),L.return=z,L):(L=jr(P.type,P.key,P.props,null,z.mode,Y),Aa(L,P),L.return=z,L)}function F(z,L,P,Y){return L===null||L.tag!==4||L.stateNode.containerInfo!==P.containerInfo||L.stateNode.implementation!==P.implementation?(L=Io(P,z.mode,Y),L.return=z,L):(L=d(L,P.children||[]),L.return=z,L)}function X(z,L,P,Y,ct){return L===null||L.tag!==7?(L=js(P,z.mode,Y,ct),L.return=z,L):(L=d(L,P),L.return=z,L)}function K(z,L,P){if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return L=Uo(""+L,z.mode,P),L.return=z,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case A:return P=jr(L.type,L.key,L.props,null,z.mode,P),Aa(P,L),P.return=z,P;case x:return L=Io(L,z.mode,P),L.return=z,L;case V:return L=Is(L),K(z,L,P)}if(vt(L)||it(L))return L=js(L,z.mode,P,null),L.return=z,L;if(typeof L.then=="function")return K(z,Gr(L),P);if(L.$$typeof===T)return K(z,Fr(z,L),P);qr(z,L)}return null}function U(z,L,P,Y){var ct=L!==null?L.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return ct!==null?null:E(z,L,""+P,Y);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case A:return P.key===ct?D(z,L,P,Y):null;case x:return P.key===ct?F(z,L,P,Y):null;case V:return P=Is(P),U(z,L,P,Y)}if(vt(P)||it(P))return ct!==null?null:X(z,L,P,Y,null);if(typeof P.then=="function")return U(z,L,Gr(P),Y);if(P.$$typeof===T)return U(z,L,Fr(z,P),Y);qr(z,P)}return null}function I(z,L,P,Y,ct){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return z=z.get(P)||null,E(L,z,""+Y,ct);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return z=z.get(Y.key===null?P:Y.key)||null,D(L,z,Y,ct);case x:return z=z.get(Y.key===null?P:Y.key)||null,F(L,z,Y,ct);case V:return Y=Is(Y),I(z,L,P,Y,ct)}if(vt(Y)||it(Y))return z=z.get(P)||null,X(L,z,Y,ct,null);if(typeof Y.then=="function")return I(z,L,P,Gr(Y),ct);if(Y.$$typeof===T)return I(z,L,P,Fr(L,Y),ct);qr(L,Y)}return null}function at(z,L,P,Y){for(var ct=null,Ot=null,lt=L,wt=L=0,Ct=null;lt!==null&&wt<P.length;wt++){lt.index>wt?(Ct=lt,lt=null):Ct=lt.sibling;var kt=U(z,lt,P[wt],Y);if(kt===null){lt===null&&(lt=Ct);break}e&&lt&&kt.alternate===null&&s(z,lt),L=m(kt,L,wt),Ot===null?ct=kt:Ot.sibling=kt,Ot=kt,lt=Ct}if(wt===P.length)return a(z,lt),Tt&&Bi(z,wt),ct;if(lt===null){for(;wt<P.length;wt++)lt=K(z,P[wt],Y),lt!==null&&(L=m(lt,L,wt),Ot===null?ct=lt:Ot.sibling=lt,Ot=lt);return Tt&&Bi(z,wt),ct}for(lt=o(lt);wt<P.length;wt++)Ct=I(lt,z,wt,P[wt],Y),Ct!==null&&(e&&Ct.alternate!==null&&lt.delete(Ct.key===null?wt:Ct.key),L=m(Ct,L,wt),Ot===null?ct=Ct:Ot.sibling=Ct,Ot=Ct);return e&&lt.forEach(function(_s){return s(z,_s)}),Tt&&Bi(z,wt),ct}function dt(z,L,P,Y){if(P==null)throw Error(n(151));for(var ct=null,Ot=null,lt=L,wt=L=0,Ct=null,kt=P.next();lt!==null&&!kt.done;wt++,kt=P.next()){lt.index>wt?(Ct=lt,lt=null):Ct=lt.sibling;var _s=U(z,lt,kt.value,Y);if(_s===null){lt===null&&(lt=Ct);break}e&&lt&&_s.alternate===null&&s(z,lt),L=m(_s,L,wt),Ot===null?ct=_s:Ot.sibling=_s,Ot=_s,lt=Ct}if(kt.done)return a(z,lt),Tt&&Bi(z,wt),ct;if(lt===null){for(;!kt.done;wt++,kt=P.next())kt=K(z,kt.value,Y),kt!==null&&(L=m(kt,L,wt),Ot===null?ct=kt:Ot.sibling=kt,Ot=kt);return Tt&&Bi(z,wt),ct}for(lt=o(lt);!kt.done;wt++,kt=P.next())kt=I(lt,z,wt,kt.value,Y),kt!==null&&(e&&kt.alternate!==null&&lt.delete(kt.key===null?wt:kt.key),L=m(kt,L,wt),Ot===null?ct=kt:Ot.sibling=kt,Ot=kt);return e&&lt.forEach(function(gv){return s(z,gv)}),Tt&&Bi(z,wt),ct}function It(z,L,P,Y){if(typeof P=="object"&&P!==null&&P.type===w&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case A:t:{for(var ct=P.key;L!==null;){if(L.key===ct){if(ct=P.type,ct===w){if(L.tag===7){a(z,L.sibling),Y=d(L,P.props.children),Y.return=z,z=Y;break t}}else if(L.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===V&&Is(ct)===L.type){a(z,L.sibling),Y=d(L,P.props),Aa(Y,P),Y.return=z,z=Y;break t}a(z,L);break}else s(z,L);L=L.sibling}P.type===w?(Y=js(P.props.children,z.mode,Y,P.key),Y.return=z,z=Y):(Y=jr(P.type,P.key,P.props,null,z.mode,Y),Aa(Y,P),Y.return=z,z=Y)}return v(z);case x:t:{for(ct=P.key;L!==null;){if(L.key===ct)if(L.tag===4&&L.stateNode.containerInfo===P.containerInfo&&L.stateNode.implementation===P.implementation){a(z,L.sibling),Y=d(L,P.children||[]),Y.return=z,z=Y;break t}else{a(z,L);break}else s(z,L);L=L.sibling}Y=Io(P,z.mode,Y),Y.return=z,z=Y}return v(z);case V:return P=Is(P),It(z,L,P,Y)}if(vt(P))return at(z,L,P,Y);if(it(P)){if(ct=it(P),typeof ct!="function")throw Error(n(150));return P=ct.call(P),dt(z,L,P,Y)}if(typeof P.then=="function")return It(z,L,Gr(P),Y);if(P.$$typeof===T)return It(z,L,Fr(z,P),Y);qr(z,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,L!==null&&L.tag===6?(a(z,L.sibling),Y=d(L,P),Y.return=z,z=Y):(a(z,L),Y=Uo(P,z.mode,Y),Y.return=z,z=Y),v(z)):a(z,L)}return function(z,L,P,Y){try{va=0;var ct=It(z,L,P,Y);return xn=null,ct}catch(lt){if(lt===_n||lt===Ir)throw lt;var Ot=Xe(29,lt,null,z.mode);return Ot.lanes=Y,Ot.return=z,Ot}}}var Gs=Ld(!0),Bd=Ld(!1),rs=!1;function Jo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tc(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ls(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function os(e,s,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Lt&2)!==0){var d=o.pending;return d===null?s.next=s:(s.next=d.next,d.next=s),o.pending=s,s=Br(e),bd(e,null,a),s}return Lr(e,o,s,a),Br(e)}function Sa(e,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194048)!==0)){var o=s.lanes;o&=e.pendingLanes,a|=o,s.lanes=a,Ch(e,a)}}function ec(e,s){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};m===null?d=m=v:m=m.next=v,a=a.next}while(a!==null);m===null?d=m=s:m=m.next=s}else d=m=s;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=s:e.next=s,a.lastBaseUpdate=s}var ic=!1;function wa(){if(ic){var e=wn;if(e!==null)throw e}}function _a(e,s,a,o){ic=!1;var d=e.updateQueue;rs=!1;var m=d.firstBaseUpdate,v=d.lastBaseUpdate,E=d.shared.pending;if(E!==null){d.shared.pending=null;var D=E,F=D.next;D.next=null,v===null?m=F:v.next=F,v=D;var X=e.alternate;X!==null&&(X=X.updateQueue,E=X.lastBaseUpdate,E!==v&&(E===null?X.firstBaseUpdate=F:E.next=F,X.lastBaseUpdate=D))}if(m!==null){var K=d.baseState;v=0,X=F=D=null,E=m;do{var U=E.lane&-536870913,I=U!==E.lane;if(I?(Et&U)===U:(o&U)===U){U!==0&&U===Sn&&(ic=!0),X!==null&&(X=X.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});t:{var at=e,dt=E;U=s;var It=a;switch(dt.tag){case 1:if(at=dt.payload,typeof at=="function"){K=at.call(It,K,U);break t}K=at;break t;case 3:at.flags=at.flags&-65537|128;case 0:if(at=dt.payload,U=typeof at=="function"?at.call(It,K,U):at,U==null)break t;K=y({},K,U);break t;case 2:rs=!0}}U=E.callback,U!==null&&(e.flags|=64,I&&(e.flags|=8192),I=d.callbacks,I===null?d.callbacks=[U]:I.push(U))}else I={lane:U,tag:E.tag,payload:E.payload,callback:E.callback,next:null},X===null?(F=X=I,D=K):X=X.next=I,v|=U;if(E=E.next,E===null){if(E=d.shared.pending,E===null)break;I=E,E=I.next,I.next=null,d.lastBaseUpdate=I,d.shared.pending=null}}while(!0);X===null&&(D=K),d.baseState=D,d.firstBaseUpdate=F,d.lastBaseUpdate=X,m===null&&(d.shared.lanes=0),fs|=v,e.lanes=v,e.memoizedState=K}}function jd(e,s){if(typeof e!="function")throw Error(n(191,e));e.call(s)}function zd(e,s){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)jd(a[e],s)}var En=k(null),Vr=k(0);function Pd(e,s){e=Xi,q(Vr,e),q(En,s),Xi=e|s.baseLanes}function sc(){q(Vr,Xi),q(En,En.current)}function nc(){Xi=Vr.current,H(En),H(Vr)}var Ye=k(null),li=null;function cs(e){var s=e.alternate;q(ee,ee.current&1),q(Ye,e),li===null&&(s===null||En.current!==null||s.memoizedState!==null)&&(li=e)}function ac(e){q(ee,ee.current),q(Ye,e),li===null&&(li=e)}function Fd(e){e.tag===22?(q(ee,ee.current),q(Ye,e),li===null&&(li=e)):us()}function us(){q(ee,ee.current),q(Ye,Ye.current)}function Ke(e){H(Ye),li===e&&(li=null),H(ee)}var ee=k(0);function Xr(e){for(var s=e;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||hu(a)||du(a)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Pi=0,At=null,Ft=null,ae=null,Yr=!1,Cn=!1,qs=!1,Kr=0,xa=0,Tn=null,rb=0;function Zt(){throw Error(n(321))}function rc(e,s){if(s===null)return!1;for(var a=0;a<s.length&&a<e.length;a++)if(!Ve(e[a],s[a]))return!1;return!0}function lc(e,s,a,o,d,m){return Pi=m,At=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,B.H=e===null||e.memoizedState===null?_f:wc,qs=!1,m=a(o,d),qs=!1,Cn&&(m=Id(s,a,o,d)),Ud(e),m}function Ud(e){B.H=Ta;var s=Ft!==null&&Ft.next!==null;if(Pi=0,ae=Ft=At=null,Yr=!1,xa=0,Tn=null,s)throw Error(n(300));e===null||re||(e=e.dependencies,e!==null&&Pr(e)&&(re=!0))}function Id(e,s,a,o){At=e;var d=0;do{if(Cn&&(Tn=null),xa=0,Cn=!1,25<=d)throw Error(n(301));if(d+=1,ae=Ft=null,e.updateQueue!=null){var m=e.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}B.H=xf,m=s(a,o)}while(Cn);return m}function lb(){var e=B.H,s=e.useState()[0];return s=typeof s.then=="function"?Ea(s):s,e=e.useState()[0],(Ft!==null?Ft.memoizedState:null)!==e&&(At.flags|=1024),s}function oc(){var e=Kr!==0;return Kr=0,e}function cc(e,s,a){s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~a}function uc(e){if(Yr){for(e=e.memoizedState;e!==null;){var s=e.queue;s!==null&&(s.pending=null),e=e.next}Yr=!1}Pi=0,ae=Ft=At=null,Cn=!1,xa=Kr=0,Tn=null}function Ce(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ae===null?At.memoizedState=ae=e:ae=ae.next=e,ae}function ie(){if(Ft===null){var e=At.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var s=ae===null?At.memoizedState:ae.next;if(s!==null)ae=s,Ft=e;else{if(e===null)throw At.alternate===null?Error(n(467)):Error(n(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},ae===null?At.memoizedState=ae=e:ae=ae.next=e}return ae}function $r(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ea(e){var s=xa;return xa+=1,Tn===null&&(Tn=[]),e=Rd(Tn,e,s),s=At,(ae===null?s.memoizedState:ae.next)===null&&(s=s.alternate,B.H=s===null||s.memoizedState===null?_f:wc),e}function Qr(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ea(e);if(e.$$typeof===T)return be(e)}throw Error(n(438,String(e)))}function hc(e){var s=null,a=At.updateQueue;if(a!==null&&(s=a.memoCache),s==null){var o=At.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(s={data:o.data.map(function(d){return d.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),a===null&&(a=$r(),At.updateQueue=a),a.memoCache=s,a=s.data[s.index],a===void 0)for(a=s.data[s.index]=Array(e),o=0;o<e;o++)a[o]=J;return s.index++,a}function Fi(e,s){return typeof s=="function"?s(e):s}function Wr(e){var s=ie();return dc(s,Ft,e)}function dc(e,s,a){var o=e.queue;if(o===null)throw Error(n(311));o.lastRenderedReducer=a;var d=e.baseQueue,m=o.pending;if(m!==null){if(d!==null){var v=d.next;d.next=m.next,m.next=v}s.baseQueue=d=m,o.pending=null}if(m=e.baseState,d===null)e.memoizedState=m;else{s=d.next;var E=v=null,D=null,F=s,X=!1;do{var K=F.lane&-536870913;if(K!==F.lane?(Et&K)===K:(Pi&K)===K){var U=F.revertLane;if(U===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),K===Sn&&(X=!0);else if((Pi&U)===U){F=F.next,U===Sn&&(X=!0);continue}else K={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},D===null?(E=D=K,v=m):D=D.next=K,At.lanes|=U,fs|=U;K=F.action,qs&&a(m,K),m=F.hasEagerState?F.eagerState:a(m,K)}else U={lane:K,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},D===null?(E=D=U,v=m):D=D.next=U,At.lanes|=K,fs|=K;F=F.next}while(F!==null&&F!==s);if(D===null?v=m:D.next=E,!Ve(m,e.memoizedState)&&(re=!0,X&&(a=wn,a!==null)))throw a;e.memoizedState=m,e.baseState=v,e.baseQueue=D,o.lastRenderedState=m}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function fc(e){var s=ie(),a=s.queue;if(a===null)throw Error(n(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,m=s.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do m=e(m,v.action),v=v.next;while(v!==d);Ve(m,s.memoizedState)||(re=!0),s.memoizedState=m,s.baseQueue===null&&(s.baseState=m),a.lastRenderedState=m}return[m,o]}function Hd(e,s,a){var o=At,d=ie(),m=Tt;if(m){if(a===void 0)throw Error(n(407));a=a()}else a=s();var v=!Ve((Ft||d).memoizedState,a);if(v&&(d.memoizedState=a,re=!0),d=d.queue,gc(Vd.bind(null,o,d,e),[e]),d.getSnapshot!==s||v||ae!==null&&ae.memoizedState.tag&1){if(o.flags|=2048,Mn(9,{destroy:void 0},qd.bind(null,o,d,a,s),null),Gt===null)throw Error(n(349));m||(Pi&127)!==0||Gd(o,s,a)}return a}function Gd(e,s,a){e.flags|=16384,e={getSnapshot:s,value:a},s=At.updateQueue,s===null?(s=$r(),At.updateQueue=s,s.stores=[e]):(a=s.stores,a===null?s.stores=[e]:a.push(e))}function qd(e,s,a,o){s.value=a,s.getSnapshot=o,Xd(s)&&Yd(e)}function Vd(e,s,a){return a(function(){Xd(s)&&Yd(e)})}function Xd(e){var s=e.getSnapshot;e=e.value;try{var a=s();return!Ve(e,a)}catch{return!0}}function Yd(e){var s=Bs(e,2);s!==null&&ze(s,e,2)}function pc(e){var s=Ce();if(typeof e=="function"){var a=e;if(e=a(),qs){Ji(!0);try{a()}finally{Ji(!1)}}}return s.memoizedState=s.baseState=e,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fi,lastRenderedState:e},s}function Kd(e,s,a,o){return e.baseState=a,dc(e,Ft,typeof o=="function"?o:Fi)}function ob(e,s,a,o,d){if(tl(e))throw Error(n(485));if(e=s.action,e!==null){var m={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};B.T!==null?a(!0):m.isTransition=!1,o(m),a=s.pending,a===null?(m.next=s.pending=m,$d(s,m)):(m.next=a.next,s.pending=a.next=m)}}function $d(e,s){var a=s.action,o=s.payload,d=e.state;if(s.isTransition){var m=B.T,v={};B.T=v;try{var E=a(d,o),D=B.S;D!==null&&D(v,E),Qd(e,s,E)}catch(F){mc(e,s,F)}finally{m!==null&&v.types!==null&&(m.types=v.types),B.T=m}}else try{m=a(d,o),Qd(e,s,m)}catch(F){mc(e,s,F)}}function Qd(e,s,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){Wd(e,s,o)},function(o){return mc(e,s,o)}):Wd(e,s,a)}function Wd(e,s,a){s.status="fulfilled",s.value=a,Zd(s),e.state=a,s=e.pending,s!==null&&(a=s.next,a===s?e.pending=null:(a=a.next,s.next=a,$d(e,a)))}function mc(e,s,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do s.status="rejected",s.reason=a,Zd(s),s=s.next;while(s!==o)}e.action=null}function Zd(e){e=e.listeners;for(var s=0;s<e.length;s++)(0,e[s])()}function Jd(e,s){return s}function tf(e,s){if(Tt){var a=Gt.formState;if(a!==null){t:{var o=At;if(Tt){if(Vt){e:{for(var d=Vt,m=ri;d.nodeType!==8;){if(!m){d=null;break e}if(d=oi(d.nextSibling),d===null){d=null;break e}}m=d.data,d=m==="F!"||m==="F"?d:null}if(d){Vt=oi(d.nextSibling),o=d.data==="F!";break t}}ns(o)}o=!1}o&&(s=a[0])}}return a=Ce(),a.memoizedState=a.baseState=s,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jd,lastRenderedState:s},a.queue=o,a=Af.bind(null,At,o),o.dispatch=a,o=pc(!1),m=Sc.bind(null,At,!1,o.queue),o=Ce(),d={state:s,dispatch:null,action:e,pending:null},o.queue=d,a=ob.bind(null,At,d,m,a),d.dispatch=a,o.memoizedState=e,[s,a,!1]}function ef(e){var s=ie();return sf(s,Ft,e)}function sf(e,s,a){if(s=dc(e,s,Jd)[0],e=Wr(Fi)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var o=Ea(s)}catch(v){throw v===_n?Ir:v}else o=s;s=ie();var d=s.queue,m=d.dispatch;return a!==s.memoizedState&&(At.flags|=2048,Mn(9,{destroy:void 0},cb.bind(null,d,a),null)),[o,m,e]}function cb(e,s){e.action=s}function nf(e){var s=ie(),a=Ft;if(a!==null)return sf(s,a,e);ie(),s=s.memoizedState,a=ie();var o=a.queue.dispatch;return a.memoizedState=e,[s,o,!1]}function Mn(e,s,a,o){return e={tag:e,create:a,deps:o,inst:s,next:null},s=At.updateQueue,s===null&&(s=$r(),At.updateQueue=s),a=s.lastEffect,a===null?s.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,s.lastEffect=e),e}function af(){return ie().memoizedState}function Zr(e,s,a,o){var d=Ce();At.flags|=e,d.memoizedState=Mn(1|s,{destroy:void 0},a,o===void 0?null:o)}function Jr(e,s,a,o){var d=ie();o=o===void 0?null:o;var m=d.memoizedState.inst;Ft!==null&&o!==null&&rc(o,Ft.memoizedState.deps)?d.memoizedState=Mn(s,m,a,o):(At.flags|=e,d.memoizedState=Mn(1|s,m,a,o))}function rf(e,s){Zr(8390656,8,e,s)}function gc(e,s){Jr(2048,8,e,s)}function ub(e){At.flags|=4;var s=At.updateQueue;if(s===null)s=$r(),At.updateQueue=s,s.events=[e];else{var a=s.events;a===null?s.events=[e]:a.push(e)}}function lf(e){var s=ie().memoizedState;return ub({ref:s,nextImpl:e}),function(){if((Lt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function of(e,s){return Jr(4,2,e,s)}function cf(e,s){return Jr(4,4,e,s)}function uf(e,s){if(typeof s=="function"){e=e();var a=s(e);return function(){typeof a=="function"?a():s(null)}}if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function hf(e,s,a){a=a!=null?a.concat([e]):null,Jr(4,4,uf.bind(null,s,e),a)}function yc(){}function df(e,s){var a=ie();s=s===void 0?null:s;var o=a.memoizedState;return s!==null&&rc(s,o[1])?o[0]:(a.memoizedState=[e,s],e)}function ff(e,s){var a=ie();s=s===void 0?null:s;var o=a.memoizedState;if(s!==null&&rc(s,o[1]))return o[0];if(o=e(),qs){Ji(!0);try{e()}finally{Ji(!1)}}return a.memoizedState=[o,s],o}function bc(e,s,a){return a===void 0||(Pi&1073741824)!==0&&(Et&261930)===0?e.memoizedState=s:(e.memoizedState=a,e=pp(),At.lanes|=e,fs|=e,a)}function pf(e,s,a,o){return Ve(a,s)?a:En.current!==null?(e=bc(e,a,o),Ve(e,s)||(re=!0),e):(Pi&42)===0||(Pi&1073741824)!==0&&(Et&261930)===0?(re=!0,e.memoizedState=a):(e=pp(),At.lanes|=e,fs|=e,s)}function mf(e,s,a,o,d){var m=G.p;G.p=m!==0&&8>m?m:8;var v=B.T,E={};B.T=E,Sc(e,!1,s,a);try{var D=d(),F=B.S;if(F!==null&&F(E,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var X=ab(D,o);Ca(e,s,X,We(e))}else Ca(e,s,o,We(e))}catch(K){Ca(e,s,{then:function(){},status:"rejected",reason:K},We())}finally{G.p=m,v!==null&&E.types!==null&&(v.types=E.types),B.T=v}}function hb(){}function vc(e,s,a,o){if(e.tag!==5)throw Error(n(476));var d=gf(e).queue;mf(e,d,s,Z,a===null?hb:function(){return yf(e),a(o)})}function gf(e){var s=e.memoizedState;if(s!==null)return s;s={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fi,lastRenderedState:Z},next:null};var a={};return s.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fi,lastRenderedState:a},next:null},e.memoizedState=s,e=e.alternate,e!==null&&(e.memoizedState=s),s}function yf(e){var s=gf(e);s.next===null&&(s=e.alternate.memoizedState),Ca(e,s.next.queue,{},We())}function Ac(){return be(Ga)}function bf(){return ie().memoizedState}function vf(){return ie().memoizedState}function db(e){for(var s=e.return;s!==null;){switch(s.tag){case 24:case 3:var a=We();e=ls(a);var o=os(s,e,a);o!==null&&(ze(o,s,a),Sa(o,s,a)),s={cache:$o()},e.payload=s;return}s=s.return}}function fb(e,s,a){var o=We();a={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},tl(e)?Sf(s,a):(a=Po(e,s,a,o),a!==null&&(ze(a,e,o),wf(a,s,o)))}function Af(e,s,a){var o=We();Ca(e,s,a,o)}function Ca(e,s,a,o){var d={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(tl(e))Sf(s,d);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=s.lastRenderedReducer,m!==null))try{var v=s.lastRenderedState,E=m(v,a);if(d.hasEagerState=!0,d.eagerState=E,Ve(E,v))return Lr(e,s,d,0),Gt===null&&kr(),!1}catch{}if(a=Po(e,s,d,o),a!==null)return ze(a,e,o),wf(a,s,o),!0}return!1}function Sc(e,s,a,o){if(o={lane:2,revertLane:Jc(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},tl(e)){if(s)throw Error(n(479))}else s=Po(e,a,o,2),s!==null&&ze(s,e,2)}function tl(e){var s=e.alternate;return e===At||s!==null&&s===At}function Sf(e,s){Cn=Yr=!0;var a=e.pending;a===null?s.next=s:(s.next=a.next,a.next=s),e.pending=s}function wf(e,s,a){if((a&4194048)!==0){var o=s.lanes;o&=e.pendingLanes,a|=o,s.lanes=a,Ch(e,a)}}var Ta={readContext:be,use:Qr,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt};Ta.useEffectEvent=Zt;var _f={readContext:be,use:Qr,useCallback:function(e,s){return Ce().memoizedState=[e,s===void 0?null:s],e},useContext:be,useEffect:rf,useImperativeHandle:function(e,s,a){a=a!=null?a.concat([e]):null,Zr(4194308,4,uf.bind(null,s,e),a)},useLayoutEffect:function(e,s){return Zr(4194308,4,e,s)},useInsertionEffect:function(e,s){Zr(4,2,e,s)},useMemo:function(e,s){var a=Ce();s=s===void 0?null:s;var o=e();if(qs){Ji(!0);try{e()}finally{Ji(!1)}}return a.memoizedState=[o,s],o},useReducer:function(e,s,a){var o=Ce();if(a!==void 0){var d=a(s);if(qs){Ji(!0);try{a(s)}finally{Ji(!1)}}}else d=s;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=fb.bind(null,At,e),[o.memoizedState,e]},useRef:function(e){var s=Ce();return e={current:e},s.memoizedState=e},useState:function(e){e=pc(e);var s=e.queue,a=Af.bind(null,At,s);return s.dispatch=a,[e.memoizedState,a]},useDebugValue:yc,useDeferredValue:function(e,s){var a=Ce();return bc(a,e,s)},useTransition:function(){var e=pc(!1);return e=mf.bind(null,At,e.queue,!0,!1),Ce().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,s,a){var o=At,d=Ce();if(Tt){if(a===void 0)throw Error(n(407));a=a()}else{if(a=s(),Gt===null)throw Error(n(349));(Et&127)!==0||Gd(o,s,a)}d.memoizedState=a;var m={value:a,getSnapshot:s};return d.queue=m,rf(Vd.bind(null,o,m,e),[e]),o.flags|=2048,Mn(9,{destroy:void 0},qd.bind(null,o,m,a,s),null),a},useId:function(){var e=Ce(),s=Gt.identifierPrefix;if(Tt){var a=Ai,o=vi;a=(o&~(1<<32-qe(o)-1)).toString(32)+a,s="_"+s+"R_"+a,a=Kr++,0<a&&(s+="H"+a.toString(32)),s+="_"}else a=rb++,s="_"+s+"r_"+a.toString(32)+"_";return e.memoizedState=s},useHostTransitionStatus:Ac,useFormState:tf,useActionState:tf,useOptimistic:function(e){var s=Ce();s.memoizedState=s.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=a,s=Sc.bind(null,At,!0,a),a.dispatch=s,[e,s]},useMemoCache:hc,useCacheRefresh:function(){return Ce().memoizedState=db.bind(null,At)},useEffectEvent:function(e){var s=Ce(),a={impl:e};return s.memoizedState=a,function(){if((Lt&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}},wc={readContext:be,use:Qr,useCallback:df,useContext:be,useEffect:gc,useImperativeHandle:hf,useInsertionEffect:of,useLayoutEffect:cf,useMemo:ff,useReducer:Wr,useRef:af,useState:function(){return Wr(Fi)},useDebugValue:yc,useDeferredValue:function(e,s){var a=ie();return pf(a,Ft.memoizedState,e,s)},useTransition:function(){var e=Wr(Fi)[0],s=ie().memoizedState;return[typeof e=="boolean"?e:Ea(e),s]},useSyncExternalStore:Hd,useId:bf,useHostTransitionStatus:Ac,useFormState:ef,useActionState:ef,useOptimistic:function(e,s){var a=ie();return Kd(a,Ft,e,s)},useMemoCache:hc,useCacheRefresh:vf};wc.useEffectEvent=lf;var xf={readContext:be,use:Qr,useCallback:df,useContext:be,useEffect:gc,useImperativeHandle:hf,useInsertionEffect:of,useLayoutEffect:cf,useMemo:ff,useReducer:fc,useRef:af,useState:function(){return fc(Fi)},useDebugValue:yc,useDeferredValue:function(e,s){var a=ie();return Ft===null?bc(a,e,s):pf(a,Ft.memoizedState,e,s)},useTransition:function(){var e=fc(Fi)[0],s=ie().memoizedState;return[typeof e=="boolean"?e:Ea(e),s]},useSyncExternalStore:Hd,useId:bf,useHostTransitionStatus:Ac,useFormState:nf,useActionState:nf,useOptimistic:function(e,s){var a=ie();return Ft!==null?Kd(a,Ft,e,s):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:hc,useCacheRefresh:vf};xf.useEffectEvent=lf;function _c(e,s,a,o){s=e.memoizedState,a=a(o,s),a=a==null?s:y({},s,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var xc={enqueueSetState:function(e,s,a){e=e._reactInternals;var o=We(),d=ls(o);d.payload=s,a!=null&&(d.callback=a),s=os(e,d,o),s!==null&&(ze(s,e,o),Sa(s,e,o))},enqueueReplaceState:function(e,s,a){e=e._reactInternals;var o=We(),d=ls(o);d.tag=1,d.payload=s,a!=null&&(d.callback=a),s=os(e,d,o),s!==null&&(ze(s,e,o),Sa(s,e,o))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var a=We(),o=ls(a);o.tag=2,s!=null&&(o.callback=s),s=os(e,o,a),s!==null&&(ze(s,e,a),Sa(s,e,a))}};function Ef(e,s,a,o,d,m,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,m,v):s.prototype&&s.prototype.isPureReactComponent?!fa(a,o)||!fa(d,m):!0}function Cf(e,s,a,o){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,o),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,o),s.state!==e&&xc.enqueueReplaceState(s,s.state,null)}function Vs(e,s){var a=s;if("ref"in s){a={};for(var o in s)o!=="ref"&&(a[o]=s[o])}if(e=e.defaultProps){a===s&&(a=y({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function Tf(e){Or(e)}function Mf(e){console.error(e)}function Df(e){Or(e)}function el(e,s){try{var a=e.onUncaughtError;a(s.value,{componentStack:s.stack})}catch(o){setTimeout(function(){throw o})}}function Nf(e,s,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Ec(e,s,a){return a=ls(a),a.tag=3,a.payload={element:null},a.callback=function(){el(e,s)},a}function Rf(e){return e=ls(e),e.tag=3,e}function Of(e,s,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var m=o.value;e.payload=function(){return d(m)},e.callback=function(){Nf(s,a,o)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Nf(s,a,o),typeof d!="function"&&(ps===null?ps=new Set([this]):ps.add(this));var E=o.stack;this.componentDidCatch(o.value,{componentStack:E!==null?E:""})})}function pb(e,s,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(s=a.alternate,s!==null&&An(s,a,d,!0),a=Ye.current,a!==null){switch(a.tag){case 31:case 13:return li===null?fl():a.alternate===null&&Jt===0&&(Jt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===Hr?a.flags|=16384:(s=a.updateQueue,s===null?a.updateQueue=new Set([o]):s.add(o),Qc(e,o,d)),!1;case 22:return a.flags|=65536,o===Hr?a.flags|=16384:(s=a.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=s):(a=s.retryQueue,a===null?s.retryQueue=new Set([o]):a.add(o)),Qc(e,o,d)),!1}throw Error(n(435,a.tag))}return Qc(e,o,d),fl(),!1}if(Tt)return s=Ye.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=d,o!==qo&&(e=Error(n(422),{cause:o}),ga(si(e,a)))):(o!==qo&&(s=Error(n(423),{cause:o}),ga(si(s,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=si(o,a),d=Ec(e.stateNode,o,d),ec(e,d),Jt!==4&&(Jt=2)),!1;var m=Error(n(520),{cause:o});if(m=si(m,a),Ba===null?Ba=[m]:Ba.push(m),Jt!==4&&(Jt=2),s===null)return!0;o=si(o,a),a=s;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=Ec(a.stateNode,o,e),ec(a,e),!1;case 1:if(s=a.type,m=a.stateNode,(a.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ps===null||!ps.has(m))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Rf(d),Of(d,e,a,o),ec(a,d),!1}a=a.return}while(a!==null);return!1}var Cc=Error(n(461)),re=!1;function ve(e,s,a,o){s.child=e===null?Bd(s,null,a,o):Gs(s,e.child,a,o)}function kf(e,s,a,o,d){a=a.render;var m=s.ref;if("ref"in o){var v={};for(var E in o)E!=="ref"&&(v[E]=o[E])}else v=o;return Fs(s),o=lc(e,s,a,v,m,d),E=oc(),e!==null&&!re?(cc(e,s,d),Ui(e,s,d)):(Tt&&E&&Ho(s),s.flags|=1,ve(e,s,o,d),s.child)}function Lf(e,s,a,o,d){if(e===null){var m=a.type;return typeof m=="function"&&!Fo(m)&&m.defaultProps===void 0&&a.compare===null?(s.tag=15,s.type=m,Bf(e,s,m,o,d)):(e=jr(a.type,null,o,s,s.mode,d),e.ref=s.ref,e.return=s,s.child=e)}if(m=e.child,!Lc(e,d)){var v=m.memoizedProps;if(a=a.compare,a=a!==null?a:fa,a(v,o)&&e.ref===s.ref)return Ui(e,s,d)}return s.flags|=1,e=Li(m,o),e.ref=s.ref,e.return=s,s.child=e}function Bf(e,s,a,o,d){if(e!==null){var m=e.memoizedProps;if(fa(m,o)&&e.ref===s.ref)if(re=!1,s.pendingProps=o=m,Lc(e,d))(e.flags&131072)!==0&&(re=!0);else return s.lanes=e.lanes,Ui(e,s,d)}return Tc(e,s,a,o,d)}function jf(e,s,a,o){var d=o.children,m=e!==null?e.memoizedState:null;if(e===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((s.flags&128)!==0){if(m=m!==null?m.baseLanes|a:a,e!==null){for(o=s.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;o=d&~m}else o=0,s.child=null;return zf(e,s,m,a,o)}if((a&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ur(s,m!==null?m.cachePool:null),m!==null?Pd(s,m):sc(),Fd(s);else return o=s.lanes=536870912,zf(e,s,m!==null?m.baseLanes|a:a,a,o)}else m!==null?(Ur(s,m.cachePool),Pd(s,m),us(),s.memoizedState=null):(e!==null&&Ur(s,null),sc(),us());return ve(e,s,d,a),s.child}function Ma(e,s){return e!==null&&e.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function zf(e,s,a,o,d){var m=Wo();return m=m===null?null:{parent:ne._currentValue,pool:m},s.memoizedState={baseLanes:a,cachePool:m},e!==null&&Ur(s,null),sc(),Fd(s),e!==null&&An(e,s,o,!0),s.childLanes=d,null}function il(e,s){return s=nl({mode:s.mode,children:s.children},e.mode),s.ref=e.ref,e.child=s,s.return=e,s}function Pf(e,s,a){return Gs(s,e.child,null,a),e=il(s,s.pendingProps),e.flags|=2,Ke(s),s.memoizedState=null,e}function mb(e,s,a){var o=s.pendingProps,d=(s.flags&128)!==0;if(s.flags&=-129,e===null){if(Tt){if(o.mode==="hidden")return e=il(s,o),s.lanes=536870912,Ma(null,e);if(ac(s),(e=Vt)?(e=Qp(e,ri),e=e!==null&&e.data==="&"?e:null,e!==null&&(s.memoizedState={dehydrated:e,treeContext:is!==null?{id:vi,overflow:Ai}:null,retryLane:536870912,hydrationErrors:null},a=Ad(e),a.return=s,s.child=a,ye=s,Vt=null)):e=null,e===null)throw ns(s);return s.lanes=536870912,null}return il(s,o)}var m=e.memoizedState;if(m!==null){var v=m.dehydrated;if(ac(s),d)if(s.flags&256)s.flags&=-257,s=Pf(e,s,a);else if(s.memoizedState!==null)s.child=e.child,s.flags|=128,s=null;else throw Error(n(558));else if(re||An(e,s,a,!1),d=(a&e.childLanes)!==0,re||d){if(o=Gt,o!==null&&(v=Th(o,a),v!==0&&v!==m.retryLane))throw m.retryLane=v,Bs(e,v),ze(o,e,v),Cc;fl(),s=Pf(e,s,a)}else e=m.treeContext,Vt=oi(v.nextSibling),ye=s,Tt=!0,ss=null,ri=!1,e!==null&&_d(s,e),s=il(s,o),s.flags|=4096;return s}return e=Li(e.child,{mode:o.mode,children:o.children}),e.ref=s.ref,s.child=e,e.return=s,e}function sl(e,s){var a=s.ref;if(a===null)e!==null&&e.ref!==null&&(s.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(n(284));(e===null||e.ref!==a)&&(s.flags|=4194816)}}function Tc(e,s,a,o,d){return Fs(s),a=lc(e,s,a,o,void 0,d),o=oc(),e!==null&&!re?(cc(e,s,d),Ui(e,s,d)):(Tt&&o&&Ho(s),s.flags|=1,ve(e,s,a,d),s.child)}function Ff(e,s,a,o,d,m){return Fs(s),s.updateQueue=null,a=Id(s,o,a,d),Ud(e),o=oc(),e!==null&&!re?(cc(e,s,m),Ui(e,s,m)):(Tt&&o&&Ho(s),s.flags|=1,ve(e,s,a,m),s.child)}function Uf(e,s,a,o,d){if(Fs(s),s.stateNode===null){var m=gn,v=a.contextType;typeof v=="object"&&v!==null&&(m=be(v)),m=new a(o,m),s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=xc,s.stateNode=m,m._reactInternals=s,m=s.stateNode,m.props=o,m.state=s.memoizedState,m.refs={},Jo(s),v=a.contextType,m.context=typeof v=="object"&&v!==null?be(v):gn,m.state=s.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(_c(s,a,v,o),m.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&xc.enqueueReplaceState(m,m.state,null),_a(s,o,m,d),wa(),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308),o=!0}else if(e===null){m=s.stateNode;var E=s.memoizedProps,D=Vs(a,E);m.props=D;var F=m.context,X=a.contextType;v=gn,typeof X=="object"&&X!==null&&(v=be(X));var K=a.getDerivedStateFromProps;X=typeof K=="function"||typeof m.getSnapshotBeforeUpdate=="function",E=s.pendingProps!==E,X||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E||F!==v)&&Cf(s,m,o,v),rs=!1;var U=s.memoizedState;m.state=U,_a(s,o,m,d),wa(),F=s.memoizedState,E||U!==F||rs?(typeof K=="function"&&(_c(s,a,K,o),F=s.memoizedState),(D=rs||Ef(s,a,D,o,U,F,v))?(X||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(s.flags|=4194308)):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=o,s.memoizedState=F),m.props=o,m.state=F,m.context=v,o=D):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),o=!1)}else{m=s.stateNode,tc(e,s),v=s.memoizedProps,X=Vs(a,v),m.props=X,K=s.pendingProps,U=m.context,F=a.contextType,D=gn,typeof F=="object"&&F!==null&&(D=be(F)),E=a.getDerivedStateFromProps,(F=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==K||U!==D)&&Cf(s,m,o,D),rs=!1,U=s.memoizedState,m.state=U,_a(s,o,m,d),wa();var I=s.memoizedState;v!==K||U!==I||rs||e!==null&&e.dependencies!==null&&Pr(e.dependencies)?(typeof E=="function"&&(_c(s,a,E,o),I=s.memoizedState),(X=rs||Ef(s,a,X,o,U,I,D)||e!==null&&e.dependencies!==null&&Pr(e.dependencies))?(F||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(o,I,D),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(o,I,D)),typeof m.componentDidUpdate=="function"&&(s.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(s.flags|=1024),s.memoizedProps=o,s.memoizedState=I),m.props=o,m.state=I,m.context=D,o=X):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(s.flags|=1024),o=!1)}return m=o,sl(e,s),o=(s.flags&128)!==0,m||o?(m=s.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:m.render(),s.flags|=1,e!==null&&o?(s.child=Gs(s,e.child,null,d),s.child=Gs(s,null,a,d)):ve(e,s,a,d),s.memoizedState=m.state,e=s.child):e=Ui(e,s,d),e}function If(e,s,a,o){return zs(),s.flags|=256,ve(e,s,a,o),s.child}var Mc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dc(e){return{baseLanes:e,cachePool:Dd()}}function Nc(e,s,a){return e=e!==null?e.childLanes&~a:0,s&&(e|=Qe),e}function Hf(e,s,a){var o=s.pendingProps,d=!1,m=(s.flags&128)!==0,v;if((v=m)||(v=e!==null&&e.memoizedState===null?!1:(ee.current&2)!==0),v&&(d=!0,s.flags&=-129),v=(s.flags&32)!==0,s.flags&=-33,e===null){if(Tt){if(d?cs(s):us(),(e=Vt)?(e=Qp(e,ri),e=e!==null&&e.data!=="&"?e:null,e!==null&&(s.memoizedState={dehydrated:e,treeContext:is!==null?{id:vi,overflow:Ai}:null,retryLane:536870912,hydrationErrors:null},a=Ad(e),a.return=s,s.child=a,ye=s,Vt=null)):e=null,e===null)throw ns(s);return du(e)?s.lanes=32:s.lanes=536870912,null}var E=o.children;return o=o.fallback,d?(us(),d=s.mode,E=nl({mode:"hidden",children:E},d),o=js(o,d,a,null),E.return=s,o.return=s,E.sibling=o,s.child=E,o=s.child,o.memoizedState=Dc(a),o.childLanes=Nc(e,v,a),s.memoizedState=Mc,Ma(null,o)):(cs(s),Rc(s,E))}var D=e.memoizedState;if(D!==null&&(E=D.dehydrated,E!==null)){if(m)s.flags&256?(cs(s),s.flags&=-257,s=Oc(e,s,a)):s.memoizedState!==null?(us(),s.child=e.child,s.flags|=128,s=null):(us(),E=o.fallback,d=s.mode,o=nl({mode:"visible",children:o.children},d),E=js(E,d,a,null),E.flags|=2,o.return=s,E.return=s,o.sibling=E,s.child=o,Gs(s,e.child,null,a),o=s.child,o.memoizedState=Dc(a),o.childLanes=Nc(e,v,a),s.memoizedState=Mc,s=Ma(null,o));else if(cs(s),du(E)){if(v=E.nextSibling&&E.nextSibling.dataset,v)var F=v.dgst;v=F,o=Error(n(419)),o.stack="",o.digest=v,ga({value:o,source:null,stack:null}),s=Oc(e,s,a)}else if(re||An(e,s,a,!1),v=(a&e.childLanes)!==0,re||v){if(v=Gt,v!==null&&(o=Th(v,a),o!==0&&o!==D.retryLane))throw D.retryLane=o,Bs(e,o),ze(v,e,o),Cc;hu(E)||fl(),s=Oc(e,s,a)}else hu(E)?(s.flags|=192,s.child=e.child,s=null):(e=D.treeContext,Vt=oi(E.nextSibling),ye=s,Tt=!0,ss=null,ri=!1,e!==null&&_d(s,e),s=Rc(s,o.children),s.flags|=4096);return s}return d?(us(),E=o.fallback,d=s.mode,D=e.child,F=D.sibling,o=Li(D,{mode:"hidden",children:o.children}),o.subtreeFlags=D.subtreeFlags&65011712,F!==null?E=Li(F,E):(E=js(E,d,a,null),E.flags|=2),E.return=s,o.return=s,o.sibling=E,s.child=o,Ma(null,o),o=s.child,E=e.child.memoizedState,E===null?E=Dc(a):(d=E.cachePool,d!==null?(D=ne._currentValue,d=d.parent!==D?{parent:D,pool:D}:d):d=Dd(),E={baseLanes:E.baseLanes|a,cachePool:d}),o.memoizedState=E,o.childLanes=Nc(e,v,a),s.memoizedState=Mc,Ma(e.child,o)):(cs(s),a=e.child,e=a.sibling,a=Li(a,{mode:"visible",children:o.children}),a.return=s,a.sibling=null,e!==null&&(v=s.deletions,v===null?(s.deletions=[e],s.flags|=16):v.push(e)),s.child=a,s.memoizedState=null,a)}function Rc(e,s){return s=nl({mode:"visible",children:s},e.mode),s.return=e,e.child=s}function nl(e,s){return e=Xe(22,e,null,s),e.lanes=0,e}function Oc(e,s,a){return Gs(s,e.child,null,a),e=Rc(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Gf(e,s,a){e.lanes|=s;var o=e.alternate;o!==null&&(o.lanes|=s),Yo(e.return,s,a)}function kc(e,s,a,o,d,m){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d,treeForkCount:m}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=a,v.tailMode=d,v.treeForkCount=m)}function qf(e,s,a){var o=s.pendingProps,d=o.revealOrder,m=o.tail;o=o.children;var v=ee.current,E=(v&2)!==0;if(E?(v=v&1|2,s.flags|=128):v&=1,q(ee,v),ve(e,s,o,a),o=Tt?ma:0,!E&&e!==null&&(e.flags&128)!==0)t:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Gf(e,a,s);else if(e.tag===19)Gf(e,a,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break t;for(;e.sibling===null;){if(e.return===null||e.return===s)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=s.child,d=null;a!==null;)e=a.alternate,e!==null&&Xr(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=s.child,s.child=null):(d=a.sibling,a.sibling=null),kc(s,!1,d,a,m,o);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=s.child,s.child=null;d!==null;){if(e=d.alternate,e!==null&&Xr(e)===null){s.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}kc(s,!0,a,null,m,o);break;case"together":kc(s,!1,null,null,void 0,o);break;default:s.memoizedState=null}return s.child}function Ui(e,s,a){if(e!==null&&(s.dependencies=e.dependencies),fs|=s.lanes,(a&s.childLanes)===0)if(e!==null){if(An(e,s,a,!1),(a&s.childLanes)===0)return null}else return null;if(e!==null&&s.child!==e.child)throw Error(n(153));if(s.child!==null){for(e=s.child,a=Li(e,e.pendingProps),s.child=a,a.return=s;e.sibling!==null;)e=e.sibling,a=a.sibling=Li(e,e.pendingProps),a.return=s;a.sibling=null}return s.child}function Lc(e,s){return(e.lanes&s)!==0?!0:(e=e.dependencies,!!(e!==null&&Pr(e)))}function gb(e,s,a){switch(s.tag){case 3:Nt(s,s.stateNode.containerInfo),as(s,ne,e.memoizedState.cache),zs();break;case 27:case 5:Ms(s);break;case 4:Nt(s,s.stateNode.containerInfo);break;case 10:as(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,ac(s),null;break;case 13:var o=s.memoizedState;if(o!==null)return o.dehydrated!==null?(cs(s),s.flags|=128,null):(a&s.child.childLanes)!==0?Hf(e,s,a):(cs(s),e=Ui(e,s,a),e!==null?e.sibling:null);cs(s);break;case 19:var d=(e.flags&128)!==0;if(o=(a&s.childLanes)!==0,o||(An(e,s,a,!1),o=(a&s.childLanes)!==0),d){if(o)return qf(e,s,a);s.flags|=128}if(d=s.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),q(ee,ee.current),o)break;return null;case 22:return s.lanes=0,jf(e,s,a,s.pendingProps);case 24:as(s,ne,e.memoizedState.cache)}return Ui(e,s,a)}function Vf(e,s,a){if(e!==null)if(e.memoizedProps!==s.pendingProps)re=!0;else{if(!Lc(e,a)&&(s.flags&128)===0)return re=!1,gb(e,s,a);re=(e.flags&131072)!==0}else re=!1,Tt&&(s.flags&1048576)!==0&&wd(s,ma,s.index);switch(s.lanes=0,s.tag){case 16:t:{var o=s.pendingProps;if(e=Is(s.elementType),s.type=e,typeof e=="function")Fo(e)?(o=Vs(e,o),s.tag=1,s=Uf(null,s,e,o,a)):(s.tag=0,s=Tc(null,s,e,o,a));else{if(e!=null){var d=e.$$typeof;if(d===R){s.tag=11,s=kf(null,s,e,o,a);break t}else if(d===j){s.tag=14,s=Lf(null,s,e,o,a);break t}}throw s=ht(e)||e,Error(n(306,s,""))}}return s;case 0:return Tc(e,s,s.type,s.pendingProps,a);case 1:return o=s.type,d=Vs(o,s.pendingProps),Uf(e,s,o,d,a);case 3:t:{if(Nt(s,s.stateNode.containerInfo),e===null)throw Error(n(387));o=s.pendingProps;var m=s.memoizedState;d=m.element,tc(e,s),_a(s,o,null,a);var v=s.memoizedState;if(o=v.cache,as(s,ne,o),o!==m.cache&&Ko(s,[ne],a,!0),wa(),o=v.element,m.isDehydrated)if(m={element:o,isDehydrated:!1,cache:v.cache},s.updateQueue.baseState=m,s.memoizedState=m,s.flags&256){s=If(e,s,o,a);break t}else if(o!==d){d=si(Error(n(424)),s),ga(d),s=If(e,s,o,a);break t}else for(e=s.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Vt=oi(e.firstChild),ye=s,Tt=!0,ss=null,ri=!0,a=Bd(s,null,o,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(zs(),o===d){s=Ui(e,s,a);break t}ve(e,s,o,a)}s=s.child}return s;case 26:return sl(e,s),e===null?(a=im(s.type,null,s.pendingProps,null))?s.memoizedState=a:Tt||(a=s.type,e=s.pendingProps,o=Al(ot.current).createElement(a),o[ge]=s,o[Re]=e,Ae(o,a,e),de(o),s.stateNode=o):s.memoizedState=im(s.type,e.memoizedProps,s.pendingProps,e.memoizedState),null;case 27:return Ms(s),e===null&&Tt&&(o=s.stateNode=Jp(s.type,s.pendingProps,ot.current),ye=s,ri=!0,d=Vt,bs(s.type)?(fu=d,Vt=oi(o.firstChild)):Vt=d),ve(e,s,s.pendingProps.children,a),sl(e,s),e===null&&(s.flags|=4194304),s.child;case 5:return e===null&&Tt&&((d=o=Vt)&&(o=Xb(o,s.type,s.pendingProps,ri),o!==null?(s.stateNode=o,ye=s,Vt=oi(o.firstChild),ri=!1,d=!0):d=!1),d||ns(s)),Ms(s),d=s.type,m=s.pendingProps,v=e!==null?e.memoizedProps:null,o=m.children,ou(d,m)?o=null:v!==null&&ou(d,v)&&(s.flags|=32),s.memoizedState!==null&&(d=lc(e,s,lb,null,null,a),Ga._currentValue=d),sl(e,s),ve(e,s,o,a),s.child;case 6:return e===null&&Tt&&((e=a=Vt)&&(a=Yb(a,s.pendingProps,ri),a!==null?(s.stateNode=a,ye=s,Vt=null,e=!0):e=!1),e||ns(s)),null;case 13:return Hf(e,s,a);case 4:return Nt(s,s.stateNode.containerInfo),o=s.pendingProps,e===null?s.child=Gs(s,null,o,a):ve(e,s,o,a),s.child;case 11:return kf(e,s,s.type,s.pendingProps,a);case 7:return ve(e,s,s.pendingProps,a),s.child;case 8:return ve(e,s,s.pendingProps.children,a),s.child;case 12:return ve(e,s,s.pendingProps.children,a),s.child;case 10:return o=s.pendingProps,as(s,s.type,o.value),ve(e,s,o.children,a),s.child;case 9:return d=s.type._context,o=s.pendingProps.children,Fs(s),d=be(d),o=o(d),s.flags|=1,ve(e,s,o,a),s.child;case 14:return Lf(e,s,s.type,s.pendingProps,a);case 15:return Bf(e,s,s.type,s.pendingProps,a);case 19:return qf(e,s,a);case 31:return mb(e,s,a);case 22:return jf(e,s,a,s.pendingProps);case 24:return Fs(s),o=be(ne),e===null?(d=Wo(),d===null&&(d=Gt,m=$o(),d.pooledCache=m,m.refCount++,m!==null&&(d.pooledCacheLanes|=a),d=m),s.memoizedState={parent:o,cache:d},Jo(s),as(s,ne,d)):((e.lanes&a)!==0&&(tc(e,s),_a(s,null,null,a),wa()),d=e.memoizedState,m=s.memoizedState,d.parent!==o?(d={parent:o,cache:o},s.memoizedState=d,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=d),as(s,ne,o)):(o=m.cache,as(s,ne,o),o!==d.cache&&Ko(s,[ne],a,!0))),ve(e,s,s.pendingProps.children,a),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Ii(e){e.flags|=4}function Bc(e,s,a,o,d){if((s=(e.mode&32)!==0)&&(s=!1),s){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(bp())e.flags|=8192;else throw Hs=Hr,Zo}else e.flags&=-16777217}function Xf(e,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lm(s))if(bp())e.flags|=8192;else throw Hs=Hr,Zo}function al(e,s){s!==null&&(e.flags|=4),e.flags&16384&&(s=e.tag!==22?xh():536870912,e.lanes|=s,On|=s)}function Da(e,s){if(!Tt)switch(e.tailMode){case"hidden":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Xt(e){var s=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(s)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,s}function yb(e,s,a){var o=s.pendingProps;switch(Go(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(s),null;case 1:return Xt(s),null;case 3:return a=s.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),zi(ne),Rt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(vn(s)?Ii(s):e===null||e.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Vo())),Xt(s),null;case 26:var d=s.type,m=s.memoizedState;return e===null?(Ii(s),m!==null?(Xt(s),Xf(s,m)):(Xt(s),Bc(s,d,null,o,a))):m?m!==e.memoizedState?(Ii(s),Xt(s),Xf(s,m)):(Xt(s),s.flags&=-16777217):(e=e.memoizedProps,e!==o&&Ii(s),Xt(s),Bc(s,d,e,o,a)),null;case 27:if(Zi(s),a=ot.current,d=s.type,e!==null&&s.stateNode!=null)e.memoizedProps!==o&&Ii(s);else{if(!o){if(s.stateNode===null)throw Error(n(166));return Xt(s),null}e=W.current,vn(s)?xd(s):(e=Jp(d,o,a),s.stateNode=e,Ii(s))}return Xt(s),null;case 5:if(Zi(s),d=s.type,e!==null&&s.stateNode!=null)e.memoizedProps!==o&&Ii(s);else{if(!o){if(s.stateNode===null)throw Error(n(166));return Xt(s),null}if(m=W.current,vn(s))xd(s);else{var v=Al(ot.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?m.multiple=!0:o.size&&(m.size=o.size);break;default:m=typeof o.is=="string"?v.createElement(d,{is:o.is}):v.createElement(d)}}m[ge]=s,m[Re]=o;t:for(v=s.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===s)break t;for(;v.sibling===null;){if(v.return===null||v.return===s)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}s.stateNode=m;t:switch(Ae(m,d,o),d){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Ii(s)}}return Xt(s),Bc(s,s.type,e===null?null:e.memoizedProps,s.pendingProps,a),null;case 6:if(e&&s.stateNode!=null)e.memoizedProps!==o&&Ii(s);else{if(typeof o!="string"&&s.stateNode===null)throw Error(n(166));if(e=ot.current,vn(s)){if(e=s.stateNode,a=s.memoizedProps,o=null,d=ye,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[ge]=s,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||Hp(e.nodeValue,a)),e||ns(s,!0)}else e=Al(e).createTextNode(o),e[ge]=s,s.stateNode=e}return Xt(s),null;case 31:if(a=s.memoizedState,e===null||e.memoizedState!==null){if(o=vn(s),a!==null){if(e===null){if(!o)throw Error(n(318));if(e=s.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(557));e[ge]=s}else zs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Xt(s),e=!1}else a=Vo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return s.flags&256?(Ke(s),s):(Ke(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Xt(s),null;case 13:if(o=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=vn(s),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(n(318));if(d=s.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));d[ge]=s}else zs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Xt(s),d=!1}else d=Vo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return s.flags&256?(Ke(s),s):(Ke(s),null)}return Ke(s),(s.flags&128)!==0?(s.lanes=a,s):(a=o!==null,e=e!==null&&e.memoizedState!==null,a&&(o=s.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==d&&(o.flags|=2048)),a!==e&&a&&(s.child.flags|=8192),al(s,s.updateQueue),Xt(s),null);case 4:return Rt(),e===null&&su(s.stateNode.containerInfo),Xt(s),null;case 10:return zi(s.type),Xt(s),null;case 19:if(H(ee),o=s.memoizedState,o===null)return Xt(s),null;if(d=(s.flags&128)!==0,m=o.rendering,m===null)if(d)Da(o,!1);else{if(Jt!==0||e!==null&&(e.flags&128)!==0)for(e=s.child;e!==null;){if(m=Xr(e),m!==null){for(s.flags|=128,Da(o,!1),e=m.updateQueue,s.updateQueue=e,al(s,e),s.subtreeFlags=0,e=a,a=s.child;a!==null;)vd(a,e),a=a.sibling;return q(ee,ee.current&1|2),Tt&&Bi(s,o.treeForkCount),s.child}e=e.sibling}o.tail!==null&&He()>ul&&(s.flags|=128,d=!0,Da(o,!1),s.lanes=4194304)}else{if(!d)if(e=Xr(m),e!==null){if(s.flags|=128,d=!0,e=e.updateQueue,s.updateQueue=e,al(s,e),Da(o,!0),o.tail===null&&o.tailMode==="hidden"&&!m.alternate&&!Tt)return Xt(s),null}else 2*He()-o.renderingStartTime>ul&&a!==536870912&&(s.flags|=128,d=!0,Da(o,!1),s.lanes=4194304);o.isBackwards?(m.sibling=s.child,s.child=m):(e=o.last,e!==null?e.sibling=m:s.child=m,o.last=m)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=He(),e.sibling=null,a=ee.current,q(ee,d?a&1|2:a&1),Tt&&Bi(s,o.treeForkCount),e):(Xt(s),null);case 22:case 23:return Ke(s),nc(),o=s.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(s.flags|=8192):o&&(s.flags|=8192),o?(a&536870912)!==0&&(s.flags&128)===0&&(Xt(s),s.subtreeFlags&6&&(s.flags|=8192)):Xt(s),a=s.updateQueue,a!==null&&al(s,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),o!==a&&(s.flags|=2048),e!==null&&H(Us),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),s.memoizedState.cache!==a&&(s.flags|=2048),zi(ne),Xt(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function bb(e,s){switch(Go(s),s.tag){case 1:return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return zi(ne),Rt(),e=s.flags,(e&65536)!==0&&(e&128)===0?(s.flags=e&-65537|128,s):null;case 26:case 27:case 5:return Zi(s),null;case 31:if(s.memoizedState!==null){if(Ke(s),s.alternate===null)throw Error(n(340));zs()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 13:if(Ke(s),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(n(340));zs()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return H(ee),null;case 4:return Rt(),null;case 10:return zi(s.type),null;case 22:case 23:return Ke(s),nc(),e!==null&&H(Us),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 24:return zi(ne),null;case 25:return null;default:return null}}function Yf(e,s){switch(Go(s),s.tag){case 3:zi(ne),Rt();break;case 26:case 27:case 5:Zi(s);break;case 4:Rt();break;case 31:s.memoizedState!==null&&Ke(s);break;case 13:Ke(s);break;case 19:H(ee);break;case 10:zi(s.type);break;case 22:case 23:Ke(s),nc(),e!==null&&H(Us);break;case 24:zi(ne)}}function Na(e,s){try{var a=s.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var m=a.create,v=a.inst;o=m(),v.destroy=o}a=a.next}while(a!==d)}}catch(E){Pt(s,s.return,E)}}function hs(e,s,a){try{var o=s.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var m=d.next;o=m;do{if((o.tag&e)===e){var v=o.inst,E=v.destroy;if(E!==void 0){v.destroy=void 0,d=s;var D=a,F=E;try{F()}catch(X){Pt(d,D,X)}}}o=o.next}while(o!==m)}}catch(X){Pt(s,s.return,X)}}function Kf(e){var s=e.updateQueue;if(s!==null){var a=e.stateNode;try{zd(s,a)}catch(o){Pt(e,e.return,o)}}}function $f(e,s,a){a.props=Vs(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){Pt(e,s,o)}}function Ra(e,s){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){Pt(e,s,d)}}function Si(e,s){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){Pt(e,s,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Pt(e,s,d)}else a.current=null}function Qf(e){var s=e.type,a=e.memoizedProps,o=e.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break t;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){Pt(e,e.return,d)}}function jc(e,s,a){try{var o=e.stateNode;Ub(o,e.type,a,s),o[Re]=s}catch(d){Pt(e,e.return,d)}}function Wf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&bs(e.type)||e.tag===4}function zc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Wf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&bs(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Pc(e,s,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,s):(s=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,s.appendChild(e),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Oi));else if(o!==4&&(o===27&&bs(e.type)&&(a=e.stateNode,s=null),e=e.child,e!==null))for(Pc(e,s,a),e=e.sibling;e!==null;)Pc(e,s,a),e=e.sibling}function rl(e,s,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,s?a.insertBefore(e,s):a.appendChild(e);else if(o!==4&&(o===27&&bs(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(rl(e,s,a),e=e.sibling;e!==null;)rl(e,s,a),e=e.sibling}function Zf(e){var s=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=s.attributes;d.length;)s.removeAttributeNode(d[0]);Ae(s,o,a),s[ge]=e,s[Re]=a}catch(m){Pt(e,e.return,m)}}var Hi=!1,le=!1,Fc=!1,Jf=typeof WeakSet=="function"?WeakSet:Set,fe=null;function vb(e,s){if(e=e.containerInfo,ru=Tl,e=ud(e),Oo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,m=o.focusNode;o=o.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break t}var v=0,E=-1,D=-1,F=0,X=0,K=e,U=null;e:for(;;){for(var I;K!==a||d!==0&&K.nodeType!==3||(E=v+d),K!==m||o!==0&&K.nodeType!==3||(D=v+o),K.nodeType===3&&(v+=K.nodeValue.length),(I=K.firstChild)!==null;)U=K,K=I;for(;;){if(K===e)break e;if(U===a&&++F===d&&(E=v),U===m&&++X===o&&(D=v),(I=K.nextSibling)!==null)break;K=U,U=K.parentNode}K=I}a=E===-1||D===-1?null:{start:E,end:D}}else a=null}a=a||{start:0,end:0}}else a=null;for(lu={focusedElem:e,selectionRange:a},Tl=!1,fe=s;fe!==null;)if(s=fe,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,fe=e;else for(;fe!==null;){switch(s=fe,m=s.alternate,e=s.flags,s.tag){case 0:if((e&4)!==0&&(e=s.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&m!==null){e=void 0,a=s,d=m.memoizedProps,m=m.memoizedState,o=a.stateNode;try{var at=Vs(a.type,d);e=o.getSnapshotBeforeUpdate(at,m),o.__reactInternalSnapshotBeforeUpdate=e}catch(dt){Pt(a,a.return,dt)}}break;case 3:if((e&1024)!==0){if(e=s.stateNode.containerInfo,a=e.nodeType,a===9)uu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":uu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(n(163))}if(e=s.sibling,e!==null){e.return=s.return,fe=e;break}fe=s.return}}function tp(e,s,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:qi(e,a),o&4&&Na(5,a);break;case 1:if(qi(e,a),o&4)if(e=a.stateNode,s===null)try{e.componentDidMount()}catch(v){Pt(a,a.return,v)}else{var d=Vs(a.type,s.memoizedProps);s=s.memoizedState;try{e.componentDidUpdate(d,s,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Pt(a,a.return,v)}}o&64&&Kf(a),o&512&&Ra(a,a.return);break;case 3:if(qi(e,a),o&64&&(e=a.updateQueue,e!==null)){if(s=null,a.child!==null)switch(a.child.tag){case 27:case 5:s=a.child.stateNode;break;case 1:s=a.child.stateNode}try{zd(e,s)}catch(v){Pt(a,a.return,v)}}break;case 27:s===null&&o&4&&Zf(a);case 26:case 5:qi(e,a),s===null&&o&4&&Qf(a),o&512&&Ra(a,a.return);break;case 12:qi(e,a);break;case 31:qi(e,a),o&4&&sp(e,a);break;case 13:qi(e,a),o&4&&np(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Mb.bind(null,a),Kb(e,a))));break;case 22:if(o=a.memoizedState!==null||Hi,!o){s=s!==null&&s.memoizedState!==null||le,d=Hi;var m=le;Hi=o,(le=s)&&!m?Vi(e,a,(a.subtreeFlags&8772)!==0):qi(e,a),Hi=d,le=m}break;case 30:break;default:qi(e,a)}}function ep(e){var s=e.alternate;s!==null&&(e.alternate=null,ep(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&mo(s)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Yt=null,ke=!1;function Gi(e,s,a){for(a=a.child;a!==null;)ip(e,s,a),a=a.sibling}function ip(e,s,a){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(ea,a)}catch{}switch(a.tag){case 26:le||Si(a,s),Gi(e,s,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:le||Si(a,s);var o=Yt,d=ke;bs(a.type)&&(Yt=a.stateNode,ke=!1),Gi(e,s,a),Ua(a.stateNode),Yt=o,ke=d;break;case 5:le||Si(a,s);case 6:if(o=Yt,d=ke,Yt=null,Gi(e,s,a),Yt=o,ke=d,Yt!==null)if(ke)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(a.stateNode)}catch(m){Pt(a,s,m)}else try{Yt.removeChild(a.stateNode)}catch(m){Pt(a,s,m)}break;case 18:Yt!==null&&(ke?(e=Yt,Kp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Un(e)):Kp(Yt,a.stateNode));break;case 4:o=Yt,d=ke,Yt=a.stateNode.containerInfo,ke=!0,Gi(e,s,a),Yt=o,ke=d;break;case 0:case 11:case 14:case 15:hs(2,a,s),le||hs(4,a,s),Gi(e,s,a);break;case 1:le||(Si(a,s),o=a.stateNode,typeof o.componentWillUnmount=="function"&&$f(a,s,o)),Gi(e,s,a);break;case 21:Gi(e,s,a);break;case 22:le=(o=le)||a.memoizedState!==null,Gi(e,s,a),le=o;break;default:Gi(e,s,a)}}function sp(e,s){if(s.memoizedState===null&&(e=s.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Un(e)}catch(a){Pt(s,s.return,a)}}}function np(e,s){if(s.memoizedState===null&&(e=s.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Un(e)}catch(a){Pt(s,s.return,a)}}function Ab(e){switch(e.tag){case 31:case 13:case 19:var s=e.stateNode;return s===null&&(s=e.stateNode=new Jf),s;case 22:return e=e.stateNode,s=e._retryCache,s===null&&(s=e._retryCache=new Jf),s;default:throw Error(n(435,e.tag))}}function ll(e,s){var a=Ab(e);s.forEach(function(o){if(!a.has(o)){a.add(o);var d=Db.bind(null,e,o);o.then(d,d)}})}function Le(e,s){var a=s.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],m=e,v=s,E=v;t:for(;E!==null;){switch(E.tag){case 27:if(bs(E.type)){Yt=E.stateNode,ke=!1;break t}break;case 5:Yt=E.stateNode,ke=!1;break t;case 3:case 4:Yt=E.stateNode.containerInfo,ke=!0;break t}E=E.return}if(Yt===null)throw Error(n(160));ip(m,v,d),Yt=null,ke=!1,m=d.alternate,m!==null&&(m.return=null),d.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)ap(s,e),s=s.sibling}var gi=null;function ap(e,s){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Le(s,e),Be(e),o&4&&(hs(3,e,e.return),Na(3,e),hs(5,e,e.return));break;case 1:Le(s,e),Be(e),o&512&&(le||a===null||Si(a,a.return)),o&64&&Hi&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=gi;if(Le(s,e),Be(e),o&512&&(le||a===null||Si(a,a.return)),o&4){var m=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){t:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(o){case"title":m=d.getElementsByTagName("title")[0],(!m||m[na]||m[ge]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=d.createElement(o),d.head.insertBefore(m,d.querySelector("head > title"))),Ae(m,o,a),m[ge]=e,de(m),o=m;break t;case"link":var v=am("link","href",d).get(o+(a.href||""));if(v){for(var E=0;E<v.length;E++)if(m=v[E],m.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&m.getAttribute("rel")===(a.rel==null?null:a.rel)&&m.getAttribute("title")===(a.title==null?null:a.title)&&m.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(E,1);break e}}m=d.createElement(o),Ae(m,o,a),d.head.appendChild(m);break;case"meta":if(v=am("meta","content",d).get(o+(a.content||""))){for(E=0;E<v.length;E++)if(m=v[E],m.getAttribute("content")===(a.content==null?null:""+a.content)&&m.getAttribute("name")===(a.name==null?null:a.name)&&m.getAttribute("property")===(a.property==null?null:a.property)&&m.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&m.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(E,1);break e}}m=d.createElement(o),Ae(m,o,a),d.head.appendChild(m);break;default:throw Error(n(468,o))}m[ge]=e,de(m),o=m}e.stateNode=o}else rm(d,e.type,e.stateNode);else e.stateNode=nm(d,o,e.memoizedProps);else m!==o?(m===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):m.count--,o===null?rm(d,e.type,e.stateNode):nm(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&jc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Le(s,e),Be(e),o&512&&(le||a===null||Si(a,a.return)),a!==null&&o&4&&jc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Le(s,e),Be(e),o&512&&(le||a===null||Si(a,a.return)),e.flags&32){d=e.stateNode;try{cn(d,"")}catch(at){Pt(e,e.return,at)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,jc(e,d,a!==null?a.memoizedProps:d)),o&1024&&(Fc=!0);break;case 6:if(Le(s,e),Be(e),o&4){if(e.stateNode===null)throw Error(n(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(at){Pt(e,e.return,at)}}break;case 3:if(_l=null,d=gi,gi=Sl(s.containerInfo),Le(s,e),gi=d,Be(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{Un(s.containerInfo)}catch(at){Pt(e,e.return,at)}Fc&&(Fc=!1,rp(e));break;case 4:o=gi,gi=Sl(e.stateNode.containerInfo),Le(s,e),Be(e),gi=o;break;case 12:Le(s,e),Be(e);break;case 31:Le(s,e),Be(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ll(e,o)));break;case 13:Le(s,e),Be(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(cl=He()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ll(e,o)));break;case 22:d=e.memoizedState!==null;var D=a!==null&&a.memoizedState!==null,F=Hi,X=le;if(Hi=F||d,le=X||D,Le(s,e),le=X,Hi=F,Be(e),o&8192)t:for(s=e.stateNode,s._visibility=d?s._visibility&-2:s._visibility|1,d&&(a===null||D||Hi||le||Xs(e)),a=null,s=e;;){if(s.tag===5||s.tag===26){if(a===null){D=a=s;try{if(m=D.stateNode,d)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{E=D.stateNode;var K=D.memoizedProps.style,U=K!=null&&K.hasOwnProperty("display")?K.display:null;E.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(at){Pt(D,D.return,at)}}}else if(s.tag===6){if(a===null){D=s;try{D.stateNode.nodeValue=d?"":D.memoizedProps}catch(at){Pt(D,D.return,at)}}}else if(s.tag===18){if(a===null){D=s;try{var I=D.stateNode;d?$p(I,!0):$p(D.stateNode,!1)}catch(at){Pt(D,D.return,at)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===e)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break t;for(;s.sibling===null;){if(s.return===null||s.return===e)break t;a===s&&(a=null),s=s.return}a===s&&(a=null),s.sibling.return=s.return,s=s.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,ll(e,a))));break;case 19:Le(s,e),Be(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ll(e,o)));break;case 30:break;case 21:break;default:Le(s,e),Be(e)}}function Be(e){var s=e.flags;if(s&2){try{for(var a,o=e.return;o!==null;){if(Wf(o)){a=o;break}o=o.return}if(a==null)throw Error(n(160));switch(a.tag){case 27:var d=a.stateNode,m=zc(e);rl(e,m,d);break;case 5:var v=a.stateNode;a.flags&32&&(cn(v,""),a.flags&=-33);var E=zc(e);rl(e,E,v);break;case 3:case 4:var D=a.stateNode.containerInfo,F=zc(e);Pc(e,F,D);break;default:throw Error(n(161))}}catch(X){Pt(e,e.return,X)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function rp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var s=e;rp(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),e=e.sibling}}function qi(e,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)tp(e,s.alternate,s),s=s.sibling}function Xs(e){for(e=e.child;e!==null;){var s=e;switch(s.tag){case 0:case 11:case 14:case 15:hs(4,s,s.return),Xs(s);break;case 1:Si(s,s.return);var a=s.stateNode;typeof a.componentWillUnmount=="function"&&$f(s,s.return,a),Xs(s);break;case 27:Ua(s.stateNode);case 26:case 5:Si(s,s.return),Xs(s);break;case 22:s.memoizedState===null&&Xs(s);break;case 30:Xs(s);break;default:Xs(s)}e=e.sibling}}function Vi(e,s,a){for(a=a&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var o=s.alternate,d=e,m=s,v=m.flags;switch(m.tag){case 0:case 11:case 15:Vi(d,m,a),Na(4,m);break;case 1:if(Vi(d,m,a),o=m,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(F){Pt(o,o.return,F)}if(o=m,d=o.updateQueue,d!==null){var E=o.stateNode;try{var D=d.shared.hiddenCallbacks;if(D!==null)for(d.shared.hiddenCallbacks=null,d=0;d<D.length;d++)jd(D[d],E)}catch(F){Pt(o,o.return,F)}}a&&v&64&&Kf(m),Ra(m,m.return);break;case 27:Zf(m);case 26:case 5:Vi(d,m,a),a&&o===null&&v&4&&Qf(m),Ra(m,m.return);break;case 12:Vi(d,m,a);break;case 31:Vi(d,m,a),a&&v&4&&sp(d,m);break;case 13:Vi(d,m,a),a&&v&4&&np(d,m);break;case 22:m.memoizedState===null&&Vi(d,m,a),Ra(m,m.return);break;case 30:break;default:Vi(d,m,a)}s=s.sibling}}function Uc(e,s){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(e=s.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&ya(a))}function Ic(e,s){e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&ya(e))}function yi(e,s,a,o){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)lp(e,s,a,o),s=s.sibling}function lp(e,s,a,o){var d=s.flags;switch(s.tag){case 0:case 11:case 15:yi(e,s,a,o),d&2048&&Na(9,s);break;case 1:yi(e,s,a,o);break;case 3:yi(e,s,a,o),d&2048&&(e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&ya(e)));break;case 12:if(d&2048){yi(e,s,a,o),e=s.stateNode;try{var m=s.memoizedProps,v=m.id,E=m.onPostCommit;typeof E=="function"&&E(v,s.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(D){Pt(s,s.return,D)}}else yi(e,s,a,o);break;case 31:yi(e,s,a,o);break;case 13:yi(e,s,a,o);break;case 23:break;case 22:m=s.stateNode,v=s.alternate,s.memoizedState!==null?m._visibility&2?yi(e,s,a,o):Oa(e,s):m._visibility&2?yi(e,s,a,o):(m._visibility|=2,Dn(e,s,a,o,(s.subtreeFlags&10256)!==0||!1)),d&2048&&Uc(v,s);break;case 24:yi(e,s,a,o),d&2048&&Ic(s.alternate,s);break;default:yi(e,s,a,o)}}function Dn(e,s,a,o,d){for(d=d&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var m=e,v=s,E=a,D=o,F=v.flags;switch(v.tag){case 0:case 11:case 15:Dn(m,v,E,D,d),Na(8,v);break;case 23:break;case 22:var X=v.stateNode;v.memoizedState!==null?X._visibility&2?Dn(m,v,E,D,d):Oa(m,v):(X._visibility|=2,Dn(m,v,E,D,d)),d&&F&2048&&Uc(v.alternate,v);break;case 24:Dn(m,v,E,D,d),d&&F&2048&&Ic(v.alternate,v);break;default:Dn(m,v,E,D,d)}s=s.sibling}}function Oa(e,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var a=e,o=s,d=o.flags;switch(o.tag){case 22:Oa(a,o),d&2048&&Uc(o.alternate,o);break;case 24:Oa(a,o),d&2048&&Ic(o.alternate,o);break;default:Oa(a,o)}s=s.sibling}}var ka=8192;function Nn(e,s,a){if(e.subtreeFlags&ka)for(e=e.child;e!==null;)op(e,s,a),e=e.sibling}function op(e,s,a){switch(e.tag){case 26:Nn(e,s,a),e.flags&ka&&e.memoizedState!==null&&rv(a,gi,e.memoizedState,e.memoizedProps);break;case 5:Nn(e,s,a);break;case 3:case 4:var o=gi;gi=Sl(e.stateNode.containerInfo),Nn(e,s,a),gi=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=ka,ka=16777216,Nn(e,s,a),ka=o):Nn(e,s,a));break;default:Nn(e,s,a)}}function cp(e){var s=e.alternate;if(s!==null&&(e=s.child,e!==null)){s.child=null;do s=e.sibling,e.sibling=null,e=s;while(e!==null)}}function La(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var o=s[a];fe=o,hp(o,e)}cp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)up(e),e=e.sibling}function up(e){switch(e.tag){case 0:case 11:case 15:La(e),e.flags&2048&&hs(9,e,e.return);break;case 3:La(e);break;case 12:La(e);break;case 22:var s=e.stateNode;e.memoizedState!==null&&s._visibility&2&&(e.return===null||e.return.tag!==13)?(s._visibility&=-3,ol(e)):La(e);break;default:La(e)}}function ol(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var o=s[a];fe=o,hp(o,e)}cp(e)}for(e=e.child;e!==null;){switch(s=e,s.tag){case 0:case 11:case 15:hs(8,s,s.return),ol(s);break;case 22:a=s.stateNode,a._visibility&2&&(a._visibility&=-3,ol(s));break;default:ol(s)}e=e.sibling}}function hp(e,s){for(;fe!==null;){var a=fe;switch(a.tag){case 0:case 11:case 15:hs(8,a,s);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:ya(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,fe=o;else t:for(a=e;fe!==null;){o=fe;var d=o.sibling,m=o.return;if(ep(o),o===a){fe=null;break t}if(d!==null){d.return=m,fe=d;break t}fe=m}}}var Sb={getCacheForType:function(e){var s=be(ne),a=s.data.get(e);return a===void 0&&(a=e(),s.data.set(e,a)),a},cacheSignal:function(){return be(ne).controller.signal}},wb=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Gt=null,_t=null,Et=0,zt=0,$e=null,ds=!1,Rn=!1,Hc=!1,Xi=0,Jt=0,fs=0,Ys=0,Gc=0,Qe=0,On=0,Ba=null,je=null,qc=!1,cl=0,dp=0,ul=1/0,hl=null,ps=null,he=0,ms=null,kn=null,Yi=0,Vc=0,Xc=null,fp=null,ja=0,Yc=null;function We(){return(Lt&2)!==0&&Et!==0?Et&-Et:B.T!==null?Jc():Mh()}function pp(){if(Qe===0)if((Et&536870912)===0||Tt){var e=vr;vr<<=1,(vr&3932160)===0&&(vr=262144),Qe=e}else Qe=536870912;return e=Ye.current,e!==null&&(e.flags|=32),Qe}function ze(e,s,a){(e===Gt&&(zt===2||zt===9)||e.cancelPendingCommit!==null)&&(Ln(e,0),gs(e,Et,Qe,!1)),sa(e,a),((Lt&2)===0||e!==Gt)&&(e===Gt&&((Lt&2)===0&&(Ys|=a),Jt===4&&gs(e,Et,Qe,!1)),wi(e))}function mp(e,s,a){if((Lt&6)!==0)throw Error(n(327));var o=!a&&(s&127)===0&&(s&e.expiredLanes)===0||ia(e,s),d=o?Eb(e,s):$c(e,s,!0),m=o;do{if(d===0){Rn&&!o&&gs(e,s,0,!1);break}else{if(a=e.current.alternate,m&&!_b(a)){d=$c(e,s,!1),m=!1;continue}if(d===2){if(m=s,e.errorRecoveryDisabledLanes&m)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){s=v;t:{var E=e;d=Ba;var D=E.current.memoizedState.isDehydrated;if(D&&(Ln(E,v).flags|=256),v=$c(E,v,!1),v!==2){if(Hc&&!D){E.errorRecoveryDisabledLanes|=m,Ys|=m,d=4;break t}m=je,je=d,m!==null&&(je===null?je=m:je.push.apply(je,m))}d=v}if(m=!1,d!==2)continue}}if(d===1){Ln(e,0),gs(e,s,0,!0);break}t:{switch(o=e,m=d,m){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:gs(o,s,Qe,!ds);break t;case 2:je=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(d=cl+300-He(),10<d)){if(gs(o,s,Qe,!ds),Sr(o,0,!0)!==0)break t;Yi=s,o.timeoutHandle=Xp(gp.bind(null,o,a,je,hl,qc,s,Qe,Ys,On,ds,m,"Throttled",-0,0),d);break t}gp(o,a,je,hl,qc,s,Qe,Ys,On,ds,m,null,-0,0)}}break}while(!0);wi(e)}function gp(e,s,a,o,d,m,v,E,D,F,X,K,U,I){if(e.timeoutHandle=-1,K=s.subtreeFlags,K&8192||(K&16785408)===16785408){K={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Oi},op(s,m,K);var at=(m&62914560)===m?cl-He():(m&4194048)===m?dp-He():0;if(at=lv(K,at),at!==null){Yi=m,e.cancelPendingCommit=at(xp.bind(null,e,s,m,a,o,d,v,E,D,X,K,null,U,I)),gs(e,m,v,!F);return}}xp(e,s,m,a,o,d,v,E,D)}function _b(e){for(var s=e;;){var a=s.tag;if((a===0||a===11||a===15)&&s.flags&16384&&(a=s.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],m=d.getSnapshot;d=d.value;try{if(!Ve(m(),d))return!1}catch{return!1}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gs(e,s,a,o){s&=~Gc,s&=~Ys,e.suspendedLanes|=s,e.pingedLanes&=~s,o&&(e.warmLanes|=s),o=e.expirationTimes;for(var d=s;0<d;){var m=31-qe(d),v=1<<m;o[m]=-1,d&=~v}a!==0&&Eh(e,a,s)}function dl(){return(Lt&6)===0?(za(0),!1):!0}function Kc(){if(_t!==null){if(zt===0)var e=_t.return;else e=_t,ji=Ps=null,uc(e),xn=null,va=0,e=_t;for(;e!==null;)Yf(e.alternate,e),e=e.return;_t=null}}function Ln(e,s){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Gb(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Yi=0,Kc(),Gt=e,_t=a=Li(e.current,null),Et=s,zt=0,$e=null,ds=!1,Rn=ia(e,s),Hc=!1,On=Qe=Gc=Ys=fs=Jt=0,je=Ba=null,qc=!1,(s&8)!==0&&(s|=s&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=s;0<o;){var d=31-qe(o),m=1<<d;s|=e[d],o&=~m}return Xi=s,kr(),a}function yp(e,s){At=null,B.H=Ta,s===_n||s===Ir?(s=Od(),zt=3):s===Zo?(s=Od(),zt=4):zt=s===Cc?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,$e=s,_t===null&&(Jt=1,el(e,si(s,e.current)))}function bp(){var e=Ye.current;return e===null?!0:(Et&4194048)===Et?li===null:(Et&62914560)===Et||(Et&536870912)!==0?e===li:!1}function vp(){var e=B.H;return B.H=Ta,e===null?Ta:e}function Ap(){var e=B.A;return B.A=Sb,e}function fl(){Jt=4,ds||(Et&4194048)!==Et&&Ye.current!==null||(Rn=!0),(fs&134217727)===0&&(Ys&134217727)===0||Gt===null||gs(Gt,Et,Qe,!1)}function $c(e,s,a){var o=Lt;Lt|=2;var d=vp(),m=Ap();(Gt!==e||Et!==s)&&(hl=null,Ln(e,s)),s=!1;var v=Jt;t:do try{if(zt!==0&&_t!==null){var E=_t,D=$e;switch(zt){case 8:Kc(),v=6;break t;case 3:case 2:case 9:case 6:Ye.current===null&&(s=!0);var F=zt;if(zt=0,$e=null,Bn(e,E,D,F),a&&Rn){v=0;break t}break;default:F=zt,zt=0,$e=null,Bn(e,E,D,F)}}xb(),v=Jt;break}catch(X){yp(e,X)}while(!0);return s&&e.shellSuspendCounter++,ji=Ps=null,Lt=o,B.H=d,B.A=m,_t===null&&(Gt=null,Et=0,kr()),v}function xb(){for(;_t!==null;)Sp(_t)}function Eb(e,s){var a=Lt;Lt|=2;var o=vp(),d=Ap();Gt!==e||Et!==s?(hl=null,ul=He()+500,Ln(e,s)):Rn=ia(e,s);t:do try{if(zt!==0&&_t!==null){s=_t;var m=$e;e:switch(zt){case 1:zt=0,$e=null,Bn(e,s,m,1);break;case 2:case 9:if(Nd(m)){zt=0,$e=null,wp(s);break}s=function(){zt!==2&&zt!==9||Gt!==e||(zt=7),wi(e)},m.then(s,s);break t;case 3:zt=7;break t;case 4:zt=5;break t;case 7:Nd(m)?(zt=0,$e=null,wp(s)):(zt=0,$e=null,Bn(e,s,m,7));break;case 5:var v=null;switch(_t.tag){case 26:v=_t.memoizedState;case 5:case 27:var E=_t;if(v?lm(v):E.stateNode.complete){zt=0,$e=null;var D=E.sibling;if(D!==null)_t=D;else{var F=E.return;F!==null?(_t=F,pl(F)):_t=null}break e}}zt=0,$e=null,Bn(e,s,m,5);break;case 6:zt=0,$e=null,Bn(e,s,m,6);break;case 8:Kc(),Jt=6;break t;default:throw Error(n(462))}}Cb();break}catch(X){yp(e,X)}while(!0);return ji=Ps=null,B.H=o,B.A=d,Lt=a,_t!==null?0:(Gt=null,Et=0,kr(),Jt)}function Cb(){for(;_t!==null&&!$g();)Sp(_t)}function Sp(e){var s=Vf(e.alternate,e,Xi);e.memoizedProps=e.pendingProps,s===null?pl(e):_t=s}function wp(e){var s=e,a=s.alternate;switch(s.tag){case 15:case 0:s=Ff(a,s,s.pendingProps,s.type,void 0,Et);break;case 11:s=Ff(a,s,s.pendingProps,s.type.render,s.ref,Et);break;case 5:uc(s);default:Yf(a,s),s=_t=vd(s,Xi),s=Vf(a,s,Xi)}e.memoizedProps=e.pendingProps,s===null?pl(e):_t=s}function Bn(e,s,a,o){ji=Ps=null,uc(s),xn=null,va=0;var d=s.return;try{if(pb(e,d,s,a,Et)){Jt=1,el(e,si(a,e.current)),_t=null;return}}catch(m){if(d!==null)throw _t=d,m;Jt=1,el(e,si(a,e.current)),_t=null;return}s.flags&32768?(Tt||o===1?e=!0:Rn||(Et&536870912)!==0?e=!1:(ds=e=!0,(o===2||o===9||o===3||o===6)&&(o=Ye.current,o!==null&&o.tag===13&&(o.flags|=16384))),_p(s,e)):pl(s)}function pl(e){var s=e;do{if((s.flags&32768)!==0){_p(s,ds);return}e=s.return;var a=yb(s.alternate,s,Xi);if(a!==null){_t=a;return}if(s=s.sibling,s!==null){_t=s;return}_t=s=e}while(s!==null);Jt===0&&(Jt=5)}function _p(e,s){do{var a=bb(e.alternate,e);if(a!==null){a.flags&=32767,_t=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!s&&(e=e.sibling,e!==null)){_t=e;return}_t=e=a}while(e!==null);Jt=6,_t=null}function xp(e,s,a,o,d,m,v,E,D){e.cancelPendingCommit=null;do ml();while(he!==0);if((Lt&6)!==0)throw Error(n(327));if(s!==null){if(s===e.current)throw Error(n(177));if(m=s.lanes|s.childLanes,m|=zo,ay(e,a,m,v,E,D),e===Gt&&(_t=Gt=null,Et=0),kn=s,ms=e,Yi=a,Vc=m,Xc=d,fp=o,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Nb(yr,function(){return Dp(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||o){o=B.T,B.T=null,d=G.p,G.p=2,v=Lt,Lt|=4;try{vb(e,s,a)}finally{Lt=v,G.p=d,B.T=o}}he=1,Ep(),Cp(),Tp()}}function Ep(){if(he===1){he=0;var e=ms,s=kn,a=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||a){a=B.T,B.T=null;var o=G.p;G.p=2;var d=Lt;Lt|=4;try{ap(s,e);var m=lu,v=ud(e.containerInfo),E=m.focusedElem,D=m.selectionRange;if(v!==E&&E&&E.ownerDocument&&cd(E.ownerDocument.documentElement,E)){if(D!==null&&Oo(E)){var F=D.start,X=D.end;if(X===void 0&&(X=F),"selectionStart"in E)E.selectionStart=F,E.selectionEnd=Math.min(X,E.value.length);else{var K=E.ownerDocument||document,U=K&&K.defaultView||window;if(U.getSelection){var I=U.getSelection(),at=E.textContent.length,dt=Math.min(D.start,at),It=D.end===void 0?dt:Math.min(D.end,at);!I.extend&&dt>It&&(v=It,It=dt,dt=v);var z=od(E,dt),L=od(E,It);if(z&&L&&(I.rangeCount!==1||I.anchorNode!==z.node||I.anchorOffset!==z.offset||I.focusNode!==L.node||I.focusOffset!==L.offset)){var P=K.createRange();P.setStart(z.node,z.offset),I.removeAllRanges(),dt>It?(I.addRange(P),I.extend(L.node,L.offset)):(P.setEnd(L.node,L.offset),I.addRange(P))}}}}for(K=[],I=E;I=I.parentNode;)I.nodeType===1&&K.push({element:I,left:I.scrollLeft,top:I.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<K.length;E++){var Y=K[E];Y.element.scrollLeft=Y.left,Y.element.scrollTop=Y.top}}Tl=!!ru,lu=ru=null}finally{Lt=d,G.p=o,B.T=a}}e.current=s,he=2}}function Cp(){if(he===2){he=0;var e=ms,s=kn,a=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||a){a=B.T,B.T=null;var o=G.p;G.p=2;var d=Lt;Lt|=4;try{tp(e,s.alternate,s)}finally{Lt=d,G.p=o,B.T=a}}he=3}}function Tp(){if(he===4||he===3){he=0,Qg();var e=ms,s=kn,a=Yi,o=fp;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?he=5:(he=0,kn=ms=null,Mp(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(ps=null),fo(a),s=s.stateNode,Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(ea,s,void 0,(s.current.flags&128)===128)}catch{}if(o!==null){s=B.T,d=G.p,G.p=2,B.T=null;try{for(var m=e.onRecoverableError,v=0;v<o.length;v++){var E=o[v];m(E.value,{componentStack:E.stack})}}finally{B.T=s,G.p=d}}(Yi&3)!==0&&ml(),wi(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===Yc?ja++:(ja=0,Yc=e):ja=0,za(0)}}function Mp(e,s){(e.pooledCacheLanes&=s)===0&&(s=e.pooledCache,s!=null&&(e.pooledCache=null,ya(s)))}function ml(){return Ep(),Cp(),Tp(),Dp()}function Dp(){if(he!==5)return!1;var e=ms,s=Vc;Vc=0;var a=fo(Yi),o=B.T,d=G.p;try{G.p=32>a?32:a,B.T=null,a=Xc,Xc=null;var m=ms,v=Yi;if(he=0,kn=ms=null,Yi=0,(Lt&6)!==0)throw Error(n(331));var E=Lt;if(Lt|=4,up(m.current),lp(m,m.current,v,a),Lt=E,za(0,!1),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(ea,m)}catch{}return!0}finally{G.p=d,B.T=o,Mp(e,s)}}function Np(e,s,a){s=si(a,s),s=Ec(e.stateNode,s,2),e=os(e,s,2),e!==null&&(sa(e,2),wi(e))}function Pt(e,s,a){if(e.tag===3)Np(e,e,a);else for(;s!==null;){if(s.tag===3){Np(s,e,a);break}else if(s.tag===1){var o=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(ps===null||!ps.has(o))){e=si(a,e),a=Rf(2),o=os(s,a,2),o!==null&&(Of(a,o,s,e),sa(o,2),wi(o));break}}s=s.return}}function Qc(e,s,a){var o=e.pingCache;if(o===null){o=e.pingCache=new wb;var d=new Set;o.set(s,d)}else d=o.get(s),d===void 0&&(d=new Set,o.set(s,d));d.has(a)||(Hc=!0,d.add(a),e=Tb.bind(null,e,s,a),s.then(e,e))}function Tb(e,s,a){var o=e.pingCache;o!==null&&o.delete(s),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,Gt===e&&(Et&a)===a&&(Jt===4||Jt===3&&(Et&62914560)===Et&&300>He()-cl?(Lt&2)===0&&Ln(e,0):Gc|=a,On===Et&&(On=0)),wi(e)}function Rp(e,s){s===0&&(s=xh()),e=Bs(e,s),e!==null&&(sa(e,s),wi(e))}function Mb(e){var s=e.memoizedState,a=0;s!==null&&(a=s.retryLane),Rp(e,a)}function Db(e,s){var a=0;switch(e.tag){case 31:case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(n(314))}o!==null&&o.delete(s),Rp(e,a)}function Nb(e,s){return oo(e,s)}var gl=null,jn=null,Wc=!1,yl=!1,Zc=!1,ys=0;function wi(e){e!==jn&&e.next===null&&(jn===null?gl=jn=e:jn=jn.next=e),yl=!0,Wc||(Wc=!0,Ob())}function za(e,s){if(!Zc&&yl){Zc=!0;do for(var a=!1,o=gl;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var m=0;else{var v=o.suspendedLanes,E=o.pingedLanes;m=(1<<31-qe(42|e)+1)-1,m&=d&~(v&~E),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(a=!0,Bp(o,m))}else m=Et,m=Sr(o,o===Gt?m:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(m&3)===0||ia(o,m)||(a=!0,Bp(o,m));o=o.next}while(a);Zc=!1}}function Rb(){Op()}function Op(){yl=Wc=!1;var e=0;ys!==0&&Hb()&&(e=ys);for(var s=He(),a=null,o=gl;o!==null;){var d=o.next,m=kp(o,s);m===0?(o.next=null,a===null?gl=d:a.next=d,d===null&&(jn=a)):(a=o,(e!==0||(m&3)!==0)&&(yl=!0)),o=d}he!==0&&he!==5||za(e),ys!==0&&(ys=0)}function kp(e,s){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,m=e.pendingLanes&-62914561;0<m;){var v=31-qe(m),E=1<<v,D=d[v];D===-1?((E&a)===0||(E&o)!==0)&&(d[v]=ny(E,s)):D<=s&&(e.expiredLanes|=E),m&=~E}if(s=Gt,a=Et,a=Sr(e,e===s?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===s&&(zt===2||zt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&co(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||ia(e,a)){if(s=a&-a,s===e.callbackPriority)return s;switch(o!==null&&co(o),fo(a)){case 2:case 8:a=wh;break;case 32:a=yr;break;case 268435456:a=_h;break;default:a=yr}return o=Lp.bind(null,e),a=oo(a,o),e.callbackPriority=s,e.callbackNode=a,s}return o!==null&&o!==null&&co(o),e.callbackPriority=2,e.callbackNode=null,2}function Lp(e,s){if(he!==0&&he!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(ml()&&e.callbackNode!==a)return null;var o=Et;return o=Sr(e,e===Gt?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(mp(e,o,s),kp(e,He()),e.callbackNode!=null&&e.callbackNode===a?Lp.bind(null,e):null)}function Bp(e,s){if(ml())return null;mp(e,s,!0)}function Ob(){qb(function(){(Lt&6)!==0?oo(Sh,Rb):Op()})}function Jc(){if(ys===0){var e=Sn;e===0&&(e=br,br<<=1,(br&261888)===0&&(br=256)),ys=e}return ys}function jp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Er(""+e)}function zp(e,s){var a=s.ownerDocument.createElement("input");return a.name=s.name,a.value=s.value,e.id&&a.setAttribute("form",e.id),s.parentNode.insertBefore(a,s),e=new FormData(e),a.parentNode.removeChild(a),e}function kb(e,s,a,o,d){if(s==="submit"&&a&&a.stateNode===d){var m=jp((d[Re]||null).action),v=o.submitter;v&&(s=(s=v[Re]||null)?jp(s.formAction):v.getAttribute("formAction"),s!==null&&(m=s,v=null));var E=new Dr("action","action",null,o,d);e.push({event:E,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(ys!==0){var D=v?zp(d,v):new FormData(d);vc(a,{pending:!0,data:D,method:d.method,action:m},null,D)}}else typeof m=="function"&&(E.preventDefault(),D=v?zp(d,v):new FormData(d),vc(a,{pending:!0,data:D,method:d.method,action:m},m,D))},currentTarget:d}]})}}for(var tu=0;tu<jo.length;tu++){var eu=jo[tu],Lb=eu.toLowerCase(),Bb=eu[0].toUpperCase()+eu.slice(1);mi(Lb,"on"+Bb)}mi(fd,"onAnimationEnd"),mi(pd,"onAnimationIteration"),mi(md,"onAnimationStart"),mi("dblclick","onDoubleClick"),mi("focusin","onFocus"),mi("focusout","onBlur"),mi(Wy,"onTransitionRun"),mi(Zy,"onTransitionStart"),mi(Jy,"onTransitionCancel"),mi(gd,"onTransitionEnd"),ln("onMouseEnter",["mouseout","mouseover"]),ln("onMouseLeave",["mouseout","mouseover"]),ln("onPointerEnter",["pointerout","pointerover"]),ln("onPointerLeave",["pointerout","pointerover"]),Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pa));function Pp(e,s){s=(s&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;t:{var m=void 0;if(s)for(var v=o.length-1;0<=v;v--){var E=o[v],D=E.instance,F=E.currentTarget;if(E=E.listener,D!==m&&d.isPropagationStopped())break t;m=E,d.currentTarget=F;try{m(d)}catch(X){Or(X)}d.currentTarget=null,m=D}else for(v=0;v<o.length;v++){if(E=o[v],D=E.instance,F=E.currentTarget,E=E.listener,D!==m&&d.isPropagationStopped())break t;m=E,d.currentTarget=F;try{m(d)}catch(X){Or(X)}d.currentTarget=null,m=D}}}}function xt(e,s){var a=s[po];a===void 0&&(a=s[po]=new Set);var o=e+"__bubble";a.has(o)||(Fp(s,e,2,!1),a.add(o))}function iu(e,s,a){var o=0;s&&(o|=4),Fp(a,e,o,s)}var bl="_reactListening"+Math.random().toString(36).slice(2);function su(e){if(!e[bl]){e[bl]=!0,Rh.forEach(function(a){a!=="selectionchange"&&(jb.has(a)||iu(a,!1,e),iu(a,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[bl]||(s[bl]=!0,iu("selectionchange",!1,s))}}function Fp(e,s,a,o){switch(pm(s)){case 2:var d=uv;break;case 8:d=hv;break;default:d=bu}a=d.bind(null,s,a,e),d=void 0,!_o||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(s,a,{capture:!0,passive:d}):e.addEventListener(s,a,!0):d!==void 0?e.addEventListener(s,a,{passive:d}):e.addEventListener(s,a,!1)}function nu(e,s,a,o,d){var m=o;if((s&1)===0&&(s&2)===0&&o!==null)t:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var E=o.stateNode.containerInfo;if(E===d)break;if(v===4)for(v=o.return;v!==null;){var D=v.tag;if((D===3||D===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;E!==null;){if(v=nn(E),v===null)return;if(D=v.tag,D===5||D===6||D===26||D===27){o=m=v;continue t}E=E.parentNode}}o=o.return}Gh(function(){var F=m,X=So(a),K=[];t:{var U=yd.get(e);if(U!==void 0){var I=Dr,at=e;switch(e){case"keypress":if(Tr(a)===0)break t;case"keydown":case"keyup":I=Dy;break;case"focusin":at="focus",I=To;break;case"focusout":at="blur",I=To;break;case"beforeblur":case"afterblur":I=To;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Xh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=yy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=Oy;break;case fd:case pd:case md:I=Ay;break;case gd:I=Ly;break;case"scroll":case"scrollend":I=my;break;case"wheel":I=jy;break;case"copy":case"cut":case"paste":I=wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Kh;break;case"toggle":case"beforetoggle":I=Py}var dt=(s&4)!==0,It=!dt&&(e==="scroll"||e==="scrollend"),z=dt?U!==null?U+"Capture":null:U;dt=[];for(var L=F,P;L!==null;){var Y=L;if(P=Y.stateNode,Y=Y.tag,Y!==5&&Y!==26&&Y!==27||P===null||z===null||(Y=ra(L,z),Y!=null&&dt.push(Fa(L,Y,P))),It)break;L=L.return}0<dt.length&&(U=new I(U,at,null,a,X),K.push({event:U,listeners:dt}))}}if((s&7)===0){t:{if(U=e==="mouseover"||e==="pointerover",I=e==="mouseout"||e==="pointerout",U&&a!==Ao&&(at=a.relatedTarget||a.fromElement)&&(nn(at)||at[sn]))break t;if((I||U)&&(U=X.window===X?X:(U=X.ownerDocument)?U.defaultView||U.parentWindow:window,I?(at=a.relatedTarget||a.toElement,I=F,at=at?nn(at):null,at!==null&&(It=l(at),dt=at.tag,at!==It||dt!==5&&dt!==27&&dt!==6)&&(at=null)):(I=null,at=F),I!==at)){if(dt=Xh,Y="onMouseLeave",z="onMouseEnter",L="mouse",(e==="pointerout"||e==="pointerover")&&(dt=Kh,Y="onPointerLeave",z="onPointerEnter",L="pointer"),It=I==null?U:aa(I),P=at==null?U:aa(at),U=new dt(Y,L+"leave",I,a,X),U.target=It,U.relatedTarget=P,Y=null,nn(X)===F&&(dt=new dt(z,L+"enter",at,a,X),dt.target=P,dt.relatedTarget=It,Y=dt),It=Y,I&&at)e:{for(dt=zb,z=I,L=at,P=0,Y=z;Y;Y=dt(Y))P++;Y=0;for(var ct=L;ct;ct=dt(ct))Y++;for(;0<P-Y;)z=dt(z),P--;for(;0<Y-P;)L=dt(L),Y--;for(;P--;){if(z===L||L!==null&&z===L.alternate){dt=z;break e}z=dt(z),L=dt(L)}dt=null}else dt=null;I!==null&&Up(K,U,I,dt,!1),at!==null&&It!==null&&Up(K,It,at,dt,!0)}}t:{if(U=F?aa(F):window,I=U.nodeName&&U.nodeName.toLowerCase(),I==="select"||I==="input"&&U.type==="file")var Ot=id;else if(td(U))if(sd)Ot=Ky;else{Ot=Xy;var lt=Vy}else I=U.nodeName,!I||I.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?F&&vo(F.elementType)&&(Ot=id):Ot=Yy;if(Ot&&(Ot=Ot(e,F))){ed(K,Ot,a,X);break t}lt&&lt(e,U,F),e==="focusout"&&F&&U.type==="number"&&F.memoizedProps.value!=null&&bo(U,"number",U.value)}switch(lt=F?aa(F):window,e){case"focusin":(td(lt)||lt.contentEditable==="true")&&(fn=lt,ko=F,pa=null);break;case"focusout":pa=ko=fn=null;break;case"mousedown":Lo=!0;break;case"contextmenu":case"mouseup":case"dragend":Lo=!1,hd(K,a,X);break;case"selectionchange":if(Qy)break;case"keydown":case"keyup":hd(K,a,X)}var wt;if(Do)t:{switch(e){case"compositionstart":var Ct="onCompositionStart";break t;case"compositionend":Ct="onCompositionEnd";break t;case"compositionupdate":Ct="onCompositionUpdate";break t}Ct=void 0}else dn?Zh(e,a)&&(Ct="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ct="onCompositionStart");Ct&&($h&&a.locale!=="ko"&&(dn||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&dn&&(wt=qh()):(es=X,xo="value"in es?es.value:es.textContent,dn=!0)),lt=vl(F,Ct),0<lt.length&&(Ct=new Yh(Ct,e,null,a,X),K.push({event:Ct,listeners:lt}),wt?Ct.data=wt:(wt=Jh(a),wt!==null&&(Ct.data=wt)))),(wt=Uy?Iy(e,a):Hy(e,a))&&(Ct=vl(F,"onBeforeInput"),0<Ct.length&&(lt=new Yh("onBeforeInput","beforeinput",null,a,X),K.push({event:lt,listeners:Ct}),lt.data=wt)),kb(K,e,F,a,X)}Pp(K,s)})}function Fa(e,s,a){return{instance:e,listener:s,currentTarget:a}}function vl(e,s){for(var a=s+"Capture",o=[];e!==null;){var d=e,m=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||m===null||(d=ra(e,a),d!=null&&o.unshift(Fa(e,d,m)),d=ra(e,s),d!=null&&o.push(Fa(e,d,m))),e.tag===3)return o;e=e.return}return[]}function zb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Up(e,s,a,o,d){for(var m=s._reactName,v=[];a!==null&&a!==o;){var E=a,D=E.alternate,F=E.stateNode;if(E=E.tag,D!==null&&D===o)break;E!==5&&E!==26&&E!==27||F===null||(D=F,d?(F=ra(a,m),F!=null&&v.unshift(Fa(a,F,D))):d||(F=ra(a,m),F!=null&&v.push(Fa(a,F,D)))),a=a.return}v.length!==0&&e.push({event:s,listeners:v})}var Pb=/\r\n?/g,Fb=/\u0000|\uFFFD/g;function Ip(e){return(typeof e=="string"?e:""+e).replace(Pb,`
`).replace(Fb,"")}function Hp(e,s){return s=Ip(s),Ip(e)===s}function Ut(e,s,a,o,d,m){switch(a){case"children":typeof o=="string"?s==="body"||s==="textarea"&&o===""||cn(e,o):(typeof o=="number"||typeof o=="bigint")&&s!=="body"&&cn(e,""+o);break;case"className":_r(e,"class",o);break;case"tabIndex":_r(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":_r(e,a,o);break;case"style":Ih(e,o,m);break;case"data":if(s!=="object"){_r(e,"data",o);break}case"src":case"href":if(o===""&&(s!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Er(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(a==="formAction"?(s!=="input"&&Ut(e,s,"name",d.name,d,null),Ut(e,s,"formEncType",d.formEncType,d,null),Ut(e,s,"formMethod",d.formMethod,d,null),Ut(e,s,"formTarget",d.formTarget,d,null)):(Ut(e,s,"encType",d.encType,d,null),Ut(e,s,"method",d.method,d,null),Ut(e,s,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Er(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Oi);break;case"onScroll":o!=null&&xt("scroll",e);break;case"onScrollEnd":o!=null&&xt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(n(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(n(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=Er(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":xt("beforetoggle",e),xt("toggle",e),wr(e,"popover",o);break;case"xlinkActuate":Ri(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Ri(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Ri(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Ri(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Ri(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Ri(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Ri(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Ri(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Ri(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":wr(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=fy.get(a)||a,wr(e,a,o))}}function au(e,s,a,o,d,m){switch(a){case"style":Ih(e,o,m);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(n(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(n(60));e.innerHTML=a}}break;case"children":typeof o=="string"?cn(e,o):(typeof o=="number"||typeof o=="bigint")&&cn(e,""+o);break;case"onScroll":o!=null&&xt("scroll",e);break;case"onScrollEnd":o!=null&&xt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Oi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Oh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),s=a.slice(2,d?a.length-7:void 0),m=e[Re]||null,m=m!=null?m[a]:null,typeof m=="function"&&e.removeEventListener(s,m,d),typeof o=="function")){typeof m!="function"&&m!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(s,o,d);break t}a in e?e[a]=o:o===!0?e.setAttribute(a,""):wr(e,a,o)}}}function Ae(e,s,a){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",e),xt("load",e);var o=!1,d=!1,m;for(m in a)if(a.hasOwnProperty(m)){var v=a[m];if(v!=null)switch(m){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(e,s,m,v,a,null)}}d&&Ut(e,s,"srcSet",a.srcSet,a,null),o&&Ut(e,s,"src",a.src,a,null);return;case"input":xt("invalid",e);var E=m=v=d=null,D=null,F=null;for(o in a)if(a.hasOwnProperty(o)){var X=a[o];if(X!=null)switch(o){case"name":d=X;break;case"type":v=X;break;case"checked":D=X;break;case"defaultChecked":F=X;break;case"value":m=X;break;case"defaultValue":E=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(n(137,s));break;default:Ut(e,s,o,X,a,null)}}zh(e,m,E,D,F,v,d,!1);return;case"select":xt("invalid",e),o=v=m=null;for(d in a)if(a.hasOwnProperty(d)&&(E=a[d],E!=null))switch(d){case"value":m=E;break;case"defaultValue":v=E;break;case"multiple":o=E;default:Ut(e,s,d,E,a,null)}s=m,a=v,e.multiple=!!o,s!=null?on(e,!!o,s,!1):a!=null&&on(e,!!o,a,!0);return;case"textarea":xt("invalid",e),m=d=o=null;for(v in a)if(a.hasOwnProperty(v)&&(E=a[v],E!=null))switch(v){case"value":o=E;break;case"defaultValue":d=E;break;case"children":m=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:Ut(e,s,v,E,a,null)}Fh(e,o,d,m);return;case"option":for(D in a)a.hasOwnProperty(D)&&(o=a[D],o!=null)&&(D==="selected"?e.selected=o&&typeof o!="function"&&typeof o!="symbol":Ut(e,s,D,o,a,null));return;case"dialog":xt("beforetoggle",e),xt("toggle",e),xt("cancel",e),xt("close",e);break;case"iframe":case"object":xt("load",e);break;case"video":case"audio":for(o=0;o<Pa.length;o++)xt(Pa[o],e);break;case"image":xt("error",e),xt("load",e);break;case"details":xt("toggle",e);break;case"embed":case"source":case"link":xt("error",e),xt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in a)if(a.hasOwnProperty(F)&&(o=a[F],o!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Ut(e,s,F,o,a,null)}return;default:if(vo(s)){for(X in a)a.hasOwnProperty(X)&&(o=a[X],o!==void 0&&au(e,s,X,o,a,void 0));return}}for(E in a)a.hasOwnProperty(E)&&(o=a[E],o!=null&&Ut(e,s,E,o,a,null))}function Ub(e,s,a,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,m=null,v=null,E=null,D=null,F=null,X=null;for(I in a){var K=a[I];if(a.hasOwnProperty(I)&&K!=null)switch(I){case"checked":break;case"value":break;case"defaultValue":D=K;default:o.hasOwnProperty(I)||Ut(e,s,I,null,o,K)}}for(var U in o){var I=o[U];if(K=a[U],o.hasOwnProperty(U)&&(I!=null||K!=null))switch(U){case"type":m=I;break;case"name":d=I;break;case"checked":F=I;break;case"defaultChecked":X=I;break;case"value":v=I;break;case"defaultValue":E=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(137,s));break;default:I!==K&&Ut(e,s,U,I,o,K)}}yo(e,v,E,D,F,X,m,d);return;case"select":I=v=E=U=null;for(m in a)if(D=a[m],a.hasOwnProperty(m)&&D!=null)switch(m){case"value":break;case"multiple":I=D;default:o.hasOwnProperty(m)||Ut(e,s,m,null,o,D)}for(d in o)if(m=o[d],D=a[d],o.hasOwnProperty(d)&&(m!=null||D!=null))switch(d){case"value":U=m;break;case"defaultValue":E=m;break;case"multiple":v=m;default:m!==D&&Ut(e,s,d,m,o,D)}s=E,a=v,o=I,U!=null?on(e,!!a,U,!1):!!o!=!!a&&(s!=null?on(e,!!a,s,!0):on(e,!!a,a?[]:"",!1));return;case"textarea":I=U=null;for(E in a)if(d=a[E],a.hasOwnProperty(E)&&d!=null&&!o.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Ut(e,s,E,null,o,d)}for(v in o)if(d=o[v],m=a[v],o.hasOwnProperty(v)&&(d!=null||m!=null))switch(v){case"value":U=d;break;case"defaultValue":I=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(n(91));break;default:d!==m&&Ut(e,s,v,d,o,m)}Ph(e,U,I);return;case"option":for(var at in a)U=a[at],a.hasOwnProperty(at)&&U!=null&&!o.hasOwnProperty(at)&&(at==="selected"?e.selected=!1:Ut(e,s,at,null,o,U));for(D in o)U=o[D],I=a[D],o.hasOwnProperty(D)&&U!==I&&(U!=null||I!=null)&&(D==="selected"?e.selected=U&&typeof U!="function"&&typeof U!="symbol":Ut(e,s,D,U,o,I));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in a)U=a[dt],a.hasOwnProperty(dt)&&U!=null&&!o.hasOwnProperty(dt)&&Ut(e,s,dt,null,o,U);for(F in o)if(U=o[F],I=a[F],o.hasOwnProperty(F)&&U!==I&&(U!=null||I!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(137,s));break;default:Ut(e,s,F,U,o,I)}return;default:if(vo(s)){for(var It in a)U=a[It],a.hasOwnProperty(It)&&U!==void 0&&!o.hasOwnProperty(It)&&au(e,s,It,void 0,o,U);for(X in o)U=o[X],I=a[X],!o.hasOwnProperty(X)||U===I||U===void 0&&I===void 0||au(e,s,X,U,o,I);return}}for(var z in a)U=a[z],a.hasOwnProperty(z)&&U!=null&&!o.hasOwnProperty(z)&&Ut(e,s,z,null,o,U);for(K in o)U=o[K],I=a[K],!o.hasOwnProperty(K)||U===I||U==null&&I==null||Ut(e,s,K,U,o,I)}function Gp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ib(){if(typeof performance.getEntriesByType=="function"){for(var e=0,s=0,a=performance.getEntriesByType("resource"),o=0;o<a.length;o++){var d=a[o],m=d.transferSize,v=d.initiatorType,E=d.duration;if(m&&E&&Gp(v)){for(v=0,E=d.responseEnd,o+=1;o<a.length;o++){var D=a[o],F=D.startTime;if(F>E)break;var X=D.transferSize,K=D.initiatorType;X&&Gp(K)&&(D=D.responseEnd,v+=X*(D<E?1:(E-F)/(D-F)))}if(--o,s+=8*(m+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return s/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ru=null,lu=null;function Al(e){return e.nodeType===9?e:e.ownerDocument}function qp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vp(e,s){if(e===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&s==="foreignObject"?0:e}function ou(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var cu=null;function Hb(){var e=window.event;return e&&e.type==="popstate"?e===cu?!1:(cu=e,!0):(cu=null,!1)}var Xp=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,Yp=typeof Promise=="function"?Promise:void 0,qb=typeof queueMicrotask=="function"?queueMicrotask:typeof Yp<"u"?function(e){return Yp.resolve(null).then(e).catch(Vb)}:Xp;function Vb(e){setTimeout(function(){throw e})}function bs(e){return e==="head"}function Kp(e,s){var a=s,o=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(o===0){e.removeChild(d),Un(s);return}o--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")o++;else if(a==="html")Ua(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Ua(a);for(var m=a.firstChild;m;){var v=m.nextSibling,E=m.nodeName;m[na]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&m.rel.toLowerCase()==="stylesheet"||a.removeChild(m),m=v}}else a==="body"&&Ua(e.ownerDocument.body);a=d}while(a);Un(s)}function $p(e,s){var a=e;e=0;do{var o=a.nextSibling;if(a.nodeType===1?s?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(s?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=o}while(a)}function uu(e){var s=e.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var a=s;switch(s=s.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":uu(a),mo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Xb(e,s,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==s.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[na])switch(s){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(m=e.getAttribute("rel"),m==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(m!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(m=e.getAttribute("src"),(m!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&m&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(s==="input"&&e.type==="hidden"){var m=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===m)return e}else return e;if(e=oi(e.nextSibling),e===null)break}return null}function Yb(e,s,a){if(s==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=oi(e.nextSibling),e===null))return null;return e}function Qp(e,s){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=oi(e.nextSibling),e===null))return null;return e}function hu(e){return e.data==="$?"||e.data==="$~"}function du(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Kb(e,s){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=s;else if(e.data!=="$?"||a.readyState!=="loading")s();else{var o=function(){s(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function oi(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return e}var fu=null;function Wp(e){e=e.nextSibling;for(var s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(s===0)return oi(e.nextSibling);s--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||s++}e=e.nextSibling}return null}function Zp(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(s===0)return e;s--}else a!=="/$"&&a!=="/&"||s++}e=e.previousSibling}return null}function Jp(e,s,a){switch(s=Al(a),e){case"html":if(e=s.documentElement,!e)throw Error(n(452));return e;case"head":if(e=s.head,!e)throw Error(n(453));return e;case"body":if(e=s.body,!e)throw Error(n(454));return e;default:throw Error(n(451))}}function Ua(e){for(var s=e.attributes;s.length;)e.removeAttributeNode(s[0]);mo(e)}var ci=new Map,tm=new Set;function Sl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ki=G.d;G.d={f:$b,r:Qb,D:Wb,C:Zb,L:Jb,m:tv,X:iv,S:ev,M:sv};function $b(){var e=Ki.f(),s=dl();return e||s}function Qb(e){var s=an(e);s!==null&&s.tag===5&&s.type==="form"?yf(s):Ki.r(e)}var zn=typeof document>"u"?null:document;function em(e,s,a){var o=zn;if(o&&typeof s=="string"&&s){var d=ei(s);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),tm.has(d)||(tm.add(d),e={rel:e,crossOrigin:a,href:s},o.querySelector(d)===null&&(s=o.createElement("link"),Ae(s,"link",e),de(s),o.head.appendChild(s)))}}function Wb(e){Ki.D(e),em("dns-prefetch",e,null)}function Zb(e,s){Ki.C(e,s),em("preconnect",e,s)}function Jb(e,s,a){Ki.L(e,s,a);var o=zn;if(o&&e&&s){var d='link[rel="preload"][as="'+ei(s)+'"]';s==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+ei(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+ei(a.imageSizes)+'"]')):d+='[href="'+ei(e)+'"]';var m=d;switch(s){case"style":m=Pn(e);break;case"script":m=Fn(e)}ci.has(m)||(e=y({rel:"preload",href:s==="image"&&a&&a.imageSrcSet?void 0:e,as:s},a),ci.set(m,e),o.querySelector(d)!==null||s==="style"&&o.querySelector(Ia(m))||s==="script"&&o.querySelector(Ha(m))||(s=o.createElement("link"),Ae(s,"link",e),de(s),o.head.appendChild(s)))}}function tv(e,s){Ki.m(e,s);var a=zn;if(a&&e){var o=s&&typeof s.as=="string"?s.as:"script",d='link[rel="modulepreload"][as="'+ei(o)+'"][href="'+ei(e)+'"]',m=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Fn(e)}if(!ci.has(m)&&(e=y({rel:"modulepreload",href:e},s),ci.set(m,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ha(m)))return}o=a.createElement("link"),Ae(o,"link",e),de(o),a.head.appendChild(o)}}}function ev(e,s,a){Ki.S(e,s,a);var o=zn;if(o&&e){var d=rn(o).hoistableStyles,m=Pn(e);s=s||"default";var v=d.get(m);if(!v){var E={loading:0,preload:null};if(v=o.querySelector(Ia(m)))E.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":s},a),(a=ci.get(m))&&pu(e,a);var D=v=o.createElement("link");de(D),Ae(D,"link",e),D._p=new Promise(function(F,X){D.onload=F,D.onerror=X}),D.addEventListener("load",function(){E.loading|=1}),D.addEventListener("error",function(){E.loading|=2}),E.loading|=4,wl(v,s,o)}v={type:"stylesheet",instance:v,count:1,state:E},d.set(m,v)}}}function iv(e,s){Ki.X(e,s);var a=zn;if(a&&e){var o=rn(a).hoistableScripts,d=Fn(e),m=o.get(d);m||(m=a.querySelector(Ha(d)),m||(e=y({src:e,async:!0},s),(s=ci.get(d))&&mu(e,s),m=a.createElement("script"),de(m),Ae(m,"link",e),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},o.set(d,m))}}function sv(e,s){Ki.M(e,s);var a=zn;if(a&&e){var o=rn(a).hoistableScripts,d=Fn(e),m=o.get(d);m||(m=a.querySelector(Ha(d)),m||(e=y({src:e,async:!0,type:"module"},s),(s=ci.get(d))&&mu(e,s),m=a.createElement("script"),de(m),Ae(m,"link",e),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},o.set(d,m))}}function im(e,s,a,o){var d=(d=ot.current)?Sl(d):null;if(!d)throw Error(n(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(s=Pn(a.href),a=rn(d).hoistableStyles,o=a.get(s),o||(o={type:"style",instance:null,count:0,state:null},a.set(s,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Pn(a.href);var m=rn(d).hoistableStyles,v=m.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(e,v),(m=d.querySelector(Ia(e)))&&!m._p&&(v.instance=m,v.state.loading=5),ci.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ci.set(e,a),m||nv(d,e,a,v.state))),s&&o===null)throw Error(n(528,""));return v}if(s&&o!==null)throw Error(n(529,""));return null;case"script":return s=a.async,a=a.src,typeof a=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Fn(a),a=rn(d).hoistableScripts,o=a.get(s),o||(o={type:"script",instance:null,count:0,state:null},a.set(s,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,e))}}function Pn(e){return'href="'+ei(e)+'"'}function Ia(e){return'link[rel="stylesheet"]['+e+"]"}function sm(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function nv(e,s,a,o){e.querySelector('link[rel="preload"][as="style"]['+s+"]")?o.loading=1:(s=e.createElement("link"),o.preload=s,s.addEventListener("load",function(){return o.loading|=1}),s.addEventListener("error",function(){return o.loading|=2}),Ae(s,"link",a),de(s),e.head.appendChild(s))}function Fn(e){return'[src="'+ei(e)+'"]'}function Ha(e){return"script[async]"+e}function nm(e,s,a){if(s.count++,s.instance===null)switch(s.type){case"style":var o=e.querySelector('style[data-href~="'+ei(a.href)+'"]');if(o)return s.instance=o,de(o),o;var d=y({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),de(o),Ae(o,"style",d),wl(o,a.precedence,e),s.instance=o;case"stylesheet":d=Pn(a.href);var m=e.querySelector(Ia(d));if(m)return s.state.loading|=4,s.instance=m,de(m),m;o=sm(a),(d=ci.get(d))&&pu(o,d),m=(e.ownerDocument||e).createElement("link"),de(m);var v=m;return v._p=new Promise(function(E,D){v.onload=E,v.onerror=D}),Ae(m,"link",o),s.state.loading|=4,wl(m,a.precedence,e),s.instance=m;case"script":return m=Fn(a.src),(d=e.querySelector(Ha(m)))?(s.instance=d,de(d),d):(o=a,(d=ci.get(m))&&(o=y({},a),mu(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),de(d),Ae(d,"link",o),e.head.appendChild(d),s.instance=d);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(o=s.instance,s.state.loading|=4,wl(o,a.precedence,e));return s.instance}function wl(e,s,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,m=d,v=0;v<o.length;v++){var E=o[v];if(E.dataset.precedence===s)m=E;else if(m!==d)break}m?m.parentNode.insertBefore(e,m.nextSibling):(s=a.nodeType===9?a.head:a,s.insertBefore(e,s.firstChild))}function pu(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.title==null&&(e.title=s.title)}function mu(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.integrity==null&&(e.integrity=s.integrity)}var _l=null;function am(e,s,a){if(_l===null){var o=new Map,d=_l=new Map;d.set(a,o)}else d=_l,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var m=a[d];if(!(m[na]||m[ge]||e==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(s)||"";v=e+v;var E=o.get(v);E?E.push(m):o.set(v,[m])}}return o}function rm(e,s,a){e=e.ownerDocument||e,e.head.insertBefore(a,s==="title"?e.querySelector("head > title"):null)}function av(e,s,a){if(a===1||s.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(e=s.disabled,typeof s.precedence=="string"&&e==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function lm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function rv(e,s,a,o){if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=Pn(o.href),m=s.querySelector(Ia(d));if(m){s=m._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(e.count++,e=xl.bind(e),s.then(e,e)),a.state.loading|=4,a.instance=m,de(m);return}m=s.ownerDocument||s,o=sm(o),(d=ci.get(d))&&pu(o,d),m=m.createElement("link"),de(m);var v=m;v._p=new Promise(function(E,D){v.onload=E,v.onerror=D}),Ae(m,"link",o),a.instance=m}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,s),(s=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=xl.bind(e),s.addEventListener("load",a),s.addEventListener("error",a))}}var gu=0;function lv(e,s){return e.stylesheets&&e.count===0&&Cl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var o=setTimeout(function(){if(e.stylesheets&&Cl(e,e.stylesheets),e.unsuspend){var m=e.unsuspend;e.unsuspend=null,m()}},6e4+s);0<e.imgBytes&&gu===0&&(gu=62500*Ib());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Cl(e,e.stylesheets),e.unsuspend)){var m=e.unsuspend;e.unsuspend=null,m()}},(e.imgBytes>gu?50:800)+s);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(d)}}:null}function xl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var El=null;function Cl(e,s){e.stylesheets=null,e.unsuspend!==null&&(e.count++,El=new Map,s.forEach(ov,e),El=null,xl.call(e))}function ov(e,s){if(!(s.state.loading&4)){var a=El.get(e);if(a)var o=a.get(null);else{a=new Map,El.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<d.length;m++){var v=d[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),o=v)}o&&a.set(null,o)}d=s.instance,v=d.getAttribute("data-precedence"),m=a.get(v)||o,m===o&&a.set(null,d),a.set(v,d),this.count++,o=xl.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),m?m.parentNode.insertBefore(d,m.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),s.state.loading|=4}}var Ga={$$typeof:T,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function cv(e,s,a,o,d,m,v,E,D){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=uo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uo(0),this.hiddenUpdates=uo(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function om(e,s,a,o,d,m,v,E,D,F,X,K){return e=new cv(e,s,a,v,D,F,X,K,E),s=1,m===!0&&(s|=24),m=Xe(3,null,null,s),e.current=m,m.stateNode=e,s=$o(),s.refCount++,e.pooledCache=s,s.refCount++,m.memoizedState={element:o,isDehydrated:a,cache:s},Jo(m),e}function cm(e){return e?(e=gn,e):gn}function um(e,s,a,o,d,m){d=cm(d),o.context===null?o.context=d:o.pendingContext=d,o=ls(s),o.payload={element:a},m=m===void 0?null:m,m!==null&&(o.callback=m),a=os(e,o,s),a!==null&&(ze(a,e,s),Sa(a,e,s))}function hm(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<s?a:s}}function yu(e,s){hm(e,s),(e=e.alternate)&&hm(e,s)}function dm(e){if(e.tag===13||e.tag===31){var s=Bs(e,67108864);s!==null&&ze(s,e,67108864),yu(e,67108864)}}function fm(e){if(e.tag===13||e.tag===31){var s=We();s=ho(s);var a=Bs(e,s);a!==null&&ze(a,e,s),yu(e,s)}}var Tl=!0;function uv(e,s,a,o){var d=B.T;B.T=null;var m=G.p;try{G.p=2,bu(e,s,a,o)}finally{G.p=m,B.T=d}}function hv(e,s,a,o){var d=B.T;B.T=null;var m=G.p;try{G.p=8,bu(e,s,a,o)}finally{G.p=m,B.T=d}}function bu(e,s,a,o){if(Tl){var d=vu(o);if(d===null)nu(e,s,o,Ml,a),mm(e,o);else if(fv(d,e,s,a,o))o.stopPropagation();else if(mm(e,o),s&4&&-1<dv.indexOf(e)){for(;d!==null;){var m=an(d);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=Ns(m.pendingLanes);if(v!==0){var E=m;for(E.pendingLanes|=2,E.entangledLanes|=2;v;){var D=1<<31-qe(v);E.entanglements[1]|=D,v&=~D}wi(m),(Lt&6)===0&&(ul=He()+500,za(0))}}break;case 31:case 13:E=Bs(m,2),E!==null&&ze(E,m,2),dl(),yu(m,2)}if(m=vu(o),m===null&&nu(e,s,o,Ml,a),m===d)break;d=m}d!==null&&o.stopPropagation()}else nu(e,s,o,null,a)}}function vu(e){return e=So(e),Au(e)}var Ml=null;function Au(e){if(Ml=null,e=nn(e),e!==null){var s=l(e);if(s===null)e=null;else{var a=s.tag;if(a===13){if(e=c(s),e!==null)return e;e=null}else if(a===31){if(e=u(s),e!==null)return e;e=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null)}}return Ml=e,null}function pm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wg()){case Sh:return 2;case wh:return 8;case yr:case Zg:return 32;case _h:return 268435456;default:return 32}default:return 32}}var Su=!1,vs=null,As=null,Ss=null,qa=new Map,Va=new Map,ws=[],dv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mm(e,s){switch(e){case"focusin":case"focusout":vs=null;break;case"dragenter":case"dragleave":As=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":qa.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Va.delete(s.pointerId)}}function Xa(e,s,a,o,d,m){return e===null||e.nativeEvent!==m?(e={blockedOn:s,domEventName:a,eventSystemFlags:o,nativeEvent:m,targetContainers:[d]},s!==null&&(s=an(s),s!==null&&dm(s)),e):(e.eventSystemFlags|=o,s=e.targetContainers,d!==null&&s.indexOf(d)===-1&&s.push(d),e)}function fv(e,s,a,o,d){switch(s){case"focusin":return vs=Xa(vs,e,s,a,o,d),!0;case"dragenter":return As=Xa(As,e,s,a,o,d),!0;case"mouseover":return Ss=Xa(Ss,e,s,a,o,d),!0;case"pointerover":var m=d.pointerId;return qa.set(m,Xa(qa.get(m)||null,e,s,a,o,d)),!0;case"gotpointercapture":return m=d.pointerId,Va.set(m,Xa(Va.get(m)||null,e,s,a,o,d)),!0}return!1}function gm(e){var s=nn(e.target);if(s!==null){var a=l(s);if(a!==null){if(s=a.tag,s===13){if(s=c(a),s!==null){e.blockedOn=s,Dh(e.priority,function(){fm(a)});return}}else if(s===31){if(s=u(a),s!==null){e.blockedOn=s,Dh(e.priority,function(){fm(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dl(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var a=vu(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);Ao=o,a.target.dispatchEvent(o),Ao=null}else return s=an(a),s!==null&&dm(s),e.blockedOn=a,!1;s.shift()}return!0}function ym(e,s,a){Dl(e)&&a.delete(s)}function pv(){Su=!1,vs!==null&&Dl(vs)&&(vs=null),As!==null&&Dl(As)&&(As=null),Ss!==null&&Dl(Ss)&&(Ss=null),qa.forEach(ym),Va.forEach(ym)}function Nl(e,s){e.blockedOn===s&&(e.blockedOn=null,Su||(Su=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,pv)))}var Rl=null;function bm(e){Rl!==e&&(Rl=e,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){Rl===e&&(Rl=null);for(var s=0;s<e.length;s+=3){var a=e[s],o=e[s+1],d=e[s+2];if(typeof o!="function"){if(Au(o||a)===null)continue;break}var m=an(a);m!==null&&(e.splice(s,3),s-=3,vc(m,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function Un(e){function s(D){return Nl(D,e)}vs!==null&&Nl(vs,e),As!==null&&Nl(As,e),Ss!==null&&Nl(Ss,e),qa.forEach(s),Va.forEach(s);for(var a=0;a<ws.length;a++){var o=ws[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<ws.length&&(a=ws[0],a.blockedOn===null);)gm(a),a.blockedOn===null&&ws.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],m=a[o+1],v=d[Re]||null;if(typeof m=="function")v||bm(a);else if(v){var E=null;if(m&&m.hasAttribute("formAction")){if(d=m,v=m[Re]||null)E=v.formAction;else if(Au(d)!==null)continue}else E=v.action;typeof E=="function"?a[o+1]=E:(a.splice(o,3),o-=3),bm(a)}}}function vm(){function e(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function s(){d!==null&&(d(),d=null),o||setTimeout(a,20)}function a(){if(!o&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(a,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),d!==null&&(d(),d=null)}}}function wu(e){this._internalRoot=e}Ol.prototype.render=wu.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(n(409));var a=s.current,o=We();um(a,o,e,s,null,null)},Ol.prototype.unmount=wu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;um(e.current,2,null,e,null,null),dl(),s[sn]=null}};function Ol(e){this._internalRoot=e}Ol.prototype.unstable_scheduleHydration=function(e){if(e){var s=Mh();e={blockedOn:null,target:e,priority:s};for(var a=0;a<ws.length&&s!==0&&s<ws[a].priority;a++);ws.splice(a,0,e),a===0&&gm(e)}};var Am=t.version;if(Am!=="19.2.3")throw Error(n(527,Am,"19.2.3"));G.findDOMNode=function(e){var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=f(s),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var mv={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{ea=kl.inject(mv),Ge=kl}catch{}}return Ka.createRoot=function(e,s){if(!r(e))throw Error(n(299));var a=!1,o="",d=Tf,m=Mf,v=Df;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onUncaughtError!==void 0&&(d=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),s=om(e,1,!1,null,null,a,o,null,d,m,v,vm),e[sn]=s.current,su(e),new wu(s)},Ka.hydrateRoot=function(e,s,a){if(!r(e))throw Error(n(299));var o=!1,d="",m=Tf,v=Mf,E=Df,D=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError),a.formState!==void 0&&(D=a.formState)),s=om(e,1,!0,s,a??null,o,d,D,m,v,E,vm),s.context=cm(null),a=s.current,o=We(),o=ho(o),d=ls(o),d.callback=null,os(a,d,o),a=o,s.current.lanes=a,sa(s,a),wi(s),e[sn]=s.current,su(e),new Ol(s)},Ka.version="19.2.3",Ka}var Om;function Ev(){if(Om)return Cu.exports;Om=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Cu.exports=xv(),Cu.exports}var Cv=Ev();function ue({children:p,variant:t="primary",size:i="md",disabled:n=!1,onClick:r,type:l="button",className:c="",...u}){const h=["btn",`btn-${t}`,`btn-${i}`,n?"btn-disabled":"",c].filter(Boolean).join(" ");return S.jsx("button",{type:l,className:h,disabled:n,onClick:r,...u,children:p})}function fi({children:p,variant:t="elevated",padding:i="md",className:n="",onClick:r,...l}){const c=["card",`card-${t}`,`card-p-${i}`,r?"card-clickable":"",n].filter(Boolean).join(" ");return S.jsx("div",{className:c,onClick:r,...l,children:p})}function Nu({children:p,size:t="default",className:i="",...n}){const r=["container",`container-${t}`,i].filter(Boolean).join(" ");return S.jsx("div",{className:r,...n,children:p})}function Ie({label:p,value:t,onChange:i,type:n="text",placeholder:r="",error:l="",disabled:c=!1,className:u="",...h}){const f=g=>{i&&i(g.target.value)};return S.jsxs("div",{className:`input-wrapper ${u}`,children:[p&&S.jsx("label",{className:"input-label",children:p}),S.jsx("input",{type:n,value:t,onChange:f,placeholder:r,disabled:c,className:`input ${l?"input-error":""}`,...h}),l&&S.jsx("span",{className:"input-error-text",children:l})]})}function Yl({label:p,value:t,onChange:i,placeholder:n="",rows:r=5,error:l="",disabled:c=!1,className:u="",...h}){const f=g=>{i&&i(g.target.value)};return S.jsxs("div",{className:`textarea-wrapper ${u}`,children:[p&&S.jsx("label",{className:"textarea-label",children:p}),S.jsx("textarea",{value:t,onChange:f,placeholder:n,rows:r,disabled:c,className:`textarea ${l?"textarea-error":""}`,...h}),l&&S.jsx("span",{className:"textarea-error-text",children:l})]})}function tr({isOpen:p,onClose:t,title:i,children:n,size:r="md",showClose:l=!0}){if(et.useEffect(()=>(p?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[p]),et.useEffect(()=>{const u=h=>{h.key==="Escape"&&p&&t()};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[p,t]),!p)return null;const c=u=>{u.target===u.currentTarget&&t()};return S.jsx("div",{className:"modal-backdrop",onClick:c,children:S.jsxs("div",{className:`modal modal-${r}`,role:"dialog","aria-modal":"true",children:[(i||l)&&S.jsxs("div",{className:"modal-header",children:[i&&S.jsx("h2",{className:"modal-title",children:i}),l&&S.jsx("button",{type:"button",className:"modal-close",onClick:t,"aria-label":"Close",children:""})]}),S.jsx("div",{className:"modal-content",children:n})]})})}tr.Footer=function({children:t,className:i=""}){return S.jsx("div",{className:`modal-footer ${i}`,children:t})};function Tv({children:p,currentView:t,onNavigate:i,onOpenSettings:n,resumeExists:r,applicationCount:l,viewMode:c="list",onViewModeChange:u}){const[h,f]=et.useState(!1),[g,y]=et.useState(!1),b=[{id:"jobs",label:"Jobs",icon:"jobs",badge:l},{id:"profile",label:"Profile",icon:"profile",status:r?"done":"pending"},{id:"settings",label:"Settings",icon:"settings",isSettings:!0}],A=w=>{i(w),y(!1)},x=w=>{w.isSettings?n():A(w.id)};return S.jsxs("div",{className:`app-layout ${h?"sidebar-collapsed":""}`,children:[S.jsx("div",{className:`sidebar-overlay ${g?"visible":""}`,onClick:()=>y(!1)}),S.jsxs("aside",{className:`sidebar ${g?"open":""} ${h?"collapsed":""}`,children:[S.jsxs("div",{className:"sidebar-header",children:[S.jsx("a",{href:"#",className:"sidebar-logo",onClick:()=>A("jobs"),children:h?"G":"GapTrack"}),S.jsx("button",{className:"collapse-btn",onClick:()=>f(!h),"aria-label":h?"Expand sidebar":"Collapse sidebar",children:S.jsx("span",{className:`collapse-icon ${h?"collapsed":""}`})})]}),S.jsx("nav",{className:"sidebar-nav",children:S.jsx("div",{className:"nav-section",children:b.map(w=>S.jsxs("button",{className:`nav-item ${t===w.id?"active":""}`,onClick:()=>x(w),title:h?w.label:void 0,children:[S.jsx("span",{className:`nav-icon nav-icon-${w.icon}`}),!h&&S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"nav-item-label",children:w.label}),w.badge>0&&S.jsx("span",{className:"nav-badge",children:w.badge}),w.status==="pending"&&S.jsx("span",{className:"nav-status-dot"})]})]},w.id))})})]}),S.jsxs("div",{className:"main-wrapper",children:[S.jsxs("header",{className:"navbar",children:[S.jsx("button",{className:"navbar-btn menu-toggle-mobile",onClick:()=>y(!g),"aria-label":"Toggle menu",children:S.jsx("span",{className:"menu-icon"})}),t==="jobs"&&u&&S.jsxs("div",{className:"view-toggle",children:[S.jsxs("button",{className:`view-toggle-btn ${c==="list"?"active":""}`,onClick:()=>u("list"),title:"List view",children:[S.jsx("span",{className:"view-icon view-icon-list"}),S.jsx("span",{className:"view-label",children:"List"})]}),S.jsxs("button",{className:`view-toggle-btn ${c==="kanban"?"active":""}`,onClick:()=>u("kanban"),title:"Kanban view",children:[S.jsx("span",{className:"view-icon view-icon-kanban"}),S.jsx("span",{className:"view-label",children:"Kanban"})]})]}),S.jsx("div",{className:"navbar-spacer"})]}),S.jsx("main",{className:"main-content",children:p})]}),S.jsx("footer",{className:"footer",children:S.jsxs("p",{className:"footer-text",children:["Built with privacy in mind."," ",S.jsx("a",{href:"https://github.com/chaiovercode/gaptrack",className:"footer-link",target:"_blank",rel:"noopener noreferrer",children:"View on GitHub"})]})})]})}const km=()=>"showSaveFilePicker"in window,Mv=async()=>{try{return{success:!0,handle:await window.showSaveFilePicker({suggestedName:"gaptrack-data.json",types:[{description:"GapTrack Data",accept:{"application/json":[".json"]}}]})}}catch(p){return p.name==="AbortError"?{success:!1,cancelled:!0}:{success:!1,error:p.message}}},Dv=async()=>{try{const[p]=await window.showOpenFilePicker({types:[{description:"GapTrack Data",accept:{"application/json":[".json"]}}]});return{success:!0,handle:p}}catch(p){return p.name==="AbortError"?{success:!1,cancelled:!0}:{success:!1,error:p.message}}},Lm=async(p,t)=>{try{const i=await p.createWritable(),n=JSON.stringify(t,null,2);return await i.write(n),await i.close(),{success:!0}}catch(i){return{success:!1,error:i.message}}},Nv=async p=>{try{const i=await(await p.getFile()).text();return i.trim()?{success:!0,data:JSON.parse(i)}:{success:!0,data:null}}catch(t){return{success:!1,error:t.message}}},Ll=()=>({version:1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),settings:{aiProvider:null,geminiApiKey:null,ollamaModel:"mistral"},resume:{fileName:null,content:null,parsedData:null,uploadedAt:null},applications:[]}),Bm="gaptrack-data",Ru="gaptrack-has-file";function Rv(){const[p,t]=et.useState(null),[i,n]=et.useState(null),[r,l]=et.useState(!0),[c,u]=et.useState(null),[h,f]=et.useState(null);et.useEffect(()=>{g()},[]);const g=async()=>{if(l(!0),u(null),km()){if(f("fileSystem"),!localStorage.getItem(Ru)){l(!1);return}}else f("localStorage"),M();l(!1)},y=et.useCallback(async()=>{l(!0),u(null);const T=await Mv();if(T.cancelled)return l(!1),{success:!1,cancelled:!0};if(!T.success)return u(T.error),l(!1),{success:!1,error:T.error};n(T.handle);const R=Ll(),O=await Lm(T.handle,R);return O.success?(localStorage.setItem(Ru,"true"),t(R),l(!1),{success:!0}):(u(O.error),l(!1),{success:!1,error:O.error})},[]),b=et.useCallback(async()=>{l(!0),u(null);const T=await Dv();if(T.cancelled)return l(!1),{success:!1,cancelled:!0};if(!T.success)return u(T.error),l(!1),{success:!1,error:T.error};const R=await Nv(T.handle);return R.success?(n(T.handle),t(R.data||Ll()),localStorage.setItem(Ru,"true"),l(!1),{success:!0}):(u(R.error),l(!1),{success:!1,error:R.error})},[]),A=et.useCallback(async T=>{const R={...T,updatedAt:new Date().toISOString()};if(h==="fileSystem"&&i){const O=await Lm(i,R);if(!O.success)return u(O.error),{success:!1,error:O.error}}else localStorage.setItem(Bm,JSON.stringify(R));return t(R),{success:!0}},[h,i]),x=et.useCallback(async(T,R)=>{const O={...p,[T]:typeof R=="object"?{...p[T],...R}:R};return A(O)},[p,A]),w=et.useCallback(async T=>{const R={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},O={...p,applications:[...p?.applications||[],R]};return A(O)},[p,A]),C=et.useCallback(async(T,R)=>{const O={...p,applications:p.applications.map(N=>N.id===T?{...N,...R,updatedAt:new Date().toISOString()}:N)};return A(O)},[p,A]),_=et.useCallback(async T=>{const R={...p,applications:p.applications.filter(O=>O.id!==T)};return A(R)},[p,A]),M=()=>{const T=localStorage.getItem(Bm);if(T)try{t(JSON.parse(T))}catch{t(Ll())}else t(Ll())};return{data:p,isLoading:r,error:c,storageType:h,needsSetup:h==="fileSystem"&&!i&&!p,setupFileStorage:y,openExistingFile:b,save:A,updateAndSave:x,addApplication:w,updateApplication:C,deleteApplication:_,isFileSystemSupported:km()}}const Ov="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";async function ug(p,t){try{console.log("Calling Gemini API...");const i=await fetch(`${Ov}?key=${p}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:t}]}],generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:8192}})});if(!i.ok){const c=(await i.json().catch(()=>({}))).error?.message||`API error: ${i.status}`;return i.status===400?{success:!1,error:"Invalid API key. Get one from aistudio.google.com"}:i.status===403?{success:!1,error:"API key not authorized. Check your key at aistudio.google.com"}:i.status===429?{success:!1,error:"Rate limit exceeded. Wait a moment and try again."}:{success:!1,error:c}}const n=await i.json();console.log("Gemini response:",n);const r=n.candidates?.[0]?.content?.parts?.[0]?.text;return r?(console.log("Gemini returned text, length:",r.length),{success:!0,text:r}):(console.error("No text in Gemini response:",n),{success:!1,error:"No response from Gemini"})}catch(i){return console.error("Gemini error:",i),{success:!1,error:i.message}}}async function kv(p){return!p||p.trim().length<10?{success:!1,error:"Invalid API key format"}:await ug(p.trim(),'Respond with only the word "OK"')}const Lv="https://api.openai.com/v1/chat/completions";async function hg(p,t,i="gpt-4o-mini"){try{const n=await fetch(Lv,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({model:i,messages:[{role:"user",content:t}],temperature:.7,max_tokens:4096})});if(!n.ok){const u=(await n.json().catch(()=>({}))).error?.message||`API error: ${n.status}`;return n.status===401?{success:!1,error:"Invalid API key. Get one from platform.openai.com"}:n.status===429?{success:!1,error:"Rate limit or quota exceeded. Check your OpenAI billing."}:n.status===503?{success:!1,error:"OpenAI service temporarily unavailable. Try again."}:{success:!1,error:u}}const l=(await n.json()).choices?.[0]?.message?.content;return l?{success:!0,text:l}:{success:!1,error:"No response from OpenAI"}}catch(n){return{success:!1,error:n.message}}}async function Bv(p){return!p||p.trim().length<20?{success:!1,error:"Invalid API key format"}:await hg(p.trim(),'Respond with only the word "OK"')}const jv="http://localhost:11434/api/generate";async function dg(p,t){try{const i=await fetch(jv,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:p,prompt:t,stream:!1,options:{temperature:.7,num_predict:4096}})});if(!i.ok)return i.status===0||!i.status?{success:!1,error:"Cannot connect to Ollama. Make sure it's running: ollama serve"}:{success:!1,error:`Ollama error: ${i.status}`};const n=await i.json();return n.response?{success:!0,text:n.response}:{success:!1,error:"No response from Ollama"}}catch(i){return i.message.includes("Failed to fetch")||i.message.includes("NetworkError")?{success:!1,error:"Cannot connect to Ollama. Make sure it's running: ollama serve"}:{success:!1,error:i.message}}}async function nh(p="mistral"){try{const t=await fetch("http://localhost:11434/api/tags");if(!t.ok)return{running:!1,hasModel:!1,error:"Ollama not running"};const n=(await t.json()).models||[],r=n.some(l=>l.name.startsWith(p));return{running:!0,hasModel:r,availableModels:n.map(l=>l.name),error:r?null:`Model "${p}" not installed. Run: ollama pull ${p}`}}catch{return{running:!1,hasModel:!1,error:"Cannot connect to Ollama. Make sure it's running: ollama serve"}}}async function zv(p="mistral"){const t=await nh(p);return!t.running||!t.hasModel?{success:!1,...t}:{...await dg(p,'Say "OK" if you can read this.'),...t}}function Pv(p){return`You are a resume parser. Extract structured information from this resume.

RESUME:
${p}

Return ONLY valid JSON (no markdown, no explanation) in this exact format:
{
  "name": "Full Name",
  "email": "email@example.com",
  "phone": "phone number or null",
  "location": "city, country or null",
  "summary": "brief professional summary",
  "skills": {
    "technical": ["skill1", "skill2"],
    "tools": ["tool1", "tool2"],
    "soft": ["skill1", "skill2"]
  },
  "experience": [
    {
      "title": "Job Title",
      "company": "Company Name",
      "duration": "e.g., Nov 2022 - Present",
      "highlights": ["achievement 1", "achievement 2"]
    }
  ],
  "education": [
    {
      "degree": "Degree Name",
      "institution": "School Name",
      "year": "graduation year"
    }
  ],
  "certifications": ["cert1", "cert2"]
}

Rules:
- Extract only what's in the resume, don't make up information
- If something is not mentioned, use null or empty array
- Keep highlights concise (max 15 words each)
- Return ONLY the JSON, nothing else`}function Fv(p){return`You are a job description analyzer. Extract structured requirements from this job posting.

JOB DESCRIPTION:
${p}

Return ONLY valid JSON (no markdown, no explanation) in this exact format:
{
  "company": "Company name or null",
  "role": "Job title",
  "location": "Location or Remote",
  "salary": "Salary range if mentioned, else null",
  "requirements": {
    "mustHave": ["required skill 1", "required skill 2"],
    "niceToHave": ["preferred skill 1", "preferred skill 2"],
    "experience": "e.g., 3-5 years",
    "education": "e.g., Bachelor's in CS or null"
  },
  "responsibilities": ["main duty 1", "main duty 2"],
  "redFlags": ["any concerning items like unrealistic expectations"],
  "keywords": ["important keywords for ATS"]
}

Rules:
- Distinguish between MUST HAVE (required) and NICE TO HAVE (preferred)
- Red flags include: unrealistic requirements, vague descriptions, too many requirements
- Keywords should include technical terms that an ATS would scan for
- Return ONLY the JSON, nothing else`}function Uv(p,t){return`You are a career coach analyzing a resume against a job description.

CANDIDATE'S RESUME:
${JSON.stringify(p,null,2)}

JOB REQUIREMENTS:
${JSON.stringify(t,null,2)}

Analyze the fit and return ONLY valid JSON (no markdown, no explanation):
{
  "matchScore": 75,
  "summary": "One sentence overall assessment",
  "strengths": [
    {
      "skill": "skill name",
      "evidence": "where it appears in resume",
      "relevance": "how it matches the job"
    }
  ],
  "gaps": [
    {
      "requirement": "what the job needs",
      "status": "missing | weak | hidden",
      "suggestion": "specific action to address this"
    }
  ],
  "resumeTips": [
    "Specific suggestion to improve resume for this job"
  ],
  "interviewTips": [
    "What to prepare for based on this job"
  ],
  "keywords": {
    "present": ["keywords from JD that ARE in resume"],
    "missing": ["keywords from JD that are NOT in resume"]
  }
}

Rules:
- matchScore: 0-100 based on how well requirements are met
- status meanings:
  - "missing": skill not in resume at all
  - "weak": skill mentioned but not emphasized
  - "hidden": skill exists but buried/not obvious
- Be specific and actionable in suggestions
- Return ONLY the JSON, nothing else`}function Iv(p,t){return`Write a professional summary (2-3 sentences) tailored for this job.

CANDIDATE:
${JSON.stringify(p,null,2)}

TARGET JOB:
${JSON.stringify(t,null,2)}

Rules:
- Highlight relevant experience for THIS specific job
- Include key matching skills
- Keep it under 50 words
- Professional tone, no buzzwords
- Return ONLY the summary text, no JSON, no explanation`}function Hv(p){const{aiProvider:t,geminiApiKey:i,openaiApiKey:n,ollamaModel:r="llava"}=p;async function l(u){return t==="gemini"?i?ug(i,u):{success:!1,error:"Gemini API key not configured"}:t==="openai"?n?hg(n,u):{success:!1,error:"OpenAI API key not configured"}:t==="ollama"?dg(r,u):{success:!1,error:"No AI provider configured"}}function c(u){try{let h=u.trim();return h.startsWith("```json")?h=h.slice(7):h.startsWith("```")&&(h=h.slice(3)),h.endsWith("```")&&(h=h.slice(0,-3)),JSON.parse(h.trim())}catch{return null}}return{async parseResume(u){const h=Pv(u),f=await l(h);if(!f.success)return f;const g=c(f.text);return g?{success:!0,data:g}:{success:!1,error:"Failed to parse AI response as JSON"}},async parseJobDescription(u){const h=Fv(u),f=await l(h);if(!f.success)return f;const g=c(f.text);return g?{success:!0,data:g}:{success:!1,error:"Failed to parse AI response as JSON"}},async analyzeGap(u,h){const f=Uv(u,h),g=await l(f);if(!g.success)return g;const y=c(g.text);return y?{success:!0,data:y}:{success:!1,error:"Failed to parse AI response as JSON"}},async generateTailoredSummary(u,h){const f=Iv(u,h),g=await l(f);return g.success?{success:!0,text:g.text.trim()}:g},async rawCall(u){return l(u)}}}async function Gv(p){const{aiProvider:t,geminiApiKey:i,openaiApiKey:n,ollamaModel:r="llava"}=p;return t==="gemini"?i?kv(i):{success:!1,error:"No API key provided"}:t==="openai"?n?Bv(n):{success:!1,error:"No API key provided"}:t==="ollama"?zv(r):{success:!1,error:"No AI provider selected"}}function fg(p){const[t,i]=et.useState(!1),[n,r]=et.useState(null),l=et.useMemo(()=>p?.aiProvider?Hv(p):null,[p?.aiProvider,p?.geminiApiKey,p?.openaiApiKey,p?.ollamaModel]),c=et.useCallback(A=>async(...x)=>{if(!l)return{success:!1,error:"AI not configured"};i(!0),r(null);try{const w=await A(...x);return w.success||r(w.error),w}catch(w){const C=w.message||"AI processing failed";return r(C),{success:!1,error:C}}finally{i(!1)}},[l]),u=et.useCallback(c(async A=>l.parseResume(A)),[l,c]),h=et.useCallback(c(async A=>l.parseJobDescription(A)),[l,c]),f=et.useCallback(c(async(A,x)=>l.analyzeGap(A,x)),[l,c]),g=et.useCallback(c(async(A,x)=>l.generateTailoredSummary(A,x)),[l,c]),y=et.useCallback(async()=>{if(!p?.aiProvider)return{success:!1,error:"No AI provider selected"};i(!0),r(null);try{const A=await Gv(p);return A.success||r(A.error),A}finally{i(!1)}},[p]),b=et.useCallback(async A=>nh(A||p?.ollamaModel||"llava"),[p?.ollamaModel]);return{isConfigured:!!l,isProcessing:t,error:n,clearError:()=>r(null),parseResume:u,parseJobDescription:h,analyzeGap:f,generateTailoredSummary:g,testConnection:y,checkOllama:b}}function jm({settings:p,onSave:t}){const[i,n]=et.useState(p?.aiProvider||null),[r,l]=et.useState(p?.geminiApiKey||""),[c,u]=et.useState(p?.openaiApiKey||""),[h,f]=et.useState(p?.ollamaModel||""),[g,y]=et.useState(""),[b,A]=et.useState(null),[x,w]=et.useState(""),[C,_]=et.useState(null),[M,T]=et.useState(!1);et.useEffect(()=>{i==="ollama"&&R()},[i]);const R=async()=>{T(!0);const it=await nh();_(it),it.running&&it.availableModels?.length>0&&!h&&f(it.availableModels[0]),T(!1)},{testConnection:O}=fg({aiProvider:i,geminiApiKey:r,openaiApiKey:c,ollamaModel:h||g}),N=async()=>{A("testing"),w("");const it=await O();it.success?(A("success"),w("Connection successful!")):(A("error"),w(it.error||"Connection failed"))},j=()=>{t({aiProvider:i,geminiApiKey:i==="gemini"?r:null,openaiApiKey:i==="openai"?c:null,ollamaModel:i==="ollama"?h||g:"llava"})},V=it=>{f(it),y("")},$=it=>{y(it),f("")},J=h||g,tt=i&&(i==="gemini"&&r||i==="openai"&&c||i==="ollama"&&C?.running&&J);return S.jsxs("div",{className:"ai-settings",children:[S.jsx("h3",{className:"text-xl font-bold mb-4",children:"Choose AI Provider"}),S.jsxs("div",{className:"provider-options",children:[S.jsx(fi,{padding:"md",className:`provider-card ${i==="gemini"?"selected":""}`,onClick:()=>n("gemini"),children:S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold",children:"Gemini (Google)"}),S.jsx("p",{className:"text-sm text-light mt-1",children:"Fast, cloud-based. Free tier: 15 req/min"})]}),S.jsx("span",{className:"provider-badge",children:"Cloud"})]})}),S.jsx(fi,{padding:"md",className:`provider-card ${i==="openai"?"selected":""}`,onClick:()=>n("openai"),children:S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold",children:"OpenAI"}),S.jsx("p",{className:"text-sm text-light mt-1",children:"GPT-4o vision. Pay-as-you-go pricing."})]}),S.jsx("span",{className:"provider-badge",children:"Cloud"})]})}),S.jsx(fi,{padding:"md",className:`provider-card ${i==="ollama"?"selected":""}`,onClick:()=>n("ollama"),children:S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold",children:"Ollama (Local)"}),S.jsx("p",{className:"text-sm text-light mt-1",children:"100% private. Vision models for PDF parsing."})]}),S.jsx("span",{className:"provider-badge local",children:"Local"})]})})]}),i==="gemini"&&S.jsxs(fi,{padding:"md",className:"mt-4",children:[S.jsx("h4",{className:"font-bold mb-4",children:"Gemini Setup"}),S.jsx(Ie,{label:"API Key",type:"password",value:r,onChange:l,placeholder:"Paste your Gemini API key"}),S.jsxs("p",{className:"text-sm text-light mt-2",children:["Get a free key at"," ",S.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:"aistudio.google.com"})]})]}),i==="openai"&&S.jsxs(fi,{padding:"md",className:"mt-4",children:[S.jsx("h4",{className:"font-bold mb-4",children:"OpenAI Setup"}),S.jsx(Ie,{label:"API Key",type:"password",value:c,onChange:u,placeholder:"Paste your OpenAI API key (sk-...)"}),S.jsxs("p",{className:"text-sm text-light mt-2",children:["Get a key at"," ",S.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:"platform.openai.com"})," ","(pay-as-you-go)"]})]}),i==="ollama"&&S.jsxs(fi,{padding:"md",className:"mt-4",children:[S.jsx("h4",{className:"font-bold mb-4",children:"Ollama Setup"}),M&&S.jsx("div",{className:"ollama-status",children:S.jsx("span",{children:"Checking Ollama status..."})}),!M&&C&&S.jsx("div",{className:`ollama-status ${C.running?"running":"not-running"}`,children:C.running?S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"status-dot"}),S.jsx("span",{children:"Ollama is running"}),S.jsx(ue,{variant:"outline",size:"sm",onClick:R,className:"ml-auto",children:"Refresh"})]}):S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"status-dot offline"}),S.jsx("span",{children:"Ollama not detected"}),S.jsx(ue,{variant:"outline",size:"sm",onClick:R,className:"ml-auto",children:"Retry"})]})}),C?.running&&S.jsxs("div",{className:"mt-4",children:[S.jsx("label",{className:"text-sm font-bold",children:"Select Model"}),C.availableModels?.length>0?S.jsxs(S.Fragment,{children:[S.jsxs("p",{className:"text-sm text-light mt-1 mb-2",children:[C.availableModels.length," model(s) installed:"]}),S.jsx("div",{className:"flex gap-2 flex-wrap",children:C.availableModels.map(it=>S.jsx("button",{className:`model-btn ${h===it?"selected":""}`,onClick:()=>V(it),children:it},it))})]}):S.jsxs("div",{className:"no-models-warning mt-2",children:[S.jsx("p",{className:"font-bold",children:"No models installed!"}),S.jsx("p",{className:"text-sm mt-1",children:"You need to pull a model first. Run one of these commands:"})]}),S.jsxs("div",{className:"mt-4",children:[S.jsx(Ie,{label:"Or enter vision model name manually",value:g,onChange:$,placeholder:"e.g., llava, moondream, qwen2.5-vl"}),S.jsx("p",{className:"text-sm text-light mt-1",children:"Use vision-capable models for PDF parsing"})]}),J&&S.jsxs("div",{className:"selected-model mt-4",children:[S.jsx("span",{className:"text-sm",children:"Selected:"}),S.jsx("span",{className:"font-bold ml-2",children:J})]})]}),!M&&!C?.running&&S.jsxs("div",{className:"setup-instructions mt-4",children:[S.jsx("p",{className:"font-bold mb-2",children:"Setup Instructions:"}),S.jsxs("ol",{className:"text-sm",children:[S.jsxs("li",{children:[S.jsx("span",{className:"step-label",children:"Install Ollama:"}),S.jsx("code",{children:"curl -fsSL https://ollama.com/install.sh | sh"})]}),S.jsxs("li",{children:[S.jsx("span",{className:"step-label",children:"Pull a model:"}),S.jsx("code",{children:"ollama pull mistral"})]}),S.jsxs("li",{children:[S.jsx("span",{className:"step-label",children:"Start Ollama:"}),S.jsx("code",{children:"ollama serve"})]})]})]}),C?.running&&C.availableModels?.length===0&&S.jsxs("div",{className:"setup-instructions mt-4",children:[S.jsx("p",{className:"font-bold mb-2",children:"Recommended Vision Models (for PDF parsing):"}),S.jsxs("div",{className:"model-suggestions",children:[S.jsxs("div",{className:"suggestion",children:[S.jsx("code",{children:"ollama pull llava"}),S.jsx("span",{className:"text-sm text-light",children:"Best for images/PDFs (4.7GB)"})]}),S.jsxs("div",{className:"suggestion",children:[S.jsx("code",{children:"ollama pull llama3.2-vision:11b"}),S.jsx("span",{className:"text-sm text-light",children:"Meta's vision model (7.9GB)"})]}),S.jsxs("div",{className:"suggestion",children:[S.jsx("code",{children:"ollama pull moondream"}),S.jsx("span",{className:"text-sm text-light",children:"Lightweight vision (1.7GB)"})]}),S.jsxs("div",{className:"suggestion",children:[S.jsx("code",{children:"ollama pull qwen2.5-vl"}),S.jsx("span",{className:"text-sm text-light",children:"Alibaba vision model (4.4GB)"})]})]})]})]}),i&&S.jsxs("div",{className:"mt-4 flex gap-4 items-center flex-wrap",children:[S.jsx(ue,{variant:"secondary",onClick:N,disabled:b==="testing"||i==="ollama"&&!J,children:b==="testing"?"Testing...":"Test Connection"}),b==="success"&&S.jsx("span",{className:"text-success font-bold",children:x}),b==="error"&&S.jsx("span",{className:"text-error",children:x})]}),S.jsx("div",{className:"mt-6",children:S.jsx(ue,{variant:"primary",size:"lg",onClick:j,disabled:!tt,className:"w-full",children:"Save & Continue"})})]})}const Me=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Gu=[.001,0,0,.001,0,0],Ou=1.35,Ze={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},xs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ar="pdfjs_internal_editor_",bt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Mt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},qv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qu={TRIANGLES:1,LATTICE:2},Se={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ql={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ce={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Hn={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zl={ERRORS:0,WARNINGS:1,INFOS:5},rr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},$a={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},Vv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Jl=Zl.WARNINGS;function Xv(p){Number.isInteger(p)&&(Jl=p)}function Yv(){return Jl}function to(p){Jl>=Zl.INFOS&&console.info(`Info: ${p}`)}function gt(p){Jl>=Zl.WARNINGS&&console.warn(`Warning: ${p}`)}function qt(p){throw new Error(p)}function Dt(p,t){p||qt(t)}function Kv(p){switch(p?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pg(p,t=null,i=null){if(!p)return null;if(i&&typeof p=="string"&&(i.addDefaultProtocol&&p.startsWith("www.")&&p.match(/\./g)?.length>=2&&(p=`http://${p}`),i.tryConvertEncoding))try{p=Jv(p)}catch{}const n=t?URL.parse(p,t):URL.parse(p);return Kv(n)?n:null}function mg(p,t,i=!1){const n=URL.parse(p);return n?(n.hash=t,n.href):i&&pg(p,"http://example.com")?p.split("#",1)[0]+`${t?`#${t}`:""}`:""}function yt(p,t,i,n=!1){return Object.defineProperty(p,t,{value:i,enumerable:!n,configurable:!0,writable:!1}),i}const tn=(function(){function t(i,n){this.message=i,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class zm extends tn{constructor(t,i){super(t,"PasswordException"),this.code=i}}class ku extends tn{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Vu extends tn{constructor(t){super(t,"InvalidPDFException")}}class Kl extends tn{constructor(t,i,n){super(t,"ResponseException"),this.status=i,this.missing=n}}class $v extends tn{constructor(t){super(t,"FormatError")}}class Cs extends tn{constructor(t){super(t,"AbortException")}}function gg(p){(typeof p!="object"||p?.length===void 0)&&qt("Invalid argument for bytesToString");const t=p.length,i=8192;if(t<i)return String.fromCharCode.apply(null,p);const n=[];for(let r=0;r<t;r+=i){const l=Math.min(r+i,t),c=p.subarray(r,l);n.push(String.fromCharCode.apply(null,c))}return n.join("")}function ur(p){typeof p!="string"&&qt("Invalid argument for stringToBytes");const t=p.length,i=new Uint8Array(t);for(let n=0;n<t;++n)i[n]=p.charCodeAt(n)&255;return i}function Qv(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function Wv(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function Zv(){try{return new Function(""),!0}catch{return!1}}class xe{static get isLittleEndian(){return yt(this,"isLittleEndian",Wv())}static get isEvalSupported(){return yt(this,"isEvalSupported",Zv())}static get isOffscreenCanvasSupported(){return yt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return yt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return yt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return yt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return yt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return yt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Lu=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));class rt{static makeHexColor(t,i,n){return`#${Lu[t]}${Lu[i]}${Lu[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let n;t[0]?(t[0]<0&&(n=i[0],i[0]=i[2],i[2]=n),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(n=i[1],i[1]=i[3],i[3]=n),i[1]*=t[3],i[3]*=t[3]):(n=i[0],i[0]=i[1],i[1]=n,n=i[2],i[2]=i[3],i[3]=n,t[1]<0&&(n=i[1],i[1]=i[3],i[3]=n),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(n=i[0],i[0]=i[2],i[2]=n),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,n=0){const r=t[n],l=t[n+1];t[n]=r*i[0]+l*i[2]+i[4],t[n+1]=r*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,n=0){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let g=0;g<6;g+=2){const y=t[n+g],b=t[n+g+1];t[n+g]=y*r+b*c+h,t[n+g+1]=y*l+b*u+f}}static applyInverseTransform(t,i){const n=t[0],r=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(n*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-n*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,n){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5],g=t[0],y=t[1],b=t[2],A=t[3];let x=r*g+h,w=x,C=r*b+h,_=C,M=u*y+f,T=M,R=u*A+f,O=R;if(l!==0||c!==0){const N=l*g,j=l*b,V=c*y,$=c*A;x+=V,_+=V,C+=$,w+=$,M+=N,O+=N,R+=j,T+=j}n[0]=Math.min(n[0],x,C,w,_),n[1]=Math.min(n[1],M,R,T,O),n[2]=Math.max(n[2],x,C,w,_),n[3]=Math.max(n[3],M,R,T,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const n=t[0],r=t[1],l=t[2],c=t[3],u=n**2+r**2,h=n*l+r*c,f=l**2+c**2,g=(u+f)/2,y=Math.sqrt(g**2-(u*f-h**2));i[0]=Math.sqrt(g+y||1),i[1]=Math.sqrt(g-y||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const n=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(n>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[n,l,r,c]}static pointBoundingBox(t,i,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],i),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],i)}static rectBoundingBox(t,i,n,r,l){l[0]=Math.min(l[0],t,n),l[1]=Math.min(l[1],i,r),l[2]=Math.max(l[2],t,n),l[3]=Math.max(l[3],i,r)}static#t(t,i,n,r,l,c,u,h,f,g){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,x=y*(y*(y*t+3*f*i)+3*b*n)+A*r,w=y*(y*(y*l+3*f*c)+3*b*u)+A*h;g[0]=Math.min(g[0],x),g[1]=Math.min(g[1],w),g[2]=Math.max(g[2],x),g[3]=Math.max(g[3],w)}static#e(t,i,n,r,l,c,u,h,f,g,y,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,i,n,r,l,c,u,h,-y/g,b);return}const A=g**2-4*y*f;if(A<0)return;const x=Math.sqrt(A),w=2*f;this.#t(t,i,n,r,l,c,u,h,(-g+x)/w,b),this.#t(t,i,n,r,l,c,u,h,(-g-x)/w,b)}static bezierBoundingBox(t,i,n,r,l,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,n,l,u,i,r,c,h,3*(-t+3*(n-l)+u),6*(t-2*n+l),3*(n-t),f),this.#e(t,n,l,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function Jv(p){return decodeURIComponent(escape(p))}let Bu=null,Pm=null;function t0(p){return Bu||(Bu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pm=new Map([["","t"]])),p.replaceAll(Bu,(t,i,n)=>i?i.normalize("NFKC"):Pm.get(n))}function yg(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const p=new Uint8Array(32);return crypto.getRandomValues(p),gg(p)}const Vn="pdfjs_internal_id_";function e0(p,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[n,r,...l]=i;if(!p(n)&&!Number.isInteger(n)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function De(p,t,i){return Math.min(Math.max(p,t),i)}function bg(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(gg(p))}function i0(p){return Uint8Array.fromBase64?Uint8Array.fromBase64(p):ur(atob(p))}typeof Promise.try!="function"&&(Promise.try=function(p,...t){return new Promise(i=>{i(p(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(p){return p.reduce((t,i)=>t+i,0)});class lr{static textContent(t){const i=[],n={items:i,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(lr.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const h of l.children)r(h)}return r(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class vg{static setupStorage(t,i,n,r,l){const c=r.getValue(i,{value:null});switch(n.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(c.value===n.attributes.xfaOn?t.setAttribute("checked",!0):c.value===n.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of n.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:n=null,intent:r,linkService:l}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),n&&c.dataId&&this.setupStorage(t,c.dataId,i,n)}static render(t){const i=t.annotationStorage,n=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:n});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=y}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const y=document.createTextNode(r.value);c.append(y),u&&lr.shouldBuildText(r.name)&&f.push(y)}return{textDivs:f}}const g=[[r,-1,c]];for(;g.length>0;){const[y,b,A]=g.at(-1);if(b+1===y.children.length){g.pop();continue}const x=y.children[++g.at(-1)[1]];if(x===null)continue;const{name:w}=x;if(w==="#text"){const _=document.createTextNode(x.value);f.push(_),A.append(_);continue}const C=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,w):document.createElement(w);if(A.append(C),x.attributes&&this.setAttributes({html:C,element:x,storage:i,intent:l,linkService:n}),x.children?.length>0)g.push([x,-1,C]);else if(x.value){const _=document.createTextNode(x.value);u&&lr.shouldBuildText(w)&&f.push(_),C.append(_)}}for(const y of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const $i="http://www.w3.org/2000/svg";class Jn{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function hr(p,t="text"){if(er(p,document.baseURI)){const i=await fetch(p);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,n)=>{const r=new XMLHttpRequest;r.open("GET",p,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class dr{constructor({viewBox:t,userUnit:i,scale:n,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=n,this.rotation=r,this.offsetX=l,this.offsetY=c,n*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,y,b,A;switch(r%=360,r<0&&(r+=360),r){case 180:g=-1,y=0,b=0,A=1;break;case 90:g=0,y=1,b=1,A=0;break;case 270:g=0,y=-1,b=-1,A=0;break;case 0:g=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let x,w,C,_;g===0?(x=Math.abs(f-t[1])*n+l,w=Math.abs(h-t[0])*n+c,C=(t[3]-t[1])*n,_=(t[2]-t[0])*n):(x=Math.abs(h-t[0])*n+l,w=Math.abs(f-t[1])*n+c,C=(t[2]-t[0])*n,_=(t[3]-t[1])*n),this.transform=[g*n,y*n,b*n,A*n,x-g*n*h-b*n*f,w-y*n*h-A*n*f],this.width=C,this.height=_}get rawDims(){const t=this.viewBox;return yt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new dr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:n,offsetY:r,dontFlip:l})}convertToViewportPoint(t,i){const n=[t,i];return rt.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const i=[t[0],t[1]];rt.applyTransform(i,this.transform);const n=[t[2],t[3]];return rt.applyTransform(n,this.transform),[i[0],i[1],n[0],n[1]]}convertToPdfPoint(t,i){const n=[t,i];return rt.applyInverseTransform(n,this.transform),n}}class ah extends tn{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function eo(p){const t=p.length;let i=0;for(;i<t&&p[i].trim()==="";)i++;return p.substring(i,i+5).toLowerCase()==="data:"}function rh(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function s0(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function n0(p,t="document.pdf"){if(typeof p!="string")return t;if(eo(p))return gt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(p);if(!n)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=n.pathname.split("/").at(-1);if(l.test(c))return r(c);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(l.test(f))return r(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return r(h[0])}return t}class Fm{started=Object.create(null);times=[];time(t){t in this.started&&gt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||gt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:n}of this.times)i=Math.max(n.length,i);for(const{name:n,start:r,end:l}of this.times)t.push(`${n.padEnd(i)} ${l-r}ms
`);return t.join("")}}function er(p,t){const i=t?URL.parse(p,t):URL.parse(p);return i?.protocol==="http:"||i?.protocol==="https:"}function pi(p){p.preventDefault()}function te(p){p.preventDefault(),p.stopPropagation()}function a0(p){console.log("Deprecated API usage: "+p)}class Xu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const n=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let g=parseInt(i[8],10);g=g>=0&&g<=23?g:0;let y=parseInt(i[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=g,u+=y):f==="+"&&(c-=g,u-=y),new Date(Date.UTC(n,r,l,c,u,h))}}function r0(p,{scale:t=1,rotation:i=0}){const{width:n,height:r}=p.attributes.style,l=[0,0,parseInt(n),parseInt(r)];return new dr({viewBox:l,userUnit:1,scale:t,rotation:i})}function fr(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(gt(`Not a valid color format: "${p}"`),[0,0,0])}function l0(p){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of p.keys()){t.style.color=i;const n=window.getComputedStyle(t).color;p.set(i,fr(n))}t.remove()}function Qt(p){const{a:t,b:i,c:n,d:r,e:l,f:c}=p.getTransform();return[t,i,n,r,l,c]}function Ei(p){const{a:t,b:i,c:n,d:r,e:l,f:c}=p.getTransform().invertSelf();return[t,i,n,r,l,c]}function Zs(p,t,i=!1,n=!0){if(t instanceof dr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=p,u=xe.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,g=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=g,c.height=y):(c.width=y,c.height=g)}n&&p.setAttribute("data-main-rotation",t.rotation)}class Di{constructor(){const{pixelRatio:t}=Di;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,n,r,l=-1){let c=1/0,u=1/0,h=1/0;n=Di.capPixels(n,l),n>0&&(c=Math.sqrt(n/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,n):n}return t}}const Yu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class o0{static get isDarkMode(){return yt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class c0{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:n}=window.getComputedStyle(t);return t.remove(),yt(this,"commentForegroundColor",fr(n))}}function u0(p,t,i,n){n=Math.min(Math.max(n??1,0),1);const r=255*(1-n);return p=Math.round(p*n+r),t=Math.round(t*n+r),i=Math.round(i*n+r),[p,t,i]}function Um(p,t){const i=p[0]/255,n=p[1]/255,r=p[2]/255,l=Math.max(i,n,r),c=Math.min(i,n,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const h=l-c;switch(t[1]=u<.5?h/(l+c):h/(2-l-c),l){case i:t[0]=((n-r)/h+(n<r?6:0))*60;break;case n:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-n)/h+4)*60;break}}t[2]=u}function Ku(p,t){const i=p[0],n=p[1],r=p[2],l=(1-Math.abs(2*r-1))*n,c=l*(1-Math.abs(i/60%2-1)),u=r-l/2;switch(Math.floor(i/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Im(p){return p<=.03928?p/12.92:((p+.055)/1.055)**2.4}function Hm(p,t,i){Ku(p,i),i.map(Im);const n=.2126*i[0]+.7152*i[1]+.0722*i[2];Ku(t,i),i.map(Im);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}const Gm=new Map;function h0(p,t){const i=p[0]+p[1]*256+p[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let n=Gm.get(i);if(n)return n;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);Um(p,c);const u=r.subarray(6,9);Um(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),Hm(c,u,l)<f){let g,y;h?(g=c[2],y=1):(g=0,y=c[2]);const b=.005;for(;y-g>b;){const A=c[2]=(g+y)/2;h===Hm(c,u,l)<f?g=A:y=A}c[2]=h?y:g}return Ku(c,l),n=rt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),Gm.set(i,n),n}function Ag({html:p,dir:t,className:i},n){const r=document.createDocumentFragment();if(typeof p=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=p.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];l.append(document.createTextNode(f)),u<h-1&&l.append(document.createElement("br"))}r.append(l)}else vg.render({xfaHtml:p,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",i),n.append(r)}function Sg(p){const t=new Path2D;if(!p)return t;for(let i=0,n=p.length;i<n;)switch(p[i++]){case $a.moveTo:t.moveTo(p[i++],p[i++]);break;case $a.lineTo:t.lineTo(p[i++],p[i++]);break;case $a.curveTo:t.bezierCurveTo(p[i++],p[i++],p[i++],p[i++],p[i++],p[i++]);break;case $a.quadraticCurveTo:t.quadraticCurveTo(p[i++],p[i++],p[i++],p[i++]);break;case $a.closePath:t.closePath();break;default:gt(`Unrecognized drawing path operator: ${p[i-1]}`);break}return t}class nr{#t=null;#e=null;#s;#i=null;#r=null;#a=null;#n=null;#l=null;static#c=null;constructor(t){this.#s=t,nr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#s._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",pi,{signal:i}),t.addEventListener("pointerdown",nr.#o,{signal:i}));const n=this.#i=document.createElement("div");n.className="buttons",t.append(n);const r=this.#s.toolbarPosition;if(r){const{style:l}=t,c=this.#s._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#o(t){t.stopPropagation()}#d(t){this.#s._focusEventsAllowed=!1,te(t)}#h(t){this.#s._focusEventsAllowed=!0,te(t)}#f(t){const i=this.#s._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",pi,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#s,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",nr.#c[t]),this.#f(n)&&n.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(n)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#g),this.#r=t}addComment(t,i=null){if(this.#a)return;const n=t.renderForToolbar();if(!n)return;this.#f(n);const r=this.#n=this.#g;i?(this.#i.insertBefore(n,i),this.#i.insertBefore(r,i)):this.#i.append(n,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#g)}async addEditSignatureButton(t){const i=this.#l=await t.renderEditButton(this.#s);this.#f(i),this.#i.append(i,this.#g)}removeButton(t){t==="comment"&&(this.#a?.removeToolbarCommentButton(),this.#a=null,this.#n?.remove(),this.#n=null)}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,n){if(!i&&t==="comment")return;const r=this.#i.querySelector(n);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#l&&(this.#l.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class d0{#t=null;#e=null;#s;constructor(t){this.#s=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#s._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",pi,{signal:i});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#s.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#s.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#s.highlightSelection("floating_button")}),t}#r(t,i){let n=0,r=0;for(const l of t){const c=l.y+l.height;if(c<n)continue;const u=l.x+(i?l.width:0);if(c>n){r=u,n=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,n]}show(t,i,n){const[r,l]=this.#r(i,n),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,n,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",i);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",n);const u=this.#s._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",pi,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function wg(p,t,i){for(const n of i)t.addEventListener(n,p[n].bind(p))}class jt{static#t=NaN;static#e=null;static#s=NaN;static#i=null;static initializeAndAddPointerId(t){(jt.#e||=new Set).add(t)}static setPointer(t,i){jt.#t||=i,jt.#i??=t}static setTimeStamp(t){jt.#s=t}static isSamePointerId(t){return jt.#t===t}static isSamePointerIdOrRemove(t){return jt.#t===t?!0:(jt.#e?.delete(t),!1)}static isSamePointerType(t){return jt.#i===t}static isInitializedAndDifferentPointerType(t){return jt.#i!==null&&!jt.isSamePointerType(t)}static isSameTimeStamp(t){return jt.#s===t}static isUsingMultiplePointers(){return jt.#e?.size>=1}static clearPointerType(){jt.#i=null}static clearPointerIds(){jt.#t=NaN,jt.#e=null}static clearTimeStamp(){jt.#s=NaN}}class f0{#t=0;get id(){return`${ar}${this.#t++}`}}class lh{#t=yg();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return yt(this,"_isSVGFittingCanvas",l)}async#i(t,i){this.#s||=new Map;let n=this.#s.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(n.url=i,r=await hr(i,"blob")):i instanceof File?r=n.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const l=lh._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,g)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,f()},c.onload=async()=>{const y=n.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=g});c.readAsDataURL(r),await h}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){gt(r),n=null}return this.#s.set(t,n),n&&this.#s.set(n.id,n),n}async getFromFile(t){const{lastModified:i,name:n,size:r,type:l}=t;return this.#i(`${i}_${n}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const n=await i;return this.#i(t,n)}async getFromId(t){this.#s||=new Map;const i=this.#s.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:n}=i;return delete i.blobPromise,this.getFromBlob(i.id,n)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#s||=new Map;let n=this.#s.get(t);if(n?.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,n),this.#s.set(n.id,n),n}getSvgUrl(t){const i=this.#s.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#s||=new Map;const i=this.#s.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:n}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),i.blobPromise=r.convertToBlob()}n.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class p0{#t=[];#e=!1;#s;#i=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:i,post:n,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:n,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===l){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#s?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class pr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=xe.platform;for(const[n,r,l={}]of t)for(const c of n){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const n=this.callbacks.get(this.#t(i));if(!n)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=n;u&&!u(t,i)||(r.bind(t,...c,i)(),l||te(i))}}class oh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return l0(t),yt(this,"_colors",t)}convert(t){const i=fr(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[n,r]of this._colors)if(r.every((l,c)=>l===i[c]))return oh._colorsMapping.get(n);return i}getHexCode(t){const i=this._colors.get(t);return i?rt.makeHexColor(...i):t}}class Ts{#t=new AbortController;#e=null;#s=null;#i=new Map;#r=new Map;#a=null;#n=null;#l=null;#c=new p0;#o=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#_=null;#S=null;#T=null;#A=!1;#x=null;#N=new f0;#M=!1;#D=!1;#z=!1;#O=null;#L=null;#P=null;#B=null;#q=null;#C=bt.NONE;#w=new Set;#k=null;#F=null;#I=null;#Y=null;#X=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#j=null;#V=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ts.prototype,i=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),n=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return yt(this,"_keyboardManager",new pr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}constructor(t,i,n,r,l,c,u,h,f,g,y,b,A,x,w,C){const _=this._signal=this.#t.signal;this.#V=t,this.#Z=i,this.#J=n,this.#a=r,this.#o=l,this.#F=c,this.#X=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:_}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),u._on("setpreference",this.onSetPreference.bind(this),{signal:_}),u._on("switchannotationeditorparams",M=>this.updateParams(M.type,M.value),{signal:_}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:_}),this.#rt(),this.#dt(),this.#et(),this.#n=h.annotationStorage,this.#E=h.filterFactory,this.#I=f,this.#T=g||null,this.#y=y,this.#v=b,this.#b=A,this.#q=x||null,this.viewParameters={realScale:Jn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=C!==!1,l?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#a?.destroy(),this.#o?.destroy(),this.#F?.destroy(),this.#x?.hide(),this.#x=null,this.#P?.destroy(),this.#P=null,this.#s=null,this.#_&&(clearTimeout(this.#_),this.#_=null),this.#j&&(clearTimeout(this.#j),this.#j=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return yt(this,"hcmFilter",this.#I?this.#E.addHCMFilter(this.#I.foreground,this.#I.background):"none")}get direction(){return yt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return yt(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return yt(this,"highlightColors",null);const i=new Map,n=!!this.#I;for(const[r,l]of t){const c=r.endsWith("_HCM");if(n&&c){i.set(r.replace("_HCM",""),l);continue}!n&&!c&&i.set(r,l)}return yt(this,"highlightColors",i)}get highlightColorNames(){return yt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#P=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#o}editComment(t,i,n,r){this.#o?.showDialog(this,t,i,n,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#o?.updateComment(t.getData())}updatePopupColor(t){this.#o?.updatePopupColor(t)}removeComment(t){this.#o?.removeComments([t.uid])}toggleComment(t,i,n=void 0){this.#o?.toggleCommentPopup(t,i,n)}makeCommentColor(t,i){return t&&this.#o?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#o?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:n}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await n}getSignature(t){this.#F?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#F}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=i)}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const n of this.#r.values()){const{x:r,y:l,width:c,height:u}=n.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=l&&i<=l+u)return n}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Jn.PDF_TO_CSS_UNITS;for(const i of this.#p)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const n of this.#r.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",i=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=n,h=n.toString(),g=this.#W(n).closest(".textLayer"),y=this.getSelectionBoxes(g);if(!y)return;n.empty();const b=this.#tt(g),A=this.#C===bt.NONE,x=()=>{const w=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&w?.editComment()};if(A){this.switchToMode(bt.HIGHLIGHT,x);return}x()}commentSelection(t=""){this.highlightSelection(t,!0)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#W(t).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(this.#x||=new d0(this),this.#x.show(n,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#n)return null;const i=`${ar}${t}`,n=this.#n.getRawValue(i);return n&&this.#n.remove(i),n}addToAnnotationStorage(t){!t.isEmpty()&&this.#n&&!this.#n.has(t.id)&&this.#n.setValue(t.id,t)}a11yAlert(t,i=null){const n=this.#J;n&&(n.setAttribute("data-l10n-id",t),i?n.setAttribute("data-l10n-args",JSON.stringify(i)):n.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#k&&(this.#x?.hide(),this.#k=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#k)return;const r=this.#W(t).closest(".textLayer");if(!r){this.#k&&(this.#x?.hide(),this.#k=null,this.#R({hasSelectedText:!1}));return}if(this.#x?.hide(),this.#k=i,this.#R({hasSelectedText:!0}),!(this.#C!==bt.HIGHLIGHT&&this.#C!==bt.NONE)&&(this.#C===bt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#C===bt.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#D){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#$("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l?.toggleDrawing(!0),this.#$("main_toolbar")}}#$(t=""){this.#C===bt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#nt()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#lt(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ot(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#w)if(i.div.contains(t)){this.#L=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,i]=this.#L;this.#L=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#O?.abort(),this.#O=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(i.type)){n.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const n of this.#w){const r=n.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let n=i.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(l){gt(`paste: "${l.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const h of n){const f=await r.deserialize(h);if(!f)return;l.push(f)}const c=()=>{for(const h of l)this.#it(h);this.#st(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){gt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==bt.NONE&&!this.isEditorHandlingKeyboard&&Ts._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(t){Object.entries(t).some(([n,r])=>this.#K[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,t)}),this.#C===bt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Mt.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#lt(),this.#ut(),this.#R({isEditing:this.#C!==bt.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ot(),this.#ht(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,n=!1,r=!1,l=!1){if(this.#C!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===bt.POPUP&&this.#o?.hideSidebar(),this.#o?.destroyPopup(),this.#C=t,t===bt.NONE){this.setEditingState(!1),this.#pt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===bt.SIGNATURE&&await this.#F?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===bt.POPUP){this.#s||=await this.#X.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const c=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:g,deleted:y}=h;f&&c.add(f),g&&!y&&u.push(h.getData())}for(const h of this.#s){const{id:f,popupRef:g,contentsObj:y}=h;g&&y?.str&&!c.has(f)&&!this.#g.has(f)&&u.push(h)}this.#o?.showSidebar(u)}if(!i){n&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const c of this.#i.values())c.uid===i?(this.setSelected(c),l?c.editComment():r?c.enterInEditMode():c.focus()):c.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Mt.CREATE:this.currentLayer.addNewEditor(i);return;case Mt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const n of this.#w)n.updateParams(t,i);else for(const n of this.#u)n.updateDefaultParams(t,i)}}showAllEditors(t,i,n=!1){for(const l of this.#i.values())l.editorType===t&&l.show(i);(this.#Y?.get(Mt.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Mt.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#z!==t){this.#z=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.focusMainContainer(),this.#_=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#n?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#mt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#w)i!==t&&i.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#w],n=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const l of i)l.remove()},r=()=>{for(const l of i)this.#it(l)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#st(t){for(const i of this.#w)i.unselect();this.#w.clear();for(const i of t)i.isEmpty()||(this.#w.add(i),i.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#st(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==bt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[r,l]=this.#H,c=[...this.#w],u=1e3;this.#j&&clearTimeout(this.#j),this.#j=setTimeout(()=>{this.#j=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,l),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#w)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let i=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,i||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const n=(r,l,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)n(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)n(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#m)for(const n of this.#m.keys())n.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==bt.NONE}get imageManager(){return yt(this,"imageManager",new lh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,g=i.rangeCount;f<g;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,g,y,b)=>({x:(g-r)/c,y:1-(f+y-n)/l,width:b/c,height:y/l});break;case"180":u=(f,g,y,b)=>({x:1-(f+y-n)/l,y:1-(g+b-r)/c,width:y/l,height:b/c});break;case"270":u=(f,g,y,b)=>({x:1-(g+b-r)/c,y:(f-n)/l,width:b/c,height:y/l});break;default:u=(f,g,y,b)=>({x:(f-n)/l,y:(g-r)/c,width:y/l,height:b/c});break}const h=[];for(let f=0,g=i.rangeCount;f<g;f++){const y=i.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:x,height:w}of y.getClientRects())x===0||w===0||h.push(u(b,A,x,w))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#l||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const i=this.#l?.get(t.data.id);if(!i)return;const n=this.#n.getRawValue(i);n&&(this.#C===bt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,i,n){const r=this.#B?.get(t);r&&(r.setCanvas(i,n),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Mi{#t=null;#e=!1;#s=null;#i=null;#r=null;#a=null;#n=!1;#l=null;#c=null;#o=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Mi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Mi._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Mi.#f.missing),i.setAttribute("data-l10n-id",Mi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;t.addEventListener("contextmenu",pi,{signal:n}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:n});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#n=!0,r(l))},{signal:n}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#n}),this.#n=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(t){this.#t===null&&(this.#o=t,this.#d=await Mi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const i=this.#l=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#l.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#o===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#o,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:n,textWithDisclaimer:r,cancel:l=!1}){n&&(this.#o=n,this.#d=r),!(this.#t===t&&this.#e===i)&&(l||(this.#t=t,this.#e=i),this.#m())}toggle(t=!1){this.#s&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#s?.remove(),this.#s=null,this.#i=null,this.#r=null,this.#l?.remove(),this.#l=null}async#m(){const t=this.#s;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Mi.#f[this.#g]),this.#i?.setAttribute("data-l10n-id",Mi.#f[`${this.#g}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class Bl{#t=null;#e=null;#s=!1;#i=null;#r=null;#a=null;#n=null;#l=null;#c=!1;#o=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:n}=t;n.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(n.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#o)return this.#o;if(!this.#t)return null;const{x:t,y:i,height:n}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+n-l)/u]}set commentPopupPositionInLayer(t){this.#o=t}hasDefaultPopupPosition(){return this.#o===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#i._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return t;t.addEventListener("contextmenu",pi,{signal:n}),i&&(t.addEventListener("focusin",l=>{this.#i._focusEventsAllowed=!1,te(l)},{capture:!0,signal:n}),t.addEventListener("focusout",l=>{this.#i._focusEventsAllowed=!0,te(l)},{capture:!0,signal:n})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:n});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,r(l))},{signal:n}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:n}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:n}),t}edit(t){const i=this.commentPopupPositionInLayer;let n,r;if(i)[n,r]=i;else{[n,r]=this.#i.commentButtonPosition;const{width:g,height:y,x:b,y:A}=this.#i;n=b+n*g,r=A+r*y}const l=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=l;this.#i._uiManager.editComment(this.#i,c+n*h,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#s}),this.#s=!1)}isDeleted(){return this.#c||this.#n===""}isEmpty(){return this.#n===null}hasBeenEdited(){return this.isDeleted()||this.#n!==this.#r}serialize(){return this.data}get data(){return{text:this.#n,richText:this.#a,date:this.#l,deleted:this.isDeleted()}}set data(t){if(t!==this.#n&&(this.#a=null),t===null){this.#n="",this.#c=!0;return}this.#n=t,this.#l=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#l=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#n="",this.#a=null,this.#l=null,this.#i=null,this.#s=!1,this.#c=!1}}class io{#t;#e=!1;#s=null;#i;#r;#a;#n;#l=null;#c;#o=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#s=n,this.#i=i,this.#r=r,this.#a=l,this.#n=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Di.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#l)return;const r=this.#l=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#l?.abort(),this.#l=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(te(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",te,c),l.addEventListener("pointermove",te,c),l.addEventListener("pointercancel",te,c),l.addEventListener("pointerup",te,c),this.#r?.()}if(te(t),t.touches.length!==2||this.#s?.()){this.#o=null;return}let[i,n]=t.touches;i.identifier>n.identifier&&([i,n]=[n,i]),this.#o={touch0X:i.screenX,touch0Y:i.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#o||t.touches.length!==2)return;te(t);let[i,n]=t.touches;i.identifier>n.identifier&&([i,n]=[n,i]);const{screenX:r,screenY:l}=i,{screenX:c,screenY:u}=n,h=this.#o,{touch0X:f,touch0Y:g,touch1X:y,touch1Y:b}=h,A=y-f,x=b-g,w=c-r,C=u-l,_=Math.hypot(w,C)||1,M=Math.hypot(A,x)||1;if(!this.#e&&Math.abs(M-_)<=io.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+c)/2,(l+u)/2];this.#a?.(T,M,_)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#n?.()),this.#o&&(te(t),this.#o=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#l?.abort(),this.#l=null}}class ut{#t=null;#e=null;#s=null;#i=null;#r=null;#a=!1;#n=null;#l="";#c=null;#o=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#_=0;#S=null;#T=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#x=ut._zIndex++;static _borderLineWidth=-1;static _colorManager=new oh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ut.prototype._resizeWithKeyboard,i=Ts.TRANSLATE_SMALL,n=Ts.TRANSLATE_BIG;return yt(this,"_resizerKeyboardManager",new pr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:n,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return yt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new m0({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(ut._l10n??=t,ut._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ut._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){qt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#x}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#j(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,n,r){const[l,c]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(t+n)/l,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[n,r]=this.parentDimensions;this.setAt(t*n,i*r,this.width*n,this.height*r),this._onTranslated()}#N([t,i],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#N(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:g}=n;g.left=`${(100*c).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:n}=ut,r=n/t,l=n/i;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[n,r]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=n,h*=r,l*=n,c*=r,this._mustFixPosition)switch(t){case 0:l=De(l,0,n-u),c=De(c,0,r-h);break;case 90:l=De(l,0,n-h),c=De(c,u,r);break;case 180:l=De(l,u,n),c=De(c,h,r);break;case 270:l=De(l,h,n),c=De(c,0,r-u);break}this.x=l/=n,this.y=c/=r;const[f,g]=this.getBaseTranslation();l+=f,c+=g,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,n){switch(n){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return ut.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return ut.#M(t,i,360-this.parentRotation)}#D(t){switch(t){case 90:{const[i,n]=this.pageDimensions;return[0,-i/n,n/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,n]=this.pageDimensions;return[0,i/n,-n/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,n]}=this;return[i*t,n*t]}setDims(){const{div:{style:t},width:i,height:n}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const n of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#O.bind(this,n),{signal:i}),r.addEventListener("contextmenu",pi,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#O(t,i){i.preventDefault();const{isMac:n}=xe.platform;if(i.button!==0||i.ctrlKey&&n)return;this.#s?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#o=[i.screenX,i.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",te,{passive:!1,signal:c}),window.addEventListener("contextmenu",pi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#P()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,i,n,r){this.width=n,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#P(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:n,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===t&&c===i&&u===n&&h===r||this.addCommands({cmd:this.#L.bind(this,l,c,u,h),undo:this.#L.bind(this,t,i,n,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[n,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,f=ut.MIN_SIZE/n,g=ut.MIN_SIZE/r,y=this.#D(this.rotation),b=(B,G)=>[y[0]*B+y[2]*G,y[1]*B+y[3]*G],A=this.#D(360-this.rotation),x=(B,G)=>[A[0]*B+A[2]*G,A[1]*B+A[3]*G];let w,C,_=!1,M=!1;switch(t){case"topLeft":_=!0,w=(B,G)=>[0,0],C=(B,G)=>[B,G];break;case"topMiddle":w=(B,G)=>[B/2,0],C=(B,G)=>[B/2,G];break;case"topRight":_=!0,w=(B,G)=>[B,0],C=(B,G)=>[0,G];break;case"middleRight":M=!0,w=(B,G)=>[B,G/2],C=(B,G)=>[0,G/2];break;case"bottomRight":_=!0,w=(B,G)=>[B,G],C=(B,G)=>[0,0];break;case"bottomMiddle":w=(B,G)=>[B/2,G],C=(B,G)=>[B/2,0];break;case"bottomLeft":_=!0,w=(B,G)=>[0,G],C=(B,G)=>[B,0];break;case"middleLeft":M=!0,w=(B,G)=>[0,G/2],C=(B,G)=>[B,G/2];break}const T=w(u,h),R=C(u,h);let O=b(...R);const N=ut._round(l+O[0]),j=ut._round(c+O[1]);let V=1,$=1,J,tt;if(i.fromKeyboard)({deltaX:J,deltaY:tt}=i);else{const{screenX:B,screenY:G}=i,[Z,ft]=this.#o;[J,tt]=this.screenToPageTranslation(B-Z,G-ft),this.#o[0]=B,this.#o[1]=G}if([J,tt]=x(J/n,tt/r),_){const B=Math.hypot(u,h);V=$=Math.max(Math.min(Math.hypot(R[0]-T[0]-J,R[1]-T[1]-tt)/B,1/u,1/h),f/u,g/h)}else M?V=De(Math.abs(R[0]-T[0]-J),f,1)/u:$=De(Math.abs(R[1]-T[1]-tt),g,1)/h;const it=ut._round(u*V),pt=ut._round(h*$);O=b(...C(it,pt));const ht=N-O[0],vt=j-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=it,this.height=pt,this.x=ht,this.y=vt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new nr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,n]of t)await this._editToolbar.addButton(i,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#s?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(Mi.initialize(ut._l10n),this.#s=new Mi(this),this.#t&&(this.#s.data=this.#t,this.#t=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new Bl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:n,deleted:r}}=this.#i;return{text:i,richText:t,date:n,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Bl(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:n}){if(!i||(this.#i||=new Bl(this),this.#i.setInitialText(t,n),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Bl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#I();const[i,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/n).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),wg(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new io({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,i,n){let l=.7*(n/i)+1-.7;if(l===1)return;const c=this.#D(this.rotation),u=(N,j)=>[c[0]*N+c[2]*j,c[1]*N+c[3]*j],[h,f]=this.parentDimensions,g=this.x,y=this.y,b=this.width,A=this.height,x=ut.MIN_SIZE/h,w=ut.MIN_SIZE/f;l=Math.max(Math.min(l,1/b,1/A),x/b,w/A);const C=ut._round(b*l),_=ut._round(A*l);if(C===b&&_===A)return;this.#u||=[g,y,b,A];const M=u(b/2,A/2),T=ut._round(g+M[0]),R=ut._round(y+M[1]),O=u(C/2,_/2);this.x=T-O[0],this.y=R-O[1],this.width=C,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#P()}pointerdown(t){const{isMac:i}=xe.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#F(t);return}this.#k(t)}#k(t){const{isMac:i}=xe.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#F(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#n=null,this.#m=!1,this._uiManager.endDragSession()||this.#k(f),n&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#_=t.clientY,this.#n=t.pointerId,this.#l=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:y,pointerId:b}=f;if(b!==this.#n){te(f);return}const[A,x]=this.screenToPageTranslation(g-this.#E,y-this.#_);this.#E=g,this.#_=y,this._uiManager.dragSelectedEditors(A,x)},c),window.addEventListener("touchmove",te,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#l&&(this.#T||f.isPrimary)&&u(f),te(f)},c));const h=f=>{if(!this.#n||this.#n===f.pointerId){u(f);return}te(f)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,n){t.changeParent(this),this.x=i,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,n=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,g=i/r,y=this.x*l,b=this.y*c,A=this.width*l,x=this.height*c;switch(n){case 0:return[y+f+u,c-b-g-x+h,y+f+A+u,c-b-g+h];case 90:return[y+g+u,c-b+f+h,y+g+x+u,c-b+f+A+h];case 180:return[y-f-A+u,c-b+g+h,y-f+u,c-b+g+x+h];case 270:return[y-g-x+u,c-b-f-A+h,y-g+u,c-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[n,r,l,c]=t,u=l-n,h=c-r;switch(this.rotation){case 0:return[n,i-c,u,h];case 90:return[n,i-r,h,u];case 180:return[l,i-r,u,h];case 270:return[l,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:n,opacity:r,deleted:l,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:n||g,popupRef:!l,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&r>0&&t<l&&n>0}#I(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#I()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,n){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:n,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,h,f,g]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=h/c,r.width=f/l,r.height=g/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#j(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#T?.destroy(),this.#T=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[n,r,l,c]=this.getPDFRect();return[ut._round(n+(l-n)*t),ut._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#Y.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#K.bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",ut._l10nResizer[g])}}const n=this.#e[0];let r=0;for(const c of i){if(c===n)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ut._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ut._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#j()}#K(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#g,{deltaX:t,deltaY:i,fromKeyboard:!0})}#j(){this.#v=!1,this.#H(-1),this.#P()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:n}=t;let r=this.#S.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(n),this.#S.size===0&&(this.#S=null)},ut._telemetryTimeout),this.#S.set(n,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const n=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),n.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class m0 extends ut{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const qm=3285377520,ui=4294901760,Ci=65535;class _g{constructor(t){this.h1=t?t&4294967295:qm,this.h2=t?t&4294967295:qm}update(t){let i,n;if(typeof t=="string"){i=new Uint8Array(t.length*2),n=0;for(let w=0,C=t.length;w<C;w++){const _=t.charCodeAt(w);_<=255?i[n++]=_:(i[n++]=_>>>8,i[n++]=_&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),n=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,l=n-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,g=this.h2;const y=3432918353,b=461845907,A=y&Ci,x=b&Ci;for(let w=0;w<r;w++)w&1?(u=c[w],u=u*y&ui|u*A&Ci,u=u<<15|u>>>17,u=u*b&ui|u*x&Ci,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[w],h=h*y&ui|h*A&Ci,h=h<<15|h>>>17,h=h*b&ui|h*x&Ci,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,l){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*y&ui|u*A&Ci,u=u<<15|u>>>17,u=u*b&ui|u*x&Ci,r&1?f^=u:g^=u}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&ui|t*36045&Ci,i=i*4283543511&ui|((i<<16|t>>>16)*2950163797&ui)>>>16,t^=i>>>1,t=t*444984403&ui|t*60499&Ci,i=i*3301882366&ui|((i<<16|t>>>16)*3120437893&ui)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const $u=Object.freeze({map:null,hash:"",transfer:void 0});class ch{#t=!1;#e=null;#s=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const n=this.#i.get(t);return n===void 0?i:Object.assign(i,n)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof ut&&this.#s.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#i.values())if(n instanceof ut)return;this.onAnnotationEditor(null)}}setValue(t,i){const n=this.#i.get(t);let r=!1;if(n!==void 0)for(const[l,c]of Object.entries(i))n[l]!==c&&(r=!0,n[l]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof ut&&((this.#s||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new xg(this)}get serializable(){if(this.#i.size===0)return $u;const t=new Map,i=new _g,n=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#i){const h=u instanceof ut?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of t.values())c.bitmap&&n.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:n}:$u}get editorStats(){let t=null;const i=new Map;let n=0,r=0;for(const l of this.#i.values()){if(!(l instanceof ut)){l.popup&&(l.popup.deleted?r+=1:n+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(n+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,g]of Object.entries(c)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(g)??0;y.set(g,b+1)}}if((r>0||n>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:n}),!t)return null;for(const[l,c]of i)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const n=this.#s?.get(t);return n?(n.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#s?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#s)for(const i of this.#s.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class xg extends ch{#t;constructor(t){super();const{map:i,hash:n,transfer:r}=t.serializable,l=structuredClone(i,r?{transfer:r}:null);this.#t={map:l,hash:n,transfer:r}}get print(){qt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return yt(this,"modifiedIds",{ids:new Set,hash:""})}}class g0{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(Dt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),n?.(t)}catch{gt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}qt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw gt(`Failed to load font '${n.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return yt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return yt(this,"isSyncFontLoadingSupported",Me||xe.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Dt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const l=n.shift();setTimeout(l.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:i,callback:t};return n.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return yt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function n(R,O){return R.charCodeAt(O)<<24|R.charCodeAt(O+1)<<16|R.charCodeAt(O+2)<<8|R.charCodeAt(O+3)&255}function r(R,O,N,j){const V=R.substring(0,O),$=R.substring(O+N);return V+j+$}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function g(R,O){if(++f>30){gt("Load test font never loaded."),O();return}if(h.font="30px "+R,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,R,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,y.length,y);const x=16,w=1482184792;let C=n(b,x);for(l=0,c=y.length-3;l<c;l+=4)C=C-w+n(y,l)|0;l<y.length&&(C=C-w+n(y+"XXX",l)|0),b=r(b,x,4,Qv(C));const _=`url(data:font/opentype;base64,${btoa(b)});`,M=`@font-face {font-family:"${y}";src:${_}}`;this.insertRule(M);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const R of[t.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=R,T.append(O)}this._document.body.append(T),g(y,()=>{T.remove(),i.complete()})}}class y0{#t;constructor(t,i=null,n,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,n&&Object.assign(this,n),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${bg(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const n=this.loadedName+"_path_"+i;let r;try{r=t.get(n)}catch(c){gt(`getPathGenerator - ignoring character: "${c}".`)}const l=Sg(r);return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[i]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){yt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){yt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Kn{#t;#e;#s;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,n={};let r=0;for(const f of Kn.strings){const g=i.encode(t[f]);n[f]=g,r+=4+g.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let h=0;for(const f of Kn.strings){const g=n[f],y=g.length;u.setUint32(h,y),c.set(g,h+4),h+=4+y}return Dt(h===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}#i(t){Dt(t<Kn.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const n=this.#e.getUint32(i);return this.#s.decode(new Uint8Array(this.#t,i+4,n))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class $n{#t;#e;#s;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,n={};let r=0;for(const b of $n.strings){const A=i.encode(t[b]);n[b]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+l.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),g=new DataView(h);let y=0;g.setUint8(y++,t.guessFallback?1:0),g.setUint32(y,0),y+=4,r=0;for(const b of $n.strings){const A=n[b],x=A.length;r+=4+x,g.setUint32(y,x),f.set(A,y+4),y+=4+x}return g.setUint32(y-r-4,r),t.style&&(g.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,g.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Dt(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Dt(t<$n.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const n=this.#e.getUint32(i);return this.#s.decode(new Uint8Array(this.#t,i+4,n))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),n=this.#s.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),l=this.#s.decode(new Uint8Array(this.#t,t+4,r));return{style:n,weight:l}}}class Ht{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#s=this.#e+1+8;static#i=this.#s+1+48;static#r=this.#i+1+6;#a;#n;#l;constructor({data:t,extra:i}){this.#a=t,this.#n=new TextDecoder,this.#l=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Dt(t<Ht.bools.length,"Invalid boolean index");const i=Math.floor(t/4),n=t*2%8,r=this.#l.getUint8(i)>>n&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#o(t){return Dt(t<Ht.numbers.length,"Invalid number index"),this.#l.getFloat64(Ht.#t+t*8)}get ascent(){return this.#o(0)}get defaultWidth(){return this.#o(1)}get descent(){return this.#o(2)}get bbox(){let t=Ht.#e;if(this.#l.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<4;r++)n.push(this.#l.getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=Ht.#s;if(this.#l.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<6;r++)n.push(this.#l.getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=Ht.#i;if(this.#l.getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<3;r++)n.push(this.#l.getInt16(t,!0)),t+=2;return n}#d(t){Dt(t<Ht.strings.length,"Invalid string index");let i=Ht.#r+4;for(let l=0;l<t;l++)i+=this.#l.getUint32(i)+4;const n=this.#l.getUint32(i),r=new Uint8Array(n);return r.set(new Uint8Array(this.#a,i+4,n)),this.#n.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const n=this.#l.getUint32(t);t+=4+n;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const n=this.#l.getUint32(t);t+=4+n;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#l.setUint32(t,0)}get cssFontInfo(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const n=this.#l.getUint32(t);t+=4+n;const r=this.#l.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new Kn(l.buffer)}get systemFontInfo(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const n=this.#l.getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(this.#a,t+4,n)),new $n(r.buffer)}static write(t){const i=t.systemFontInfo?$n.write(t.systemFontInfo):null,n=t.cssFontInfo?Kn.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const w of Ht.strings)l[w]=r.encode(t[w]),c+=4+l[w].length;const u=Ht.#r+4+c+4+(i?i.byteLength:0)+4+(n?n.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),g=new DataView(h);let y=0;const b=Ht.bools.length;let A=0,x=0;for(let w=0;w<b;w++){const C=t[Ht.bools[w]];A|=(C===void 0?0:C?2:1)<<x,x+=2,(x===8||w===b-1)&&(g.setUint8(y++,A),A=0,x=0)}Dt(y===Ht.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of Ht.numbers)g.setFloat64(y,t[w]),y+=8;if(Dt(y===Ht.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(y++,4);for(const w of t.bbox)g.setInt16(y,w,!0),y+=2}else g.setUint8(y++,0),y+=8;if(Dt(y===Ht.#s,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(y++,6);for(const w of t.fontMatrix)g.setFloat64(y,w,!0),y+=8}else g.setUint8(y++,0),y+=48;if(Dt(y===Ht.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(y++,1);for(const w of t.defaultVMetrics)g.setInt16(y,w,!0),y+=2}else g.setUint8(y++,0),y+=6;Dt(y===Ht.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(Ht.#r,0),y+=4;for(const w of Ht.strings){const C=l[w],_=C.length;g.setUint32(y,_),f.set(C,y+4),y+=4+_}if(g.setUint32(Ht.#r,y-Ht.#r-4),!i)g.setUint32(y,0),y+=4;else{const w=i.byteLength;g.setUint32(y,w),Dt(y+4+w<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+w}if(!n)g.setUint32(y,0),y+=4;else{const w=n.byteLength;g.setUint32(y,w),Dt(y+4+w<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),y+4),y+=4+w}return t.data===void 0?(g.setUint32(y,0),y+=4):(g.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Dt(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}}class pe{static#t=0;static#e=1;static#s=2;static#i=3;static#r=4;static#a=8;static#n=12;static#l=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,n=null,r=[],l=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,n=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],l=t[3],u=t[4]||[],n=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const g=Math.floor(r.length/2),y=Math.floor(l.length/3),b=c.length,A=u.length;let x=0;for(const O of u)x+=1,x=Math.ceil(x/4)*4,x+=4+O.coords.length*4,x+=4+O.colors.length*4,O.verticesPerRow!==void 0&&(x+=4);const w=20+g*8+y*3+b*8+(n?16:0)+(f?3:0)+x,C=new ArrayBuffer(w),_=new DataView(C),M=new Uint8Array(C);_.setUint8(pe.#t,i),_.setUint8(pe.#e,n?1:0),_.setUint8(pe.#s,f?1:0),_.setUint8(pe.#i,h),_.setUint32(pe.#r,g,!0),_.setUint32(pe.#a,y,!0),_.setUint32(pe.#n,b,!0),_.setUint32(pe.#l,A,!0);let T=20;new Float32Array(C,T,g*2).set(r),T+=g*8,M.set(l,T),T+=y*3;for(const[O,N]of c)_.setFloat32(T,O,!0),T+=4,_.setUint32(T,parseInt(N.slice(1),16),!0),T+=4;if(n)for(const O of n)_.setFloat32(T,O,!0),T+=4;f&&(M.set(f,T),T+=3);for(let O=0;O<u.length;O++){const N=u[O];_.setUint8(T,N.type),T+=1,T=Math.ceil(T/4)*4,_.setUint32(T,N.coords.length,!0),T+=4,new Int32Array(C,T,N.coords.length).set(N.coords),T+=N.coords.length*4,_.setUint32(T,N.colors.length,!0),T+=4,new Int32Array(C,T,N.colors.length).set(N.colors),T+=N.colors.length*4,N.verticesPerRow!==void 0&&(_.setUint32(T,N.verticesPerRow,!0),T+=4)}return C}getIR(){const t=this.view,i=this.data[pe.#t],n=!!this.data[pe.#e],r=!!this.data[pe.#s],l=t.getUint32(pe.#r,!0),c=t.getUint32(pe.#a,!0),u=t.getUint32(pe.#n,!0),h=t.getUint32(pe.#l,!0);let f=20;const g=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const b=[];for(let C=0;C<u;++C){const _=t.getFloat32(f,!0);f+=4;const M=t.getUint32(f,!0);f+=4,b.push([_,`#${M.toString(16).padStart(6,"0")}`])}let A=null;if(n){A=[];for(let C=0;C<4;++C)A.push(t.getFloat32(f,!0)),f+=4}let x=null;r&&(x=new Uint8Array(this.buffer,f,3),f+=3);const w=[];for(let C=0;C<h;++C){const _=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const M=t.getUint32(f,!0);f+=4;const T=new Int32Array(this.buffer,f,M);f+=M*4;const R=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,R);f+=R*4;const N={type:_,coords:T,colors:O};_===qu.LATTICE&&(N.verticesPerRow=t.getUint32(f,!0),f+=4),w.push(N)}if(i===1)return["RadialAxial","axial",A,b,Array.from(g.slice(0,2)),Array.from(g.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,b,[g[0],g[1]],[g[3],g[4]],g[2],g[5]];if(i===3){const C=this.data[pe.#i];let _=null;if(g.length>0){let M=g[0],T=g[0],R=g[1],O=g[1];for(let N=0;N<g.length;N+=2){const j=g[N],V=g[N+1];M=M>j?j:M,R=R>V?V:R,T=T<j?j:T,O=O<V?V:O}_=[M,R,T,O]}return["Mesh",C,g,y,w,_,A,x]}throw new Error(`Unsupported pattern kind: ${i}`)}}function b0(p){if(p instanceof URL)return p.href;if(typeof p=="string"){if(Me)return p;const t=URL.parse(p,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function v0(p){if(Me&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return ur(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p?.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function jl(p){if(typeof p!="string")return null;if(p.endsWith("/"))return p;throw new Error(`Invalid factory url: "${p}" must include trailing slash.`)}const Qu=p=>typeof p=="object"&&Number.isInteger(p?.num)&&p.num>=0&&Number.isInteger(p?.gen)&&p.gen>=0,A0=p=>typeof p=="object"&&typeof p?.name=="string",S0=e0.bind(null,Qu,A0);class w0{#t=new Map;#e=Promise.resolve();postMessage(t,i){const n={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,n)})}addEventListener(t,i,n=null){let r=null;if(n?.signal instanceof AbortSignal){const{signal:l}=n;if(l.aborted){gt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const zl={DATA:1,ERROR:2},oe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Vm(){}function Fe(p){if(p instanceof Cs||p instanceof Vu||p instanceof zm||p instanceof Kl||p instanceof ku)return p;switch(p instanceof Error||typeof p=="object"&&p!==null||qt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new Cs(p.message);case"InvalidPDFException":return new Vu(p.message);case"PasswordException":return new zm(p.message,p.code);case"ResponseException":return new Kl(p.message,p.status,p.missing);case"UnknownErrorException":return new ku(p.message,p.details)}return new ku(p.message,p.toString())}class ir{#t=new AbortController;constructor(t,i,n){this.sourceName=t,this.targetName=i,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const n=t.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===zl.DATA)r.resolve(t.data);else if(t.callback===zl.ERROR)r.reject(Fe(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:n,targetName:r,callback:zl.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:n,targetName:r,callback:zl.ERROR,callbackId:t.callbackId,reason:Fe(c)})});return}if(t.streamId){this.#s(t);return}i(t.data)}on(t,i){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=i}send(t,i,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},n)}sendWithPromise(t,i,n){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},n)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,n,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:i,desiredSize:f.desiredSize},r),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[l].pullCall=g,h.postMessage({sourceName:c,targetName:u,stream:oe.PULL,streamId:l,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Dt(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[l].cancelCall=g,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:oe.CANCEL,streamId:l,reason:Fe(f)}),g.promise}},n)}#s(t){const i=t.streamId,n=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,g=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:n,targetName:r,stream:oe.ENQUEUE,streamId:i,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:r,stream:oe.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Dt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:r,stream:oe.ERROR,streamId:i,reason:Fe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){l.postMessage({sourceName:n,targetName:r,stream:oe.START_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:n,targetName:r,stream:oe.START_COMPLETE,streamId:i,reason:Fe(f)})})}#i(t){const i=t.streamId,n=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case oe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Fe(t.reason));break;case oe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Fe(t.reason));break;case oe.PULL:if(!u){l.postMessage({sourceName:n,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Vm).then(function(){l.postMessage({sourceName:n,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:n,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,reason:Fe(f)})});break;case oe.ENQUEUE:if(Dt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case oe.CLOSE:if(Dt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case oe.ERROR:Dt(c,"error should have stream controller"),c.controller.error(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL:if(!u)break;const h=Fe(t.reason);Promise.try(u.onCancel||Vm,h).then(function(){l.postMessage({sourceName:n,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:n,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,reason:Fe(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Eg{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,i);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,n){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){qt("Abstract method `_createCanvas` called.")}}class _0 extends Eg{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const n=this._document.createElement("canvas");return n.width=t,n.height=i,n}}class Cg{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class Xm extends Cg{async _fetch(t){const i=await hr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):ur(i)}}class Tg{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,n,r,l){return"none"}destroy(t=!1){}}class x0 extends Tg{#t;#e;#s;#i;#r;#a;#n=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#l(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#o(){if(!this.#s){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const n=this.#r.createElementNS($i,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#s=this.#r.createElementNS($i,"defs"),t.append(n),n.append(this.#s),this.#r.body.append(t)}return this.#s}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=h[y]/255;const g=f.join(",");return[g,g,g]}const[i,n,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=i[h]/255,c[h]=n[h]/255,u[h]=r[h]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(eo(i)?gt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=mg(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#l.get(t);if(i)return i;const[n,r,l]=this.#d(t),c=t.length===1?n:`${n}${r}${l}`;if(i=this.#l.get(c),i)return this.#l.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#n++}`,h=this.#h(u);this.#l.set(t,h),this.#l.set(c,h);const f=this.#m(u);return this.#p(n,r,l,f),h}addHCMFilter(t,i){const n=`${t}-${i}`,r="base";let l=this.#c.get(r);if(l?.key===n||(l?(l.filter?.remove(),l.key=n,l.url="none",l.filter=null):(l={key:n,url:"none",filter:null},this.#c.set(r,l)),!t||!i))return l.url;const c=this.#v(t);t=rt.makeHexColor(...c);const u=this.#v(i);if(i=rt.makeHexColor(...u),this.#o.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const h=new Array(256);for(let A=0;A<=255;A++){const x=A/255;h[A]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=h.join(","),g=`g_${this.#i}_hcm_filter`,y=l.filter=this.#m(g);this.#p(f,f,f,y),this.#g(y);const b=(A,x)=>{const w=c[A]/255,C=u[A]/255,_=new Array(x+1);for(let M=0;M<=x;M++)_[M]=w+M/x*(C-w);return _.join(",")};return this.#p(b(0,5),b(1,5),b(2,5),y),l.url=this.#h(g),l.url}addAlphaFilter(t){let i=this.#l.get(t);if(i)return i;const[n]=this.#d([t]),r=`alpha_${n}`;if(i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_alpha_map_${this.#n++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#m(l);return this.#y(n,u),c}addLuminosityFilter(t){let i=this.#l.get(t||"luminosity");if(i)return i;let n,r;if(t?([n]=this.#d([t]),r=`luminosity_${n}`):r="luminosity",i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_luminosity_map_${this.#n++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#m(l);return this.#f(u),t&&this.#y(n,u),c}addHighlightHCMFilter(t,i,n,r,l){const c=`${i}-${n}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!n))return u.url;const[h,f]=[i,n].map(this.#v.bind(this));let g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[r,l].map(this.#v.bind(this));y<g&&([g,y,b,A]=[y,g,A,b]),this.#o.style.color="";const x=(_,M,T)=>{const R=new Array(256),O=(y-g)/T,N=_/255,j=(M-_)/(255*T);let V=0;for(let $=0;$<=T;$++){const J=Math.round(g+$*O),tt=N+$*j;for(let it=V;it<=J;it++)R[it]=tt;V=J+1}for(let $=V;$<256;$++)R[$]=R[V-1];return R.join(",")},w=`g_${this.#i}_hcm_${t}_filter`,C=u.filter=this.#m(w);return this.#g(C),this.#p(x(b[0],A[0],5),x(b[1],A[1],5),x(b[2],A[2],5),C),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#a?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#n=0)}#f(t){const i=this.#r.createElementNS($i,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#g(t){const i=this.#r.createElementNS($i,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#m(t){const i=this.#r.createElementNS($i,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#o.append(i),i}#u(t,i,n){const r=this.#r.createElementNS($i,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),t.append(r)}#p(t,i,n,r){const l=this.#r.createElementNS($i,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",i),this.#u(l,"feFuncB",n)}#y(t,i){const n=this.#r.createElementNS($i,"feComponentTransfer");i.append(n),this.#u(n,"feFuncA",t)}#v(t){return this.#o.style.color=t,fr(getComputedStyle(this.#o).getPropertyValue("color"))}}class Mg{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(n=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class Ym extends Mg{async _fetch(t){const i=await hr(t,"arraybuffer");return new Uint8Array(i)}}class Dg{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(n=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){qt("Abstract method `_fetch` called.")}}class Km extends Dg{async _fetch(t){const i=await hr(t,"arraybuffer");return new Uint8Array(i)}}Me&&gt("Please use the `legacy` build in Node.js environments.");async function uh(p){const i=await process.getBuiltinModule("fs").promises.readFile(p);return new Uint8Array(i)}class E0 extends Tg{}class C0 extends Eg{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class T0 extends Cg{async _fetch(t){return uh(t)}}class M0 extends Mg{async _fetch(t){return uh(t)}}class D0 extends Dg{async _fetch(t){return uh(t)}}const In="__forcedDependency",{floor:$m,ceil:Qm}=Math;function Pl(p,t,i,n,r,l){p[t*4+0]=Math.min(p[t*4+0],i),p[t*4+1]=Math.min(p[t*4+1],n),p[t*4+2]=Math.max(p[t*4+2],r),p[t*4+3]=Math.max(p[t*4+3],l)}const Wu=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class N0{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Wu}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Fl=(p,t)=>{if(!p)return;let i=p.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},p.set(t,i)),i};class R0{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[In]:[]};#s=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#n=[-1/0,-1/0,1/0,1/0];#l=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#o=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,i,n=!1){this.#f=t.width,this.#g=t.height,this.#y(i),n&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const n=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),i&&i.length>0?(this.#u.set(i),this.#u.fill(Wu,i.length)):this.#u.fill(Wu)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[In]:{__proto__:this.#e[In]}},this.#n={__proto__:this.#n},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#n=Object.getPrototypeOf(this.#n);const n=this.#i.pop();return n!==void 0&&(Fl(this.#p,t)?.dependencies.add(n),this.#u[t]=this.#u[n]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(Fl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(Fl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(rt.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#s.set(t,i),this}recordSimpleDataFromNamed(t,i,n){this.#t[t]=this.#s.get(i)??n}recordFutureForcedDependency(t,i){return this.recordIncrementalData(In,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#o)this.recordFutureForcedDependency(In,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#l[0]=1/0,this.#l[1]=1/0,this.#l[2]=-1/0,this.#l[3]=-1/0),this}recordClipBox(t,i,n,r,l,c){const u=rt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];rt.axialAlignedBoundingBox([n,l,r,c],u,h);const f=rt.intersect(this.#n,h);return f?(this.#n[0]=f[0],this.#n[1]=f[1],this.#n[2]=f[2],this.#n[3]=f[3]):(this.#n[0]=this.#n[1]=1/0,this.#n[2]=this.#n[3]=-1/0),this}recordBBox(t,i,n,r,l,c){const u=this.#n;if(u[0]===1/0)return this;const h=rt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return rt.axialAlignedBoundingBox([n,l,r,c],h,this.#l),this;const f=[1/0,1/0,-1/0,-1/0];return rt.axialAlignedBoundingBox([n,l,r,c],h,f),this.#l[0]=Math.min(this.#l[0],Math.max(f[0],u[0])),this.#l[1]=Math.min(this.#l[1],Math.max(f[1],u[1])),this.#l[2]=Math.max(this.#l[2],Math.min(f[2],u[2])),this.#l[3]=Math.max(this.#l[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,n,r=1,l=0,c=0,u){const h=n.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),f!==!1&&(g=[0,0,0,0],rt.axialAlignedBoundingBox(h,n.fontMatrix,g),(r!==1||l!==0||c!==0)&&rt.scaleMinMax([r,0,0,-r,l,c],g),f)))return this.recordBBox(t,i,g[0],g[2],g[1],g[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&g&&f===void 0&&(f=g[0]<=l-y.actualBoundingBoxLeft&&g[2]>=l+y.actualBoundingBoxRight&&g[1]<=c-y.actualBoundingBoxAscent&&g[3]>=c+y.actualBoundingBoxDescent,this.#h.set(n,f),f)?this.recordBBox(t,i,g[0],g[2],g[1],g[3]):this.recordBBox(t,i,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#l[0]=Math.max(0,this.#n[0]),this.#l[1]=Math.max(0,this.#n[1]),this.#l[2]=Math.min(this.#f,this.#n[2]),this.#l[3]=Math.min(this.#g,this.#n[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const n=this.#o,r=this.#t,l=this.#e;for(const c of i)c in this.#t?n.add(r[c]):c in l&&l[c].forEach(n.add,n);return this}recordNamedDependency(t,i){return this.#s.has(i)&&this.#o.add(this.#s.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[In]),this.#p){const n=Fl(this.#p,t),{dependencies:r}=n;this.#o.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),n.isRenderingOperation=!0}if(this.#c===t){const n=$m(this.#l[0]*256/this.#f),r=$m(this.#l[1]*256/this.#g),l=Qm(this.#l[2]*256/this.#f),c=Qm(this.#l[3]*256/this.#g);Pl(this.#m,t,n,r,l,c);for(const u of this.#o)u!==t&&Pl(this.#m,u,n,r,l,c);for(const u of this.#i)u!==t&&Pl(this.#m,u,n,r,l,c);for(const u of this.#r)u!==t&&Pl(this.#m,u,n,r,l,c);i||(this.#o.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const n=Array.from(this.#o);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of n)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#n[0]=Math.max(this.#n[0],this.#l[0]),this.#n[1]=Math.max(this.#n[1],this.#l[1]),this.#n[2]=Math.min(this.#n[2],this.#l[2]),this.#n[3]=Math.min(this.#n[3],this.#l[3]),i||this.#o.clear()),this}_takePendingDependencies(){const t=this.#o;return this.#o=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#o.add(i)}take(){return this.#h.clear(),new N0(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class $l{#t;#e;#s;#i=0;#r=0;constructor(t,i,n){if(t instanceof $l&&t.#s===!!n)return t;this.#t=t,this.#e=i,this.#s=!!n}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,n){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#s||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,n,r,l,c){return this.#s||this.#t.recordClipBox(this.#e,i,n,r,l,c),this}recordBBox(t,i,n,r,l,c){return this.#s||this.#t.recordBBox(this.#e,i,n,r,l,c),this}recordCharacterBBox(t,i,n,r,l,c,u){return this.#s||this.#t.recordCharacterBBox(this.#e,i,n,r,l,c,u),this}recordFullPageBBox(t){return this.#s||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#s||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const hi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},_e={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Zu(p,t){if(!t)return;const i=t[2]-t[0],n=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,n),p.clip(r)}class hh{isModifyingCurrentTransform(){return!1}getPattern(){qt("Abstract method `getPattern` called.")}}class O0 extends hh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)i.addColorStop(n[0],n[1]);return i}getPattern(t,i,n,r){let l;if(r===_e.STROKE||r===_e.FILL){const c=i.current.getClippedPathBoundingBox(r,Qt(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-c[0],-c[1]),n=rt.transform(n,[1,0,0,1,c[0],c[1]]),g.transform(...i.baseTransform),this.matrix&&g.transform(...this.matrix),Zu(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);l.setTransform(y)}else Zu(t,this._bbox),l=this._createGradient(t);return l}}function ju(p,t,i,n,r,l,c,u){const h=t.coords,f=t.colors,g=p.data,y=p.width*4;let b;h[i+1]>h[n+1]&&(b=i,i=n,n=b,b=l,l=c,c=b),h[n+1]>h[r+1]&&(b=n,n=r,r=b,b=c,c=u,u=b),h[i+1]>h[n+1]&&(b=i,i=n,n=b,b=l,l=c,c=b);const A=(h[i]+t.offsetX)*t.scaleX,x=(h[i+1]+t.offsetY)*t.scaleY,w=(h[n]+t.offsetX)*t.scaleX,C=(h[n+1]+t.offsetY)*t.scaleY,_=(h[r]+t.offsetX)*t.scaleX,M=(h[r+1]+t.offsetY)*t.scaleY;if(x>=M)return;const T=f[l],R=f[l+1],O=f[l+2],N=f[c],j=f[c+1],V=f[c+2],$=f[u],J=f[u+1],tt=f[u+2],it=Math.round(x),pt=Math.round(M);let ht,vt,B,G,Z,ft,St,k;for(let H=it;H<=pt;H++){if(H<C){const Q=H<x?0:(x-H)/(x-C);ht=A-(A-w)*Q,vt=T-(T-N)*Q,B=R-(R-j)*Q,G=O-(O-V)*Q}else{let Q;H>M?Q=1:C===M?Q=0:Q=(C-H)/(C-M),ht=w-(w-_)*Q,vt=N-(N-$)*Q,B=j-(j-J)*Q,G=V-(V-tt)*Q}let q;H<x?q=0:H>M?q=1:q=(x-H)/(x-M),Z=A-(A-_)*q,ft=T-(T-$)*q,St=R-(R-J)*q,k=O-(O-tt)*q;const W=Math.round(Math.min(ht,Z)),st=Math.round(Math.max(ht,Z));let ot=y*H+W*4;for(let Q=W;Q<=st;Q++)q=(ht-Q)/(ht-Z),q<0?q=0:q>1&&(q=1),g[ot++]=vt-(vt-ft)*q|0,g[ot++]=B-(B-St)*q|0,g[ot++]=G-(G-k)*q|0,g[ot++]=255}}function k0(p,t,i){const n=t.coords,r=t.colors;let l,c;switch(t.type){case qu.LATTICE:const u=t.verticesPerRow,h=Math.floor(n.length/u)-1,f=u-1;for(l=0;l<h;l++){let g=l*u;for(let y=0;y<f;y++,g++)ju(p,i,n[g],n[g+1],n[g+u],r[g],r[g+1],r[g+u]),ju(p,i,n[g+u+1],n[g+1],n[g+u],r[g+u+1],r[g+1],r[g+u])}break;case qu.TRIANGLES:for(l=0,c=n.length;l<c;l+=3)ju(p,i,n[l],n[l+1],n[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class L0 extends hh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,n){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),A=f/y,x=g/b,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/x},C=y+4,_=b+4,M=n.getCanvas("mesh",C,_),T=M.context,R=T.createImageData(y,b);if(i){const N=R.data;for(let j=0,V=N.length;j<V;j+=4)N[j]=i[0],N[j+1]=i[1],N[j+2]=i[2],N[j+3]=255}for(const N of this._figures)k0(R,N,w);return T.putImageData(R,2,2),{canvas:M.canvas,offsetX:u-2*A,offsetY:h-2*x,scaleX:A,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,i,n,r){Zu(t,this._bbox);const l=new Float32Array(2);if(r===_e.SHADING)rt.singularValueDecompose2dScale(Qt(t),l);else if(this.matrix){rt.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;rt.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=u,l[1]*=h}else rt.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,r===_e.SHADING?null:this._background,i.cachedCanvases);return r!==_e.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class B0 extends hh{getPattern(){return"hotpink"}}function j0(p){switch(p[0]){case"RadialAxial":return new O0(p);case"Mesh":return new L0(p);case"Dummy":return new B0}throw new Error(`Unknown IR type: ${p[0]}`)}const Wm={COLORED:1,UNCOLORED:2};class dh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,n,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:n,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),to("TilingType: "+c);const y=n[0],b=n[1],A=n[2],x=n[3],w=A-y,C=x-b,_=new Float32Array(2);rt.singularValueDecompose2dScale(this.matrix,_);const[M,T]=_;rt.singularValueDecompose2dScale(this.baseTransform,_);const R=M*_[0],O=T*_[1];let N=w,j=C,V=!1,$=!1;const J=Math.ceil(f*R),tt=Math.ceil(g*O),it=Math.ceil(w*R),pt=Math.ceil(C*O);J>=it?N=f:V=!0,tt>=pt?j=g:$=!0;const ht=this.getSizeAndScale(N,this.ctx.canvas.width,R),vt=this.getSizeAndScale(j,this.ctx.canvas.height,O),B=t.cachedCanvases.getCanvas("pattern",ht.size,vt.size),G=B.context,Z=h.createCanvasGraphics(G,i);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,l,u),G.translate(-ht.scale*y,-vt.scale*b),Z.transform(0,ht.scale,0,0,vt.scale,0,0),G.save(),Z.dependencyTracker?.save(),this.clipBbox(Z,y,b,A,x),Z.baseTransform=Qt(Z.ctx),Z.executeOperatorList(r),Z.endDrawing(),Z.dependencyTracker?.restore(),G.restore(),V||$){const ft=B.canvas;V&&(N=f),$&&(j=g);const St=this.getSizeAndScale(N,this.ctx.canvas.width,R),k=this.getSizeAndScale(j,this.ctx.canvas.height,O),H=St.size,q=k.size,W=t.cachedCanvases.getCanvas("pattern-workaround",H,q),st=W.context,ot=V?Math.floor(w/f):0,Q=$?Math.floor(C/g):0;for(let Nt=0;Nt<=ot;Nt++)for(let Rt=0;Rt<=Q;Rt++)st.drawImage(ft,H*Nt,q*Rt,H,q,0,0,H,q);return{canvas:W.canvas,scaleX:St.scale,scaleY:k.scale,offsetX:y,offsetY:b}}return{canvas:B.canvas,scaleX:ht.scale,scaleY:vt.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,i,n){const r=Math.max(dh.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*n);return l>=r?l=r:n=l/t,{scale:n,size:l}}clipBbox(t,i,n,r,l){const c=r-i,u=l-n;t.ctx.rect(i,n,c,u),rt.axialAlignedBoundingBox([i,n,r,l],Qt(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,n){const r=t.ctx,l=t.current;switch(i){case Wm.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case Wm.UNCOLORED:r.fillStyle=r.strokeStyle=n,l.fillColor=l.strokeColor=n;break;default:throw new $v(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,n,r,l){let c=n;r!==_e.SHADING&&(c=rt.transform(c,i.baseTransform),this.matrix&&(c=rt.transform(c,this.matrix)));const u=this.createPatternCanvas(i,l);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function z0({src:p,srcPos:t=0,dest:i,width:n,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=xe.isLittleEndian?4278190080:255,[h,f]=c?[l,u]:[u,l],g=n>>3,y=n&7,b=p.length;i=new Uint32Array(i.buffer);let A=0;for(let x=0;x<r;x++){for(const C=t+g;t<C;t++){const _=t<b?p[t]:255;i[A++]=_&128?f:h,i[A++]=_&64?f:h,i[A++]=_&32?f:h,i[A++]=_&16?f:h,i[A++]=_&8?f:h,i[A++]=_&4?f:h,i[A++]=_&2?f:h,i[A++]=_&1?f:h}if(y===0)continue;const w=t<b?p[t++]:255;for(let C=0;C<y;C++)i[A++]=w&1<<7-C?f:h}return{srcPos:t,destPos:A}}const Zm=16,Jm=100,P0=15,tg=10,Ue=16,zu=new DOMMatrix,Je=new Float32Array(2),Xn=new Float32Array([1/0,1/0,-1/0,-1/0]);function F0(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(i,n){t.translate(i,n),this.__originalTranslate(i,n)},p.scale=function(i,n){t.scale(i,n),this.__originalScale(i,n)},p.transform=function(i,n,r,l,c,u){t.transform(i,n,r,l,c,u),this.__originalTransform(i,n,r,l,c,u)},p.setTransform=function(i,n,r,l,c,u){t.setTransform(i,n,r,l,c,u),this.__originalSetTransform(i,n,r,l,c,u)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(i){t.rotate(i),this.__originalRotate(i)},p.clip=function(i){t.clip(i),this.__originalClip(i)},p.moveTo=function(i,n){t.moveTo(i,n),this.__originalMoveTo(i,n)},p.lineTo=function(i,n){t.lineTo(i,n),this.__originalLineTo(i,n)},p.bezierCurveTo=function(i,n,r,l,c,u){t.bezierCurveTo(i,n,r,l,c,u),this.__originalBezierCurveTo(i,n,r,l,c,u)},p.rect=function(i,n,r,l){t.rect(i,n,r,l),this.__originalRect(i,n,r,l)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class U0{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,n){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,n)):(r=this.canvasFactory.create(i,n),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function Ul(p,t,i,n,r,l,c,u,h,f){const[g,y,b,A,x,w]=Qt(p);if(y===0&&b===0){const M=c*g+x,T=Math.round(M),R=u*A+w,O=Math.round(R),N=(c+h)*g+x,j=Math.abs(Math.round(N)-T)||1,V=(u+f)*A+w,$=Math.abs(Math.round(V)-O)||1;return p.setTransform(Math.sign(g),0,0,Math.sign(A),T,O),p.drawImage(t,i,n,r,l,0,0,j,$),p.setTransform(g,y,b,A,x,w),[j,$]}if(g===0&&A===0){const M=u*b+x,T=Math.round(M),R=c*y+w,O=Math.round(R),N=(u+f)*b+x,j=Math.abs(Math.round(N)-T)||1,V=(c+h)*y+w,$=Math.abs(Math.round(V)-O)||1;return p.setTransform(0,Math.sign(y),Math.sign(b),0,T,O),p.drawImage(t,i,n,r,l,0,0,$,j),p.setTransform(g,y,b,A,x,w),[$,j]}p.drawImage(t,i,n,r,l,c,u,h,f);const C=Math.hypot(g,y),_=Math.hypot(b,A);return[C*h,_*f]}class eg{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Gu;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Se.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,n){n?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=Xn.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=_e.FILL,i=null){const n=this.minMax.slice();if(t===_e.STROKE){i||qt("Stroke bounding box must include transform."),rt.singularValueDecompose2dScale(i,Je);const r=Je[0]*this.lineWidth/2,l=Je[1]*this.lineWidth/2;n[0]-=r,n[1]-=l,n[2]+=r,n[3]+=l}return n}updateClipFromPath(){const t=rt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Xn,0)}getClippedPathBoundingBox(t=_e.FILL,i=null){return rt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function ig(p,t){if(t instanceof ImageData){p.putImageData(t,0,0);return}const i=t.height,n=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(n,Ue);let h=0,f;const g=t.data,y=u.data;let b,A,x,w;if(t.kind===ql.GRAYSCALE_1BPP){const C=g.byteLength,_=new Uint32Array(y.buffer,0,y.byteLength>>2),M=_.length,T=n+7>>3,R=4294967295,O=xe.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(x=b<l?Ue:r,f=0,A=0;A<x;A++){const N=C-h;let j=0;const V=N>T?n:N*8-7,$=V&-8;let J=0,tt=0;for(;j<$;j+=8)tt=g[h++],_[f++]=tt&128?R:O,_[f++]=tt&64?R:O,_[f++]=tt&32?R:O,_[f++]=tt&16?R:O,_[f++]=tt&8?R:O,_[f++]=tt&4?R:O,_[f++]=tt&2?R:O,_[f++]=tt&1?R:O;for(;j<V;j++)J===0&&(tt=g[h++],J=128),_[f++]=tt&J?R:O,J>>=1}for(;f<M;)_[f++]=0;p.putImageData(u,0,b*Ue)}}else if(t.kind===ql.RGBA_32BPP){for(A=0,w=n*Ue*4,b=0;b<l;b++)y.set(g.subarray(h,h+w)),h+=w,p.putImageData(u,0,A),A+=Ue;b<c&&(w=n*r*4,y.set(g.subarray(h,h+w)),p.putImageData(u,0,A))}else if(t.kind===ql.RGB_24BPP)for(x=Ue,w=n*x,b=0;b<c;b++){for(b>=l&&(x=r,w=n*x),f=0,A=w;A--;)y[f++]=g[h++],y[f++]=g[h++],y[f++]=g[h++],y[f++]=255;p.putImageData(u,0,b*Ue)}else throw new Error(`bad image kind: ${t.kind}`)}function sg(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const i=t.height,n=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(n,Ue);let h=0;const f=t.data,g=u.data;for(let y=0;y<c;y++){const b=y<l?Ue:r;({srcPos:h}=z0({src:f,srcPos:h,dest:g,width:n,height:b,nonBlackColor:0})),p.putImageData(u,0,y*Ue)}}function Qa(p,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of i)p[n]!==void 0&&(t[n]=p[n]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function Il(p){p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0);const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}function ng(p,t){if(t)return!0;rt.singularValueDecompose2dScale(p,Je);const i=Math.fround(Di.pixelRatio*Jn.PDF_TO_CSS_UNITS);return Je[0]<=i&&Je[1]<=i}const I0=["butt","round","square"],H0=["miter","round","bevel"],G0={},ag={};class Qn{constructor(t,i,n,r,l,{optionalContentConfig:c,markedContentStack:u=null},h,f,g){this.ctx=t,this.current=new eg(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=n,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new U0(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,i,n=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):n}beginDrawing({transform:t,viewport:i,transparency:n=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,n){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Qt(this.compositeCtx))}this.ctx.save(),Il(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=Qt(this.ctx)}executeOperatorList(t,i,n,r,l){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const g=f-h>tg&&typeof n=="function",y=g?Date.now()+P0:0;let b=0;const A=this.commonObjs,x=this.objs;let w,C;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,n),h;if(!l||l(h))if(w=u[h],C=c[h]??null,w!==rr.dependency)C===null?this[w](h):this[w](h,...C);else for(const _ of C){this.dependencyTracker?.recordNamedData(_,h);const M=_.startsWith("g_")?A:x;if(!M.has(_))return M.get(_,n),h}if(h++,h===f)return h;if(g&&++b>tg){if(Date.now()>y)return n(),h;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const n=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=n,h=r,f="prescale1",g,y;for(;l>2&&u>1||c>2&&h>1;){let b=u,A=h;l>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/b),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),g=this.cachedCanvases.getCanvas(f,b,A),y=g.context,y.clearRect(0,0,b,A),y.drawImage(t,0,0,u,h,0,0,b,A),t=g.canvas,u=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const n=this.ctx,{width:r,height:l}=i,c=this.current.fillColor,u=this.current.patternFill,h=Qt(n);let f,g,y,b;if((i.bitmap||i.data)&&i.count>1){const J=i.bitmap||i.data.buffer;g=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const tt=f.get(g);if(tt&&!u){const it=Math.round(Math.min(h[0],h[2])+h[4]),pt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,hi.transformAndFill),{canvas:tt,offsetX:it,offsetY:pt}}y=tt}y||(b=this.cachedCanvases.getCanvas("maskCanvas",r,l),sg(b.context,i));let A=rt.transform(h,[1/r,0,0,-1/l,0,0]);A=rt.transform(A,[1,0,0,1,0,-l]);const x=Xn.slice();rt.axialAlignedBoundingBox([0,0,r,l],A,x);const[w,C,_,M]=x,T=Math.round(_-w)||1,R=Math.round(M-C)||1,O=this.cachedCanvases.getCanvas("fillCanvas",T,R),N=O.context,j=w,V=C;N.translate(-j,-V),N.transform(...A),y||(y=this._scaleImage(b.canvas,Ei(N)),y=y.img,f&&u&&f.set(g,y)),N.imageSmoothingEnabled=ng(Qt(N),i.interpolate),Ul(N,y,0,0,y.width,y.height,0,0,r,l),N.globalCompositeOperation="source-in";const $=rt.transform(Ei(N),[1,0,0,1,-j,-V]);return N.fillStyle=u?c.getPattern(n,this,$,_e.FILL,t):c,N.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),this.dependencyTracker?.recordDependencies(t,hi.transformAndFill),{canvas:O.canvas,offsetX:Math.round(j),offsetY:Math.round(V)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=I0[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=H0[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,n){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=n)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[n,r]of i)switch(n){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,i,n);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Qa(this.suspendedCtx,c),F0(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qa(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,n,r){const l=r[0],c=r[1],u=r[2]-l,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,n,u,h,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,i,n,r,l,c,u,h,f,g,y){let b=t.canvas,A=h-g,x=f-y;if(c)if(A<0||x<0||A+n>b.width||x+r>b.height){const C=this.cachedCanvases.getCanvas("maskExtension",n,r),_=C.context;_.drawImage(b,-A,-x),_.globalCompositeOperation="destination-atop",_.fillStyle=c,_.fillRect(0,0,n,r),_.globalCompositeOperation="source-over",b=C.canvas,A=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,x,n,r),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,x,n,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(h,f,n,r),i.clip(w),i.globalCompositeOperation="destination-in",i.drawImage(b,A,x,n,r,h,f,n,r),i.restore()}save(t){this.inSMaskMode&&Qa(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Qa(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,n,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,n,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,n,r){let[l]=n;if(!r){l||=n[0]=new Path2D,this[i](t,l);return}if(this.dependencyTracker!==null){const c=i===rr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=n[0]=Sg(l)),rt.axialAlignedBoundingBox(r,Qt(this.ctx),this.current.minMax),this[i](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,n=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,Ei(r),_e.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,hi.stroke),n&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(_e.STROKE,Qt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,n=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,Ei(r),_e.FILL,t),f){const g=new Path2D;g.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=g}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,hi.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,hi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=G0}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ag}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,l=n.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:g}of i)g&&r.addPath(g,new DOMMatrix(c).preMultiplySelf(l).translate(u,h).scale(f,-f));n.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,n){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),l=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(l.fontMatrix=r.fontMatrix||Gu,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&gt("Invalid font matrix for font "+i),n<0?(n=-n,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let g=n;n<Zm?g=Zm:n>Jm&&(g=Jm),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${h} ${g}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,i,n){this.setLeading(t,-n),this.moveText(t,i,n)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=i,n.textMatrixScale=Math.hypot(i[0],i[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#s(t,i,n){const r=new Path2D;return r.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(i)),r}paintChar(t,i,n,r,l,c){const u=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=g&Se.FILL_STROKE_MASK,A=!!(g&Se.ADD_TO_PATH_FLAG),x=h.patternFill&&!f.missingFile,w=h.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||A||x||w)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,i)),C&&(f.disableFontFace||x||w)){u.save(),u.translate(n,r),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let _;if(b===Se.FILL||b===Se.FILL_STROKE)if(l){_=u.getTransform(),u.setTransform(...l);const M=this.#s(C,_,l);u.fill(M)}else u.fill(C);if(b===Se.STROKE||b===Se.FILL_STROKE)if(c){_||=u.getTransform(),u.setTransform(...c);const{a:M,b:T,c:R,d:O}=_,N=rt.inverseTransform(c),j=rt.transform([M,T,R,O,0,0],N);rt.singularValueDecompose2dScale(j,Je),u.lineWidth*=Math.max(Je[0],Je[1])/y,u.stroke(this.#s(C,_,c))}else u.lineWidth/=y,u.stroke(C);u.restore()}else(b===Se.FILL||b===Se.FILL_STROKE)&&(u.fillText(i,n,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,r,()=>u.measureText(i))),(b===Se.STROKE||b===Se.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,r,()=>u.measureText(i)).recordDependencies(t,hi.stroke),u.strokeText(i,n,r));A&&((this.pendingTextPaths||=[]).push({transform:Qt(u),x:n,y:r,fontSize:y,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,n,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){n=!0;break}return yt(this,"isFontSubpixelAAEnabled",n)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,hi.showText).resetBBox(t),this.current.textRenderingMode&Se.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const l=n.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,y=n.textHScale*g,b=i.length,A=r.vertical,x=A?1:-1,w=r.defaultVMetrics,C=l*n.fontMatrix[0],_=n.textRenderingMode===Se.FILL&&!r.disableFontFace&&!n.patternFill;c.save(),n.textMatrix&&c.transform(...n.textMatrix),c.translate(n.x,n.y+n.textRise),g>0?c.scale(y,-1):c.scale(y,1);let M,T;if(n.patternFill){c.save();const V=n.fillColor.getPattern(c,this,Ei(c),_e.FILL,t);M=Qt(c),c.restore(),c.fillStyle=V}if(n.patternStroke){c.save();const V=n.strokeColor.getPattern(c,this,Ei(c),_e.STROKE,t);T=Qt(c),c.restore(),c.strokeStyle=V}let R=n.lineWidth;const O=n.textMatrixScale;if(O===0||R===0){const V=n.textRenderingMode&Se.FILL_STROKE_MASK;(V===Se.STROKE||V===Se.FILL_STROKE)&&(R=this.getSinglePixelWidth())}else R/=O;if(u!==1&&(c.scale(u,u),R/=u),c.lineWidth=R,r.isInvalidPDFjsFont){const V=[];let $=0;for(const tt of i)V.push(tt.unicode),$+=tt.width;const J=V.join("");if(c.fillText(J,0,0),this.dependencyTracker!==null){const tt=c.measureText(J);this.dependencyTracker.recordBBox(t,this.ctx,-tt.actualBoundingBoxLeft,tt.actualBoundingBoxRight,-tt.actualBoundingBoxAscent,tt.actualBoundingBoxDescent).recordShowTextOperation(t)}n.x+=$*C*y,c.restore(),this.compose();return}let N=0,j;for(j=0;j<b;++j){const V=i[j];if(typeof V=="number"){N+=x*V*l/1e3;continue}let $=!1;const J=(V.isSpace?f:0)+h,tt=V.fontChar,it=V.accent;let pt,ht,vt=V.width;if(A){const Z=V.vmetric||w,ft=-(V.vmetric?Z[1]:vt*.5)*C,St=Z[2]*C;vt=Z?-Z[0]:vt,pt=ft/u,ht=(N+St)/u}else pt=N/u,ht=0;let B;if(r.remeasure&&vt>0){B=c.measureText(tt);const Z=B.width*1e3/l*u;if(vt<Z&&this.isFontSubpixelAAEnabled){const ft=vt/Z;$=!0,c.save(),c.scale(ft,1),pt/=ft}else vt!==Z&&(pt+=(vt-Z)/2e3*l/u)}if(this.contentVisible&&(V.isInFont||r.missingFile)){if(_&&!it)c.fillText(tt,pt,ht),this.dependencyTracker?.recordCharacterBBox(t,c,B?{bbox:null}:r,l/u,pt,ht,()=>B??c.measureText(tt));else if(this.paintChar(t,tt,pt,ht,M,T),it){const Z=pt+l*it.offset.x/u,ft=ht-l*it.offset.y/u;this.paintChar(t,it.fontChar,Z,ft,M,T)}}const G=A?vt*C-J*g:vt*C+J*g;N+=G,$&&c.restore()}A?n.y-=N:n.x+=N*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const n=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,h=l.vertical?1:-1,f=r.charSpacing,g=r.wordSpacing,y=r.textHScale*u,b=r.fontMatrix||Gu,A=i.length,x=r.textRenderingMode===Se.INVISIBLE;let w,C,_,M;if(x||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(y,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new $l(T,t):null,w=0;w<A;++w){if(C=i[w],typeof C=="number"){M=h*C*c/1e3,this.ctx.translate(M,0),r.x+=M*y;continue}const R=(C.isSpace?g:0)+f,O=l.charProcOperatorList[C.operatorListId];O?this.contentVisible&&(this.save(),n.scale(c,c),n.transform(...b),this.executeOperatorList(O),this.restore()):gt(`Type3 character "${C.operatorListId}" is not available.`);const N=[C.width,0];rt.applyTransform(N,b),_=N[0]*c+R,n.translate(_,0),r.x+=_*y}n.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,i,n){}setCharWidthAndBounds(t,i,n,r,l,c,u){const h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,i){let n;if(i[0]==="TilingPattern"){const r=this.baseTransform||Qt(this.ctx),l={createCanvasGraphics:(c,u)=>new Qn(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new $l(this.dependencyTracker,u,!0):null)};n=new dh(i,this.ctx,l,r)}else n=this._getPattern(t,i[1],i[2]);return n}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,n=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=j0(this.getObject(t,i)),this.cachedPatterns.set(i,r)),n&&(r.matrix=n),r}shadingFill(t,i){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const r=this._getPattern(t,i);n.fillStyle=r.getPattern(n,this,Ei(n),_e.SHADING,t);const l=Ei(n);if(l){const{width:c,height:u}=n.canvas,h=Xn.slice();rt.axialAlignedBoundingBox([0,0,c,u],l,h);const[f,g,y,b]=h;this.ctx.fillRect(f,g,y-f,b-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,hi.transform).recordDependencies(t,hi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){qt("Should not call beginInlineImage")}beginImageData(){qt("Should not call beginImageData")}paintFormXObjectBegin(t,i,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=Qt(this.ctx),n)){rt.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[r,l,c,u]=n,h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||to("TODO: Support non-isolated groups."),i.knockout&&gt("Knockout groups not supported.");const r=Qt(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let l=Xn.slice();rt.axialAlignedBoundingBox(i.bbox,Qt(n),l);const c=[0,0,n.canvas.width,n.canvas.height];l=rt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),h=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),g=Math.max(Math.ceil(l[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let y="groupAt"+this.groupLevel;i.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,g),A=b.context;A.translate(-u,-h),A.transform(...r);let x=new Path2D;const[w,C,_,M]=i.bbox;if(x.rect(w,C,_-w,M-C),i.matrix){const T=new Path2D;T.addPath(x,new DOMMatrix(i.matrix)),x=T}A.clip(x),i.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(u,h),n.save()),Qa(n,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Qt(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=Xn.slice();rt.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],l,c),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,n,r,l,c){if(this.#t(),Il(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const u=n[2]-n[0],h=n[3]-n[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=u,n[3]=h,rt.singularValueDecompose2dScale(Qt(this.ctx),Je);const{viewportScale:f}=this,g=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Je[0],0,0,-Je[1],0,h*Je[1]),Il(this.ctx)}else{Il(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],u,h),this.ctx.clip(f)}}this.current=new eg(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(t,i.data,i),i.count=n;const r=this.ctx,l=this._createMaskCanvas(t,i),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,n,r=0,l=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=Qt(h);h.transform(n,r,l,c,0,0);const g=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const A=rt.transform(f,[n,r,l,c,u[y],u[y+1]]);h.drawImage(g.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+g.canvas.width,A[5],A[5]+g.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,hi.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:g}=c,y=this.cachedCanvases.getCanvas("maskCanvas",h,f),b=y.context;b.save();const A=this.getObject(t,u,c);sg(b,A),b.globalCompositeOperation="source-in",b.fillStyle=l?r.getPattern(b,this,Ei(n),_e.FILL,t):r,b.fillRect(0,0,h,f),b.restore(),n.save(),n.transform(...g),n.scale(1,-1),Ul(n,y.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const n=this.getObject(t,i);if(!n){gt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,i,n,r,l){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){gt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let g=0,y=l.length;g<y;g+=2)f.push({transform:[n,0,0,r,l[g],l[g+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:n,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",n,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const n=i.width,r=i.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/n,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const g=this.cachedCanvases.getCanvas("inlineImage",n,r).context;ig(g,i),u=this.applyTransferMapsToCanvas(g)}const h=this._scaleImage(u,Ei(l));l.imageSmoothingEnabled=ng(Qt(l),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,n,-r,0).recordDependencies(t,hi.imageXObject).recordOperation(t),Ul(l,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,n,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,n){if(!this.contentVisible)return;const r=this.ctx;let l;if(i.bitmap)l=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;ig(f,i),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of n)r.save(),r.transform(...c.transform),r.scale(1,-1),Ul(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,hi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,n){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,n){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,n){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===ag?l.clip(i,"evenodd"):l.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Qt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:n,c:r,d:l}=this.ctx.getTransform();let c,u;if(n===0&&r===0){const h=Math.abs(i),f=Math.abs(l);if(h===f)if(t===0)c=u=1/h;else{const g=h*t;c=u=g<1?1/g:1}else if(t===0)c=1/h,u=1/f;else{const g=h*t,y=f*t;c=g<1?1/g:1,u=y<1?1/y:1}}else{const h=Math.abs(i*l-n*r),f=Math.hypot(i,n),g=Math.hypot(r,l);if(t===0)c=g/h,u=f/h;else{const y=t*h;c=g>y?g/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:n,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){n.lineWidth=(r||1)*l,n.stroke(t);return}const u=n.getLineDash();i&&n.save(),n.scale(l,c),zu.a=1/l,zu.d=1/c;const h=new Path2D;if(h.addPath(t,zu),u.length>0){const f=Math.max(l,c);n.setLineDash(u.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=r||1,n.stroke(h),i&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const p in rr)Qn.prototype[p]!==void 0&&(Qn.prototype[rr[p]]=Qn.prototype[p]);class Wn{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class q0{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Gn=Symbol("INTERNAL");class V0{#t=!1;#e=!1;#s=!1;#i=!0;constructor(t,{name:i,intent:n,usage:r,rbGroups:l}){this.#t=!!(t&Ze.DISPLAY),this.#e=!!(t&Ze.PRINT),this.name=i,this.intent=n,this.usage=r,this.rbGroups=l}get visible(){if(this.#s)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,n=!1){t!==Gn&&qt("Internal method `_setVisible` called."),this.#s=n,this.#i=i}}class X0{#t=null;#e=new Map;#s=null;#i=null;constructor(t,i=Ze.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const n of t.groups)this.#e.set(n.id,new V0(i,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(Gn,!1);for(const n of t.on)this.#e.get(n)._setVisible(Gn,!0);for(const n of t.off)this.#e.get(n)._setVisible(Gn,!1);this.#s=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const n=t[0];for(let r=1;r<i;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return gt(`Optional content group not found: ${l}`),!0;switch(n){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return to("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(gt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return gt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return gt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return gt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return gt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return gt(`Unknown optional content policy ${t.policy}.`),!0}return gt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,n=!0){const r=this.#e.get(t);if(!r){gt(`Optional content group not found: ${t}`);return}if(n&&i&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(Gn,!1,!0);r._setVisible(Gn,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let n;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const l=this.#e.get(r);if(l)switch(n){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!l.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new _g;for(const[i,n]of this.#e)t.update(`${i}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Y0{constructor(t,{disableRange:i=!1,disableStream:n=!1}){Dt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const n=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(n),!0)});Dt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Dt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new K0(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new $0(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class K0{constructor(t,i,n=!1,r=null){this._stream=t,this._done=n||!1,this._filename=rh(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class $0{constructor(t,i,n){this._stream=t,this._begin=i,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Q0(p){let t=!0,i=n("filename\\*","i").exec(p);if(i){i=i[1];let g=u(i);return g=unescape(g),g=h(g),g=f(g),l(g)}if(i=c(p),i){const g=f(i);return l(g)}if(i=n("filename","i").exec(p),i){i=i[1];let g=u(i);return g=f(g),l(g)}function n(g,y){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(g,y){if(g){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(g,{fatal:!0}),A=ur(y);y=b.decode(A),t=!1}catch{}}return y}function l(g){return t&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),t&&(g=r("iso-8859-1",g))),g}function c(g){const y=[];let b;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(g))!==null;){let[,w,C,_]=b;if(w=parseInt(w,10),w in y){if(w===0)break;continue}y[w]=[C,_]}const x=[];for(let w=0;w<y.length&&w in y;++w){let[C,_]=y[w];_=u(_),C&&(_=unescape(_),w===0&&(_=h(_))),x.push(_)}return x.join("")}function u(g){if(g.startsWith('"')){const y=g.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}g=y.join('"')}return g}function h(g){const y=g.indexOf("'");if(y===-1)return g;const b=g.slice(0,y),x=g.slice(y+1).replace(/^[^']*'/,"");return r(b,x)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,x){if(A==="q"||A==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,C){return String.fromCharCode(parseInt(C,16))}),r(b,x);try{x=atob(x)}catch{}return r(b,x)})}return""}function Ng(p,t){const i=new Headers;if(!p||!t||typeof t!="object")return i;for(const n in t){const r=t[n];r!==void 0&&i.append(n,r)}return i}function so(p){return URL.parse(p)?.origin??null}function Rg({responseHeaders:p,isHttp:t,rangeChunkSize:i,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(p.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*i)||n||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Og(p){const t=p.get("Content-Disposition");if(t){let i=Q0(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(rh(i))return i}return null}function mr(p,t){return new Kl(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p,p===404||p===0&&t.startsWith("file:"))}function kg(p){return p===200||p===206}function Lg(p,t,i){return{method:"GET",headers:p,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Bg(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(gt(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class W0{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Ng(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Z0(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new J0(this,t,i);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Z0{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const n=new Headers(t.headers),r=i.url;fetch(r,Lg(n,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=so(l.url),!kg(l.status))throw mr(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=Rg({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Og(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Cs("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Bg(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class J0{constructor(t,i,n){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${n-1}`);const c=r.url;fetch(c,Lg(l,this._withCredentials,this._abortController)).then(u=>{const h=so(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!kg(u.status))throw mr(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Bg(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Pu=200,Fu=206;function tA(p){const t=p.response;return typeof t!="string"?t:ur(t).buffer}class eA{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Ng(this.isHttp,i),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=Fu):r.expectedStatus=Pu,i.responseType="arraybuffer",Dt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,n),i.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),n}onProgress(t,i){const n=this.pendingRequests[t];n&&n.onProgress?.(i)}onStateChange(t,i){const n=this.pendingRequests[t];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){n.onError(r.status);return}const l=r.status||Pu;if(!(l===Pu&&n.expectedStatus===Fu)&&l!==n.expectedStatus){n.onError(r.status);return}const u=tA(r);if(l===Fu){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:u}):(gt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class iA{constructor(t){this._source=t,this._manager=new eA(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Dt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sA(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const n=new nA(this._manager,t,i);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class sA{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=so(i.responseURL);const n=i.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=Rg({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=Og(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=mr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class nA{constructor(t,i,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=so(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=mr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const aA=/^[a-z][a-z0-9\-+.]+:/i;function rA(p){if(aA.test(p))return new URL(p);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(p))}class lA{constructor(t){this.source=t,this.url=rA(t.url),Dt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new oA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new cA(this,t,i);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class oA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=mr(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Cs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class cA{constructor(t,i,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Wa=Symbol("INITIAL_DATA");class jg{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Wa}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const n=this.#t[t];if(!n||n.data===Wa)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const i=this.#t[t];return!!i&&i.data!==Wa}delete(t){const i=this.#t[t];return!i||i.data===Wa?!1:(delete this.#t[t],!0)}resolve(t,i=null){const n=this.#e(t);n.data=i,n.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==Wa&&(yield[t,i])}}}const uA=1e5,rg=30;class Te{#t=Promise.withResolvers();#e=null;#s=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#n=0;#l=0;#c=null;#o=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#_=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:n}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#o=i,this.#h=n.scale*Di.pixelRatio,this.#d=n.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=n.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#l=r,this.#n=l,Te.#D(),Zs(i,n),this.#t.promise.finally(()=>{Te.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=xe.platform;return yt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:n})=>{if(n){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#T(i.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),Te.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const n=t.scale*Di.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,Zs(this.#o,{rotation:r})),n!==this.#h){i?.(),this.#h=n;const l={div:null,properties:null,ctx:Te.#N(this.#r)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#x(l)}}cancel(){const t=new Cs("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#T(t){if(this.#s)return;this.#a.ctx??=Te.#N(this.#r);const i=this.#u,n=this.#g;for(const r of t){if(i.length>uA){gt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=rt.transform(this.#y,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=Te.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*Te.#z(u,c,this.#r);let g,y;l===0?(g=r[4],y=r[5]-f):(g=r[4]+f*Math.sin(l),y=r[5]-f*Math.cos(l));const b="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#o?(A.left=`${(100*g/this.#l).toFixed(2)}%`,A.top=`${(100*y/this.#n).toFixed(2)}%`):(A.left=`${b}${g.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(Te.#_*h).toFixed(2)}px)`,A.fontFamily=u,n.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(n.angle=l*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),C=Math.abs(t.transform[3]);w!==C&&Math.max(w,C)/Math.min(w,C)>1.5&&(x=!0)}if(x&&(n.canvasWidth=c.vertical?t.height:t.width),this.#p.set(i,n),this.#a.div=i,this.#a.properties=n,this.#x(this.#a),n.hasText&&this.#e.append(i),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#x(t){const{div:i,properties:n,ctx:r}=t,{style:l}=i;let c="";if(Te.#_>1&&(c=`scale(${1/Te.#_})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:f}=n;Te.#M(r,f*this.#h,u);const{width:g}=r.measureText(i.textContent);g>0&&(c=`scaleX(${h*this.#h/g}) ${c}`)}n.angle!==0&&(c=`rotate(${n.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#N(t=null){let i=this.#b.get(t||="");if(!i){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),i=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#M(t,i,n){const r=this.#E.get(t);i===r.size&&n===r.family||(t.font=`${i}px ${n}`,r.size=i,r.family=n)}static#D(){if(this.#_!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#_=t.getBoundingClientRect().height,t.remove()}static#z(t,i,n){const r=this.#v.get(t);if(r)return r;const l=this.#N(n);l.canvas.width=l.canvas.height=rg,this.#M(l,rg,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+h):(xe.platform.isFirefox&&gt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const hA=100;function zg(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new fh,{docId:i}=t,n=p.url?b0(p.url):null,r=p.data?v0(p.data):null,l=p.httpHeaders||null,c=p.withCredentials===!0,u=p.password??null,h=p.range instanceof Pg?p.range:null,f=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:2**16;let g=p.worker instanceof or?p.worker:null;const y=p.verbosity,b=typeof p.docBaseUrl=="string"&&!eo(p.docBaseUrl)?p.docBaseUrl:null,A=jl(p.cMapUrl),x=p.cMapPacked!==!1,w=p.CMapReaderFactory||(Me?T0:Xm),C=jl(p.iccUrl),_=jl(p.standardFontDataUrl),M=p.StandardFontDataFactory||(Me?M0:Ym),T=jl(p.wasmUrl),R=p.WasmFactory||(Me?D0:Km),O=p.stopAtErrors!==!0,N=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,j=p.isEvalSupported!==!1,V=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!Me,$=typeof p.isImageDecoderSupported=="boolean"?p.isImageDecoderSupported:!Me&&(xe.platform.isFirefox||!globalThis.chrome),J=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,tt=typeof p.disableFontFace=="boolean"?p.disableFontFace:Me,it=p.fontExtraProperties===!0,pt=p.enableXfa===!0,ht=p.ownerDocument||globalThis.document,vt=p.disableRange===!0,B=p.disableStream===!0,G=p.disableAutoFetch===!0,Z=p.pdfBug===!0,ft=p.CanvasFactory||(Me?C0:_0),St=p.FilterFactory||(Me?E0:x0),k=p.enableHWA===!0,H=p.useWasm!==!1,q=h?h.length:p.length??NaN,W=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!Me&&!tt,st=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:!!(w===Xm&&M===Ym&&R===Km&&A&&_&&T&&er(A,document.baseURI)&&er(_,document.baseURI)&&er(T,document.baseURI)),ot=null;Xv(y);const Q={canvasFactory:new ft({ownerDocument:ht,enableHWA:k}),filterFactory:new St({docId:i,ownerDocument:ht}),cMapReaderFactory:st?null:new w({baseUrl:A,isCompressed:x}),standardFontDataFactory:st?null:new M({baseUrl:_}),wasmFactory:st?null:new R({baseUrl:T})};g||(g=or.create({verbosity:y,port:Wn.workerPort}),t._worker=g);const Nt={docId:i,apiVersion:"5.4.449",data:r,password:u,disableAutoFetch:G,rangeChunkSize:f,length:q,docBaseUrl:b,enableXfa:pt,evaluatorOptions:{maxImageSize:N,disableFontFace:tt,ignoreErrors:O,isEvalSupported:j,isOffscreenCanvasSupported:V,isImageDecoderSupported:$,canvasMaxAreaInBytes:J,fontExtraProperties:it,useSystemFonts:W,useWasm:H,useWorkerFetch:st,cMapUrl:A,iccUrl:C,standardFontDataUrl:_,wasmUrl:T}},Rt={ownerDocument:ht,pdfBug:Z,styleElement:ot,loadingParams:{disableAutoFetch:G,enableXfa:pt}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Ms=g.messageHandler.sendWithPromise("GetDocRequest",Nt,r?[r.buffer]:null);let Zi;if(h)Zi=new Y0(h,{disableRange:vt,disableStream:B});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Ds=er(n)?W0:Me?lA:iA;Zi=new Ds({url:n,length:q,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:vt,disableStream:B})}return Ms.then(Ds=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ta=new ir(i,Ds,g.port),Ni=new pA(ta,t,Zi,Rt,Q,k);t._transport=Ni,ta.send("Ready",null)})}).catch(t._capability.reject),t}class fh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${fh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Pg{#t=Promise.withResolvers();#e=[];#s=[];#i=[];#r=[];constructor(t,i,n=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#s.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const n of this.#r)n(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const n of this.#i)n(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#s)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){qt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class dA{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class fA{#t=!1;constructor(t,i,n,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=n,this._stats=r?new Fm:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new jg,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:l=!1}={}){return new dr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:n,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return yt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:n,intent:r="display",annotationMode:l=xs.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:x=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(r,l,y,b),{renderingIntent:C,cacheKey:_}=w;this.#t=!1,h||=this._transport.getOptionalContentConfig(C);let M=this._intentStates.get(_);M||(M=Object.create(null),this._intentStates.set(_,M)),M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null);const T=!!(C&Ze.PRINT);M.displayReadyCapability||(M.displayReadyCapability=Promise.withResolvers(),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const R=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(A||R),N=$=>{if(M.renderTasks.delete(j),O){const J=j.gfx?.dependencyTracker.take();J&&(j.stepper&&j.stepper.setOperatorBBoxes(J,j.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=J))}T&&(this.#t=!0),this.#e(),$?(j.capability.reject($),this._abortOperatorList({intentState:M,reason:$ instanceof Error?$:new Error($)})):j.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},j=new Yn({callback:N,params:{canvas:i,canvasContext:t,dependencyTracker:O?new R0(i,M.operatorList.length,R):null,viewport:n,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:M.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:x});(M.renderTasks||=new Set).add(j);const V=j.task;return Promise.all([M.displayReadyCapability.promise,h]).then(([$,J])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(J.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");j.initializeGraphics({transparency:$,optionalContentConfig:J}),j.operatorListChanged()}).catch(N),V}getOperatorList({intent:t="display",annotationMode:i=xs.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,n,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>lr.textContent(n));const i=this.streamTextContent(t);return new Promise(function(n,r){function l(){c.read().then(function({value:h,done:f}){if(f){n(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const n of i.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Fm),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const n=this._intentStates.get(i);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let n=0,r=t.length;n<r;n++)i.operatorList.fnArray.push(t.fnArray[n]),i.operatorList.argsArray.push(t.argsArray[n]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const n of i.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:n,modifiedIds:r}){const{map:l,transfer:c}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const g=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),g())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};g()}_abortOperatorList({intentState:t,reason:i,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(i instanceof ah){let r=hA;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new Cs(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var Es,bi,Wi,$s,Wl,Qs,Ws,Ne,Vl,Fg,Ug,sr,Zn,Xl;const $t=class $t{constructor({name:t=null,port:i=null,verbosity:n=Yv()}={}){_i(this,Ne);_i(this,Es,Promise.withResolvers());_i(this,bi,null);_i(this,Wi,null);_i(this,$s,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,i){if(Kt($t,Ws).has(i))throw new Error("Cannot use more than one PDFWorker per port.");Kt($t,Ws).set(i,this),xi(this,Ne,Fg).call(this,i)}else xi(this,Ne,Ug).call(this)}get promise(){return Kt(this,Es).promise}get port(){return Kt(this,Wi)}get messageHandler(){return Kt(this,bi)}destroy(){this.destroyed=!0,Kt(this,$s)?.terminate(),Pe(this,$s,null),Kt($t,Ws).delete(Kt(this,Wi)),Pe(this,Wi,null),Kt(this,bi)?.destroy(),Pe(this,bi,null)}static create(t){const i=Kt(this,Ws).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new $t(t)}static get workerSrc(){if(Wn.workerSrc)return Wn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return yt(this,"_setupFakeWorkerGlobal",(async()=>Kt(this,Zn,Xl)?Kt(this,Zn,Xl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Es=new WeakMap,bi=new WeakMap,Wi=new WeakMap,$s=new WeakMap,Wl=new WeakMap,Qs=new WeakMap,Ws=new WeakMap,Ne=new WeakSet,Vl=function(){Kt(this,Es).resolve(),Kt(this,bi).send("configure",{verbosity:this.verbosity})},Fg=function(t){Pe(this,Wi,t),Pe(this,bi,new ir("main","worker",t)),Kt(this,bi).on("ready",()=>{}),xi(this,Ne,Vl).call(this)},Ug=function(){if(Kt($t,Qs)||Kt($t,Zn,Xl)){xi(this,Ne,sr).call(this);return}let{workerSrc:t}=$t;try{$t._isSameOrigin(window.location,t)||(t=$t._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),n=new ir("main","worker",i),r=()=>{l.abort(),n.destroy(),i.terminate(),this.destroyed?Kt(this,Es).reject(new Error("Worker was destroyed")):xi(this,Ne,sr).call(this)},l=new AbortController;i.addEventListener("error",()=>{Kt(this,$s)||r()},{signal:l.signal}),n.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}Pe(this,bi,n),Pe(this,Wi,i),Pe(this,$s,i),xi(this,Ne,Vl).call(this)}),n.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{xi(this,Ne,sr).call(this)}});const c=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};c();return}catch{to("The worker has been disabled.")}xi(this,Ne,sr).call(this)},sr=function(){Kt($t,Qs)||(gt("Setting up fake worker."),Pe($t,Qs,!0)),$t._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Kt(this,Es).reject(new Error("Worker was destroyed"));return}const i=new w0;Pe(this,Wi,i);const n=`fake${wm($t,Wl)._++}`,r=new ir(n+"_worker",n,i);t.setup(r,i),Pe(this,bi,new ir(n,n+"_worker",i)),xi(this,Ne,Vl).call(this)}).catch(t=>{Kt(this,Es).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Zn=new WeakSet,Xl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},_i($t,Zn),_i($t,Wl,0),_i($t,Qs,!1),_i($t,Ws,new WeakMap),Me&&(Pe($t,Qs,!0),Wn.workerSrc||="./pdf.worker.mjs"),$t._isSameOrigin=(t,i)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const r=new URL(i,n);return n.origin===r.origin},$t._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},$t.fromPort=t=>{if(a0("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return $t.create(t)};let or=$t;class pA{#t=new Map;#e=new Map;#s=new Map;#i=new Map;#r=null;constructor(t,i,n,r,l,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new jg,this.fontLoader=new g0({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const n=this.#t.get(t);if(n)return n;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return yt(this,"annotationStorage",new ch)}getRenderingIntent(t,i=xs.ENABLE,n=null,r=!1,l=!1){let c=Ze.DISPLAY,u=$u;switch(t){case"any":c=Ze.ANY;break;case"display":break;case"print":c=Ze.PRINT;break;default:gt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&Ze.PRINT&&n instanceof xg?n:this.annotationStorage;switch(i){case xs.DISABLE:c+=Ze.ANNOTATIONS_DISABLE;break;case xs.ENABLE:break;case xs.ENABLE_FORMS:c+=Ze.ANNOTATIONS_FORMS;break;case xs.ENABLE_STORAGE:c+=Ze.ANNOTATIONS_STORAGE,u=h.serializable;break;default:gt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=Ze.IS_EDITING),l&&(c+=Ze.OPLIST);const{ids:f,hash:g}=h.modifiedIds,y=[c,u.hash,g];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#s.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Te.cleanup(),this._networkStream?.cancelAllRequests(new Cs("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(n,r)=>{Dt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}Dt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(n,r)=>{Dt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(n.begin,n.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Dt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,i._capability.resolve(new dA(n,this))}),t.on("DocException",n=>{i._capability.reject(Fe(n))}),t.on("PasswordRequest",n=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Fe(n);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};i.onPassword(r,n.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",n=>{i.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,r,l])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":if("error"in l){const y=l.error;gt(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=new Ht(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,h=new y0(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=l;Dt(f,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(n,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(n,l);break;case"Pattern":const g=new pe(l);this.commonObjs.resolve(n,g.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([n,r,l,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(n)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(n,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",n=>{this.destroyed||i.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[n.type];if(!r)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&gt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,n=this.#s.get(i);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const c=new fA(i,l,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#s.set(i,r),r}getPageIndex(t){return Qu(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new X0(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new q0(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Te.cleanup()}}cachedPageNumber(t){if(!Qu(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class mA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class Yn{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:n,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:x=null}){this.callback=t,this.params=i,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new mA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(Yn.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Yn.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Qn(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Yn.#e.delete(this._canvas),t||=new ah(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Yn.#e.delete(this._canvas),this.callback())))}}const gA="5.4.449",yA="f44e5f0e6";class di{#t=null;#e=null;#s;#i=null;#r=!1;#a=!1;#n=null;#l;#c=null;#o=null;static#d=null;static get _keyboardManager(){return yt(this,"_keyboardManager",new pr([[["Escape","mac+Escape"],di.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],di.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],di.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],di.prototype._moveToPrevious],[["Home","mac+Home"],di.prototype._moveToBeginning],[["End","mac+End"],di.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#n=t):this.#a=!0,this.#o=t?._uiManager||i,this.#l=this.#o._eventBus,this.#s=t?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",di.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#n&&(t.ariaControls=`${this.#n.id}_colorpicker_dropdown`);const i=this.#o._signal;t.addEventListener("click",this.#m.bind(this),{signal:i}),t.addEventListener("keydown",this.#g.bind(this),{signal:i});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#s,t.append(n),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#o._signal;t.addEventListener("contextmenu",pi,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#n&&(t.id=`${this.#n.id}_colorpicker_dropdown`);for(const[n,r]of this.#o.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=n,l.setAttribute("data-l10n-id",di.#d[n]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#s,l.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:Mt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#i.lastElementChild?.focus()}#g(t){di._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#o.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#n?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#o.highlightColors.values();for(const n of this.#i.children)n.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class cr{#t=null;#e=null;#s=null;static#i=null;constructor(t){this.#e=t,this.#s=t._uiManager,cr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:n}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=n||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",cr.#i[t]),r.addEventListener("input",()=>{this.#s.updateParams(i,r.value)},{signal:this.#s._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function lg(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function Za(p){return Math.max(0,Math.min(255,255*p))}class og{static CMYK_G([t,i,n,r]){return["G",1-Math.min(1,.3*t+.59*n+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Za(t),[t,t,t]}static G_HTML([t]){const i=lg(t);return`#${i}${i}${i}`}static RGB_G([t,i,n]){return["G",.3*t+.59*i+.11*n]}static RGB_rgb(t){return t.map(Za)}static RGB_HTML(t){return`#${t.map(lg).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,n,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,n+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,n,r]){return[Za(1-Math.min(1,t+r)),Za(1-Math.min(1,n+r)),Za(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,n]){const r=1-t,l=1-i,c=1-n,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class bA{create(t,i,n=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){qt("Abstract method `_createSVG` called.")}}class Ql extends bA{_createSVG(t){return document.createElementNS($i,t)}}const vA=9,Js=new WeakSet,AA=new Date().getTimezoneOffset()*60*1e3;class Uu{static create(t){switch(t.data.annotationType){case ce.LINK:return new ph(t);case ce.TEXT:return new wA(t);case ce.WIDGET:switch(t.data.fieldType){case"Tx":return new _A(t);case"Btn":return t.data.radioButton?new Ig(t):t.data.checkBox?new EA(t):new CA(t);case"Ch":return new TA(t);case"Sig":return new xA(t)}return new en(t);case ce.POPUP:return new Ju(t);case ce.FREETEXT:return new Hg(t);case ce.LINE:return new DA(t);case ce.SQUARE:return new NA(t);case ce.CIRCLE:return new RA(t);case ce.POLYLINE:return new Gg(t);case ce.CARET:return new kA(t);case ce.INK:return new mh(t);case ce.POLYGON:return new OA(t);case ce.HIGHLIGHT:return new qg(t);case ce.UNDERLINE:return new LA(t);case ce.SQUIGGLY:return new BA(t);case ce.STRIKEOUT:return new jA(t);case ce.STAMP:return new Vg(t);case ce.FILEATTACHMENT:return new zA(t);default:return new Wt(t)}}}class Wt{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:i=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Wt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:n,rect:r}=this.data;let l=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],l=i[u+2]):i[u+1]===c&&(l=Math.max(l,i[u+2]));return[l,c]}if(n?.length>=1){for(const u of n)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],l=u[h]):u[h+1]===c&&(l=Math.max(l,u[h]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-l)/n,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${ar}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,n={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:n})||this.annotationStorage.setValue(`${ar}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#s?.popup||this.popup)?.remove(),this.#s=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:n}=t;i&&this.#i(i);let r=this.#s?.popup||this.popup;!r&&n?.text&&(this._createPopup(n),r=this.#s.popup),r&&(r.updateEdited(t),n?.deleted&&(r.remove(),this.#s=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;n?.splice(0,4,...t),i.left=`${100*(t[0]-u)/l}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:n,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),!(this instanceof en)&&!(this instanceof ph)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof Ju){const{rotation:w}=i;return!i.hasOwnCanvas&&w!==0&&this.setRotation(w,l),l}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const w=i.borderStyle.horizontalCornerRadius,C=i.borderStyle.verticalCornerRadius;if(w>0||C>0){const M=`calc(${w}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;c.borderRadius=M}else if(this instanceof Ig){const M=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=M}switch(i.borderStyle.style){case Hn.SOLID:c.borderStyle="solid";break;case Hn.DASHED:c.borderStyle="dashed";break;case Hn.BEVELED:gt("Unimplemented border style: beveled");break;case Hn.INSET:gt("Unimplemented border style: inset");break;case Hn.UNDERLINE:c.borderBottomStyle="solid";break}const _=i.borderColor||null;_?(this.#e=!0,c.borderColor=rt.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):c.borderWidth=0}const f=rt.normalizeRect([i.rect[0],n.view[3]-i.rect[1]+n.view[1],i.rect[2],n.view[3]-i.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:y,pageX:b,pageY:A}=r.rawDims;c.left=`${100*(f[0]-b)/g}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:x}=i;return i.hasOwnCanvas||x===0?(c.width=`${100*u/g}%`,c.height=`${100*h/y}%`):this.setRotation(x,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/n}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,n,r)=>{const l=r.detail[i],c=l[0],u=l.slice(1);r.target.style[n]=og[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:og[`${c}_rgb`](u)})};return yt(this,"_commonActions",{display:i=>{const{display:n}=i.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:n}=i.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const n=i.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,i){const n=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||n[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const n=this._commonActions;for(const[r,l]of Object.entries(i)){const c=n[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,n,r,l]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,C,_,M]=t.subarray(2,6);if(r===w&&l===C&&i===_&&n===M)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:C}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=r-i,f=l-n,{svgFactory:g}=this,y=g.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=g.createElement("defs");y.append(b);const A=g.createElement("clipPath"),x=`clippath_${this.data.id}`;A.setAttribute("id",x),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let w=2,C=t.length;w<C;w+=8){const _=t[w],M=t[w+1],T=t[w+2],R=t[w+3],O=g.createElement("rect"),N=(T-i)/h,j=(l-M)/f,V=(_-T)/h,$=(M-R)/f;O.setAttribute("x",N),O.setAttribute("y",j),O.setAttribute("width",V),O.setAttribute("height",$),A.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${j}" width="${V}" height="${$}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${x})`}_createPopup(t=null){const{data:i}=this;let n,r;t?(n={str:t.text},r=t.date):(n=i.contentsObj,r=i.modificationDate),this.#s=new Ju({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:n,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#s||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#s}render(){qt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Js.has(f)){gt(`_getElementsByName - element not allowed: ${c}`);continue}n.push({id:c,exportValue:h,domElement:f})}return n}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==i&&Js.has(r)&&n.push({id:c,exportValue:l,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class SA extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class ph extends Wt{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(n,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#s(n,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),r=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=n,this.container.append(n)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,n=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,i,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),n&&(t.title=n),this.#t()}#e(t,i,n="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#s(t,i,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const l=n.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){gt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:r,refs:l,include:c}=i,u=[];if(r.length!==0||l.length!==0){const g=new Set(l);for(const y of r){const b=this._fieldObjects[y]||[];for(const{id:A}of b)g.add(A)}for(const y of Object.values(this._fieldObjects))for(const b of y)g.has(b.id)===c&&u.push(b)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const h=this.annotationStorage,f=[];for(const g of u){const{id:y}=g;switch(f.push(y),g.type){case"text":{const A=g.defaultValue||"";h.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;h.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";h.setValue(y,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!Js.has(b)){gt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class wA extends Wt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class en extends Wt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return xe.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,n,r,l){n.includes("mouse")?t.addEventListener(n,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(n,c=>{if(n==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(n==="focus"){if(i.focused)return;i.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,i,n,r){for(const[l,c]of n)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":rt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||vA,l=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(f/(Ou*r))||1,y=f/g;c=Math.min(r,h(y/Ou))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/Ou))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=rt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class _A extends en{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,n,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=n),l.setValue(c.id,{[r]:n})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Js.add(n),this.contentElement=n,n.setAttribute("data-element-id",i),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:y}=this.data,b=!!g&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),c&&(n.maxLength=c),n.addEventListener("input",x=>{t.setValue(i,{value:x.target.value}),this.setPropertyOnSiblings(n,"value",x.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",x=>{const w=this.data.defaultFieldValue??"";n.value=h.userValue=w,h.formattedValue=null});let A=x=>{const{formattedValue:w}=h;w!=null&&(x.target.value=w),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",w=>{if(h.focused)return;const{target:C}=w;if(b&&(C.type=g,y&&(C.step=y)),h.userValue){const _=h.userValue;if(b)if(g==="time"){const M=new Date(_),T=[M.getHours(),M.getMinutes(),M.getSeconds()];C.value=T.map(R=>R.toString().padStart(2,"0")).join(":")}else C.value=new Date(_-AA).toISOString().split(g==="date"?"T":".",1)[0];else C.value=_}h.lastCommittedValue=C.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const C={value(_){h.userValue=_.detail.value??"",b||t.setValue(i,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:M}=_.detail;h.formattedValue=M,M!=null&&_.target!==document.activeElement&&(_.target.value=M);const T={formattedValue:M};b&&(T.value=M),t.setValue(i,T)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{const{charLimit:M}=_.detail,{target:T}=_;if(M===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",M);let R=h.userValue;!R||R.length<=M||(R=R.slice(0,M),T.value=h.userValue=R,t.setValue(i,{value:R}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(C,w)}),n.addEventListener("keydown",w=>{h.commitKey=1;let C=-1;if(w.key==="Escape"?C=0:w.key==="Enter"&&!this.data.multiLine?C=2:w.key==="Tab"&&(h.commitKey=3),C===-1)return;const{value:_}=w.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:_,willCommit:!0,commitKey:C,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const x=A;A=null,n.addEventListener("blur",w=>{if(!h.focused||!w.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:C}=w;let{value:_}=C;if(b){if(_&&g==="time"){const M=_.split(":").map(T=>parseInt(T,10));_=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),C.step=""}else _.includes("T")||(_=`${_}T00:00`),_=new Date(_).valueOf();C.type="text"}h.userValue=_,h.lastCommittedValue!==_&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:_,willCommit:!0,commitKey:h.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),x(w)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",w=>{h.lastCommittedValue=null;const{data:C,target:_}=w,{value:M,selectionStart:T,selectionEnd:R}=_;let O=T,N=R;switch(w.inputType){case"deleteWordBackward":{const j=M.substring(0,T).match(/\w*[^\w]*$/);j&&(O-=j[0].length);break}case"deleteWordForward":{const j=M.substring(T).match(/^[^\w]*\w*/);j&&(N+=j[0].length);break}case"deleteContentBackward":T===R&&(O-=1);break;case"deleteContentForward":T===R&&(N+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:M,change:C||"",willCommit:!1,selStart:O,selEnd:N}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(A&&n.addEventListener("blur",A),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/c;n.classList.add("comb"),n.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class xA extends en{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class EA extends en{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,n=i.id;let r=t.getValue(n,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return Js.add(l),l.setAttribute("data-element-id",n),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,n)){const g=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(n,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Ig extends en{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,n=i.id;let r=t.getValue(n,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(n,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,n))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(Js.add(l),l.setAttribute("data-element-id",n),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const g=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=g&&y.id===n;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class CA extends ph{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class TA extends en{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,n=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");Js.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",g=>{const y=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===y});for(const g of this.data.options){const y=document.createElement("option");y.textContent=g.displayValue,y.value=g.exportValue,n.value.includes(g.exportValue)&&(y.setAttribute("selected",!0),l=!1),r.append(y)}let c=null;if(l){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),r.prepend(g),c=()=>{g.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=g=>{const y=g?"value":"textContent",{options:b,multiple:A}=r;return A?Array.prototype.filter.call(b,x=>x.selected).map(x=>x[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=u(!1);const f=g=>{const y=g.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",g=>{const y={value(b){c?.();const A=b.detail.value,x=new Set(Array.isArray(A)?A:[A]);for(const w of r.options)w.selected=x.has(w.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(b){r.multiple=!0},remove(b){const A=r.options,x=b.detail.remove;A[x].selected=!1,r.remove(x),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},clear(b){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(b){const{index:A,displayValue:x,exportValue:w}=b.detail.insert,C=r.children[A],_=document.createElement("option");_.textContent=x,_.value=w,C?C.before(_):r.append(_),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},items(b){const{items:A}=b.detail;for(;r.length!==0;)r.remove(0);for(const x of A){const{displayValue:w,exportValue:C}=x,_=document.createElement("option");_.textContent=w,_.value=C,r.append(_)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const x of b.target.options)x.selected=A.has(x.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,g)}),r.addEventListener("input",g=>{const y=u(!0),b=u(!1);t.setValue(i,{value:y}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):r.addEventListener("input",function(g){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ju extends Wt{constructor(t){const{data:i,elements:n,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&Wt._hasPopupData(i)}),this.elements=n,l&&Wt._hasPopupData(i)){const c=this.popup=this.#t();for(const u of n)u.popup=c}else this.popup=null}#t(){return new MA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),n=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",n.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(r=>`${Vn}${r}`).join(",")),this.container}}class MA{#t=null;#e=this.#q.bind(this);#s=this.#F.bind(this);#i=this.#k.bind(this);#r=this.#w.bind(this);#a=null;#n=null;#l=null;#c=null;#o=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#_=null;#S=null;#T=!1;#A=null;#x=null;constructor({container:t,color:i,elements:n,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:f,parentRect:g,open:y,commentManager:b=null}){this.#n=t,this.#_=r,this.#l=c,this.#E=u,this.#d=h,this.#a=i,this.#b=f,this.#h=g,this.#o=n,this.#t=b,this.#A=n[0],this.#c=Xu.toDateObject(l),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup()),b||(this.#N(),this.#n.hidden=!0,y&&this.#w())}#N(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#s,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#o)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#o.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#m=new AbortController,i=this.#A.hasOwnCommentButton,n=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#p=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",n,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#D(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",n,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,i]=this.#y,{style:n}=this.#p;n.left=`calc(${t}%)`,n.top=`calc(${i}% - var(--comment-button-dim))`}#z(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:i,opacity:n,creationDate:r,modificationDate:l}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:n,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#x||=this.#A.commentText,this.#x}set comment(t){t!==this.comment&&(this.#A.commentText=this.#x=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=i)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:n}=this.#p.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+n-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,n]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,l+i*u,c+n*h,{...t,parentDimensions:r})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#a){const n=t.style.outlineColor=rt.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#_?.str){const n=document.createElement("span");n.className="title",i.append(n),{dir:n.dir,str:n.textContent}=this.#_}if(t.append(i),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),i.append(n)}Ag({html:this.#O||this.#l.str,dir:this.#l?.dir,className:"popupContent"},t),this.#n.append(t)}get#O(){const t=this.#E,i=this.#l;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#L(){return this.#O?.attributes?.style?.fontSize||0}get#P(){return this.#O?.attributes?.style?.color||null}#B(t){const i=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#P,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:r});return n}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:i,deleted:n}){if(this.#t){n?(this.remove(),this.#x=null):i&&(i.deleted?this.remove():(this.#z(),this.#x=i.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(n||i?.deleted){this.remove();return}this.#N(),this.#S||={contentsObj:this.#l,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#B(i.text),this.#c=Xu.toDateObject(i.date),this.#l=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#S&&({contentsObj:this.#l,richText:this.#E}=this.#S,this.#S=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#T=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const x of this.#o)if(!u||rt.intersect(x.data.rect,u)!==null){u=x.data.rect,c=!0;break}const h=rt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=c?u[2]-u[0]+5:0,y=h[0]+g,b=h[1];this.#u=[100*(y-r)/i,100*(b-l)/n];const{style:A}=this.#n;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#k(),this.#n.addEventListener("click",this.#r),this.#n.addEventListener("keydown",this.#e)):(this.#F(),this.#n.removeEventListener("click",this.#r),this.#n.removeEventListener("keydown",this.#e))}#k(){this.#g||this.render(),this.isVisible?this.#f&&this.#n.classList.add("focused"):(this.#C(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#F(){this.#n.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#n.hidden=!0)}maybeShow(){this.#t||(this.#N(),this.#T&&(this.#g||this.#k(),this.#T=!1,this.#n.hidden=!1))}get isVisible(){return this.#t?!1:this.#n.hidden===!1}}class Hg extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=bt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const n=document.createElement("span");n.textContent=i,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class DA extends Wt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:n}=this,r=this.svgFactory.create(i,n,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class NA extends Wt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:n}=this,r=this.svgFactory.create(i,n,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",i-l),c.setAttribute("height",n-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class RA extends Wt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:n}=this,r=this.svgFactory.create(i,n,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",n/2),c.setAttribute("rx",i/2-l/2),c.setAttribute("ry",n/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gg extends Wt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:n,popupRef:r},width:l,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let g=0,y=i.length;g<y;g+=2){const b=i[g]-t[0],A=t[3]-i[g+1];h.push(`${b},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class OA extends Gg{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class kA extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class mh extends Wt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?bt.HIGHLIGHT:bt.INK}#s(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:n,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#s(i,t),f=this.svgFactory.create(u,h,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",r.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",c);for(let y=0,b=n.length;y<b;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",n[y].join(",")),g.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:n,rect:r}=t,l=this.#t;if(i>=0&&l.setAttribute("stroke-width",i||1),n)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",n[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#s(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class qg extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=bt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class LA extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class BA extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class jA extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Vg extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=bt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class zA extends Wt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let n;i.hasAppearance||i.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:r}=xe.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class gh{#t=null;#e=null;#s=null;#i=new Map;#r=null;#a=null;#n=[];#l=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:n,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:g}){this.div=t,this.#t=i,this.#e=n,this.#r=u||null,this.#a=f||null,this.#s=g||new ch,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,n=this.div;Zs(n,this.viewport);const r=new Map,l=[],c={data:null,layer:n,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Ql,annotationStorage:this.#s,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===ce.POPUP;if(h){const y=r.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=Uu.create(c);if(!f.isRenderable)continue;if(!h&&(this.#n.push(f),u.popupRef)){const y=r.get(u.popupRef);y?y.push(f):r.set(u.popupRef,[f])}const g=f.render();u.hidden&&(g.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const h=c.elements=r.get(u.id);c.data=u;const f=Uu.create(c);if(!f.isRenderable)continue;const g=f.render();f.contentElement.id=`${Vn}${u.id}`,u.hidden&&(g.style.visibility="hidden"),h.at(-1).container.after(g)}this.#o()}async#c(){if(this.#n.length===0)return;this.div.replaceChildren();const t=[];if(!this.#l){this.#l=!0;for(const{contentElement:n,data:{id:r}}of this.#n){const l=n.id=`${Vn}${r}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)n.setAttribute(u,h)}))}}this.#n.sort(({data:{rect:[n,r,l,c]}},{data:{rect:[u,h,f,g]}})=>{if(n===l&&r===c)return 1;if(u===f&&h===g)return-1;const y=c,b=r,A=(r+c)/2,x=g,w=h,C=(h+g)/2;if(A>=x&&C<=b)return-1;if(C>=y&&A<=w)return 1;const _=(n+l)/2,M=(u+f)/2;return _-M});const i=document.createDocumentFragment();for(const n of this.#n)i.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&i.append(n.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const n of this.#n)this.#t.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new Ql,parent:this};for(const n of t){n.borderStyle||=gh._defaultBorderStyle,i.data=n;const r=Uu.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${Vn}${n.id}`,this.#n.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,Zs(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,n]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(n):l.classList.contains("annotationContent")?l.after(n):l.before(n):r.append(n);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,n),c._hasNoCanvas=!1):c.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:n,rotation:r}=t,l=new SA({data:{id:n,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#s});return l.render(),l.contentElement.id=`${Vn}${n}`,l.createOrUpdatePopup(),this.#n.push(l),l}removeAnnotation(t){const i=this.#n.findIndex(r=>r.data.id===t);if(i<0)return;const[n]=this.#n.splice(i,1);this.#t?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return yt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Hn.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Hl=/\r\n?|\n/g;class me extends ut{#t="";#e=`${this.id}-editor`;#s=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=me.prototype,i=l=>l.isEmpty(),n=Ts.TRANSLATE_SMALL,r=Ts.TRANSLATE_BIG;return yt(this,"_keyboardManager",new pr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=bt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||me._defaultColor||ut._defaultLineColor,this.#i=t.fontSize||me._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){ut.initialize(t,i);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Mt.FREETEXT_SIZE:me._defaultFontSize=i;break;case Mt.FREETEXT_COLOR:me._defaultColor=i;break}}updateParams(t,i){switch(t){case Mt.FREETEXT_SIZE:this.#r(i);break;case Mt.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Mt.FREETEXT_SIZE,me._defaultFontSize],[Mt.FREETEXT_COLOR,me._defaultColor||ut._defaultLineColor]]}get propertiesToUpdate(){return[[Mt.FREETEXT_SIZE,this.#i],[Mt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new cr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Mt.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#l()},n=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Mt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Mt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-me._internalPadding*t,-(me._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const t=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#n(){const t=[];this.editorDiv.normalize();let i=null;for(const n of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(me.#c(n)),i=n);return t.join(`
`)}#l(){const[t,i]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),n=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/i):(this.width=n.height/t,this.height=n.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#n().trimEnd();if(t===i)return;const n=r=>{if(this.#t=r,!r){this.remove();return}this.#o(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{n(i)},undo:()=>{n(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){me._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,g]=this.pageDimensions,[y,b]=this.pageTranslation;let A,x;switch(this.rotation){case 0:A=t+(c[0]-y)/f,x=i+this.height-(c[1]-b)/g;break;case 90:A=t+(c[0]-y)/f,x=i-(c[1]-b)/g,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-y)/f,x=i-(c[1]-b)/g,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-y-this.height*g)/f,x=i+(c[1]-b-this.width*f)/g,[u,h]=[-h,u];break}this.setAt(A*r,x*l,u,h)}else this._moveAfterPaste(t,i);this.#o(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Hl,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:n}=i;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const r=me.#h(i.getData("text")||"").replaceAll(Hl,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],g=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(g.push(u.nodeValue.slice(h).replaceAll(Hl,"")),A!==this.editorDiv){let x=f;for(const w of this.editorDiv.childNodes){if(w===A){x=g;continue}x.push(me.#c(w))}}f.push(u.nodeValue.slice(0,h).replaceAll(Hl,""))}else if(u===this.editorDiv){let A=f,x=0;for(const w of this.editorDiv.childNodes)x++===h&&(A=g),A.push(me.#c(w))}this.#t=`${f.join(`
`)}${r}${g.join(`
`)}`,this.#o();const y=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const x=A.nodeValue.length;if(b<=x){y.setStart(A,b),y.setEnd(A,b);break}b-=x}l.removeAllRanges(),l.addRange(y)}#o(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=me._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,n){let r=null;if(t instanceof Hg){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:g,popupRef:y,richText:b,contentsObj:A,creationDate:x,modificationDate:w},textContent:C,textPosition:_,parent:{page:{pageNumber:M}}}=t;if(!C||C.length===0)return null;r=t={annotationType:bt.FREETEXT,color:Array.from(u),fontSize:c,value:C.join(`
`),position:_,pageIndex:M-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:y,comment:A?.str||null,richText:b,creationDate:x,modificationDate:w}}const l=await super.deserialize(t,i,n);return l.#i=t.fontSize,l.color=rt.makeHexColor(...t.color),l.#t=me.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(n),t?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(t){const{value:i,fontSize:n,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==n||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:n}=i;n.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,n.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class nt{static PRECISION=1e-4;toSVGPath(){qt("Abstract method `toSVGPath` must be implemented.")}get box(){qt("Abstract getter `box` must be implemented.")}serialize(t,i){qt("Abstract method `serialize` must be implemented.")}static _rescale(t,i,n,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=n+t[u+1]*l;return c}static _rescaleAndSwap(t,i,n,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=n+t[u]*l;return c}static _translate(t,i,n,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=i+t[l],r[l+1]=n+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,n,r,l){switch(l){case 90:return[1-i/n,t/r];case 180:return[1-t/n,1-i/r];case 270:return[i/n,1-t/r];default:return[t/n,i/r]}}static _normalizePagePoint(t,i,n){switch(n){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,n,r,l,c){return[(t+5*n)/6,(i+5*r)/6,(5*n+l)/6,(5*r+c)/6,(n+l)/2,(r+c)/2]}}class Ks{#t;#e=[];#s;#i;#r=[];#a=new Float32Array(18);#n;#l;#c;#o;#d;#h;#f=[];static#g=8;static#m=2;static#u=Ks.#g+Ks.#m;constructor({x:t,y:i},n,r,l,c,u=0){this.#t=n,this.#h=l*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#s=u,this.#o=Ks.#g*r,this.#c=Ks.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[n,r,l,c]=this.#t;return[(this.#n+(t[0]-i[0])/2-n)/l,(this.#l+(t[1]-i[1])/2-r)/c,(this.#n+(i[0]-t[0])/2-n)/l,(this.#l+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#n=t,this.#l=i;const[n,r,l,c]=this.#t;let[u,h,f,g]=this.#a.subarray(8,12);const y=t-f,b=i-g,A=Math.hypot(y,b);if(A<this.#c)return!1;const x=A-this.#o,w=x/A,C=w*y,_=w*b;let M=u,T=h;u=f,h=g,f+=C,g+=_,this.#f?.push(t,i);const R=-_/x,O=C/x,N=R*this.#h,j=O*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+N,g+j],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-N,g-j],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+N,h+j],2),this.#r.push(NaN,NaN,NaN,NaN,(u+N-n)/l,(h+j-r)/c),this.#a.set([u-N,h-j],14),this.#e.push(NaN,NaN,NaN,NaN,(u-N-n)/l,(h-j-r)/c)),this.#a.set([M,T,u,h,f,g],6),!this.isEmpty()):(this.#a.set([M,T,u,h,f,g],6),Math.abs(Math.atan2(T-h,M-u)-Math.atan2(_,C))<Math.PI/2?([u,h,f,g]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-n)/l,((h+g)/2-r)/c),[u,h,M,T]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-n)/l,((T+h)/2-r)/c),!0):([M,T,u,h,f,g]=this.#a.subarray(0,6),this.#r.push(((M+5*u)/6-n)/l,((T+5*h)/6-r)/c,((5*u+f)/6-n)/l,((5*h+g)/6-r)/c,((u+f)/2-n)/l,((h+g)/2-r)/c),[f,g,u,h,M,T]=this.#a.subarray(12,18),this.#e.push(((M+5*u)/6-n)/l,((T+5*h)/6-r)/c,((5*u+f)/6-n)/l,((5*h+g)/6-r)/c,((u+f)/2-n)/l,((h+g)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(n);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?n.push(`L${i[r+4]} ${i[r+5]}`):n.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(n),n.join(" ")}#y(){const[t,i,n,r]=this.#t,[l,c,u,h]=this.#p();return`M${(this.#a[2]-t)/n} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/n} ${(this.#a[5]-i)/r} L${l} ${c} L${u} ${h} L${(this.#a[16]-t)/n} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/n} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,n,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,g,y]=this.#p();t.push(`L${(c[0]-i)/r} ${(c[1]-n)/l} L${h} ${f} L${g} ${y} L${(u[0]-i)/r} ${(u[1]-n)/l}`)}newFreeDrawOutline(t,i,n,r,l,c){return new Xg(t,i,n,r,l,c)}getOutlines(){const t=this.#r,i=this.#e,n=this.#a,[r,l,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=h.length-2;y<b;y+=2)h[y]=(this.#f[y]-r)/c,h[y+1]=(this.#f[y+1]-l)/u;if(h[h.length-2]=(this.#n-r)/c,h[h.length-1]=(this.#l-l)/u,isNaN(n[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let g=t.length;for(let y=0;y<g;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}g=this.#S(f,g);for(let y=i.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(i[y+b])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=i[y+b],f[g+1]=i[y+b+1],g+=2}return this.#_(f,g),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#s,this.#i)}#E(t){const i=this.#a,[n,r,l,c]=this.#t,[u,h,f,g]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-n)/l,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-n)/l,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(i[16]-n)/l,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-n)/l,(i[15]-r)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#s,this.#i)}#_(t,i){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],i),i+=6}#S(t,i){const n=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,h]=this.#t,[f,g,y,b]=this.#p();return t.set([NaN,NaN,NaN,NaN,(n[0]-l)/u,(n[1]-c)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/h],i),i+=24}}class Xg extends nt{#t;#e=new Float32Array(4);#s;#i;#r;#a;#n;constructor(t,i,n,r,l,c){super(),this.#n=t,this.#r=i,this.#t=n,this.#a=r,this.#s=l,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#l(c);const[u,h,f,g]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-h)/g;for(let y=0,b=i.length;y<b;y+=2)i[y]=(i[y]-u)/f,i[y+1]=(i[y+1]-h)/g}toSVGPath(){const t=[`M${this.#n[4]} ${this.#n[5]}`];for(let i=6,n=this.#n.length;i<n;i+=6){if(isNaN(this.#n[i])){t.push(`L${this.#n[i+4]} ${this.#n[i+5]}`);continue}t.push(`C${this.#n[i]} ${this.#n[i+1]} ${this.#n[i+2]} ${this.#n[i+3]} ${this.#n[i+4]} ${this.#n[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,n,r],l){const c=n-t,u=r-i;let h,f;switch(l){case 0:h=nt._rescale(this.#n,t,r,c,-u),f=nt._rescale(this.#r,t,r,c,-u);break;case 90:h=nt._rescaleAndSwap(this.#n,t,i,c,u),f=nt._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=nt._rescale(this.#n,n,i,-c,u),f=nt._rescale(this.#r,n,i,-c,u);break;case 270:h=nt._rescaleAndSwap(this.#n,n,r,-c,-u),f=nt._rescaleAndSwap(this.#r,n,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#l(t){const i=this.#n;let n=i[4],r=i[5];const l=[n,r,n,r];let c=n,u=r,h=n,f=r;const g=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,x=i.length;A<x;A+=6){const w=i[A+4],C=i[A+5];isNaN(i[A])?(rt.pointBoundingBox(w,C,l),u>C?(c=w,u=C):u===C&&(c=g(c,w)),f<C?(h=w,f=C):f===C&&(h=g(h,w))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,rt.bezierBoundingBox(n,r,...i.slice(A,A+6),y),rt.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=g(c,y[0])),f<y[3]?(h=y[2],f=y[3]):f===y[3]&&(h=g(h,y[2]))),n=w,r=C}const b=this.#e;b[0]=l[0]-this.#s,b[1]=l[1]-this.#s,b[2]=l[2]-l[0]+2*this.#s,b[3]=l[3]-l[1]+2*this.#s,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,n,r,l,c=0){return new Ks(t,i,n,r,l,c)}getNewOutline(t,i){const[n,r,l,c]=this.#e,[u,h,f,g]=this.#t,y=l*f,b=c*g,A=n*f+u,x=r*g+h,w=this.newOutliner({x:this.#r[0]*y+A,y:this.#r[1]*b+x},this.#t,this.#a,t,this.#i,i??this.#s);for(let C=2;C<this.#r.length;C+=2)w.add({x:this.#r[C]*y+A,y:this.#r[C+1]*b+x});return w.getOutlines()}}class th{#t;#e;#s;#i=[];#r=[];constructor(t,i=0,n=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:w,y:C,width:_,height:M}of t){const T=Math.floor((w-i)/c)*c,R=Math.ceil((w+_+i)/c)*c,O=Math.floor((C-i)/c)*c,N=Math.ceil((C+M+i)/c)*c,j=[T,O,N,!0],V=[R,O,N,!1];this.#i.push(j,V),rt.rectBoundingBox(T,O,R,N,l)}const u=l[2]-l[0]+2*n,h=l[3]-l[1]+2*n,f=l[0]-n,g=l[1]-n;let y=r?-1/0:1/0,b=1/0;const A=this.#i.at(r?-1:-2),x=[A[0],A[2]];for(const w of this.#i){const[C,_,M,T]=w;!T&&r?_<b?(b=_,y=C):_===b&&(y=Math.max(y,C)):T&&!r&&(_<b?(b=_,y=C):_===b&&(y=Math.min(y,C))),w[0]=(C-f)/u,w[1]=(_-g)/h,w[2]=(M-g)/h}this.#t=new Float32Array([f,g,u,h]),this.#e=[y,b],this.#s=x}getOutlines(){this.#i.sort((i,n)=>i[0]-n[0]||i[1]-n[1]||i[2]-n[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#o(i)),this.#l(i)):(this.#c(i),t.push(...this.#o(i)));return this.#a(t)}#a(t){const i=[],n=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const r=[];let l;for(;n.size>0;){const c=n.values().next().value;let[u,h,f,g,y]=c;n.delete(c);let b=u,A=h;for(l=[u,f],r.push(l);;){let x;if(n.has(g))x=g;else if(n.has(y))x=y;else break;n.delete(x),[u,h,f,g,y]=x,b!==u&&(l.push(b,A,u,A===h?h:f),b=u),A=A===h?f:h}l.push(b,A)}return new PA(r,this.#t,this.#e,this.#s)}#n(t){const i=this.#r;let n=0,r=i.length-1;for(;n<=r;){const l=n+r>>1,c=i[l][0];if(c===t)return l;c<t?n=l+1:r=l-1}return r+1}#l([,t,i]){const n=this.#n(t);this.#r.splice(n,0,[t,i])}#c([,t,i]){const n=this.#n(t);for(let r=n;r<this.#r.length;r++){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}for(let r=n-1;r>=0;r--){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}}#o(t){const[i,n,r]=t,l=[[i,n,r]],c=this.#n(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let g=0,y=l.length;g<y;g++){const[,b,A]=l[g];if(!(f<=b||A<=h)){if(b>=h){if(A>f)l[g][1]=f;else{if(y===1)return[];l.splice(g,1),g--,y--}continue}l[g][2]=h,A>f&&l.push([i,f,A])}}}return l}}class PA extends nt{#t;#e;constructor(t,i,n,r){super(),this.#e=t,this.#t=i,this.firstPoint=n,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[n,r]=i;t.push(`M${n} ${r}`);for(let l=2;l<i.length;l+=2){const c=i[l],u=i[l+1];c===n?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),n=c)}t.push("Z")}return t.join(" ")}serialize([t,i,n,r],l){const c=[],u=n-t,h=r-i;for(const f of this.#e){const g=new Array(f.length);for(let y=0;y<f.length;y+=2)g[y]=t+f[y]*u,g[y+1]=r-f[y+1]*h;c.push(g)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class eh extends Ks{newFreeDrawOutline(t,i,n,r,l,c){return new FA(t,i,n,r,l,c)}}class FA extends Xg{newOutliner(t,i,n,r,l,c=0){return new eh(t,i,n,r,l,c)}}class se extends ut{#t=null;#e=0;#s;#i=null;#r=null;#a=null;#n=null;#l=0;#c=null;#o=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=bt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=se.prototype;return yt(this,"_keyboardManager",new pr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||se._defaultColor,this.#p=t.thickness||se._defaultThickness,this.opacity=t.opacity||se._defaultOpacity,this.#s=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#n=t.focusNode,this.#l=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new th(this.#s,.001);this.#o=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const i=new th(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:n}=this.#o;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#g=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:n}){this.#o=t;const r=1.5;if(this.#a=t.getNewOutline(this.#p/2+r,.0025),i>=0)this.#d=i,this.#i=n,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:se.#x(this.#o.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:se.#x(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[y,b]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*b/y,this.height=h*y/b;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*b/y,this.height=h*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/h];const{lastPoint:g}=this.#a;this.#g=[(g[0]-l)/u,(g[1]-c)/h]}static initialize(t,i){ut.initialize(t,i),se._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Mt.HIGHLIGHT_COLOR:se._defaultColor=i;break;case Mt.HIGHLIGHT_THICKNESS:se._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Mt.HIGHLIGHT_COLOR:this.#E(i);break;case Mt.HIGHLIGHT_THICKNESS:this.#_(i);break}}static get defaultPropertiesToUpdate(){return[[Mt.HIGHLIGHT_COLOR,se._defaultColor],[Mt.HIGHLIGHT_THICKNESS,se._defaultThickness]]}get propertiesToUpdate(){return[[Mt.HIGHLIGHT_COLOR,this.color||se._defaultColor],[Mt.HIGHLIGHT_THICKNESS,this.#p||se._defaultThickness],[Mt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},n=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,se._defaultOpacity),undo:i.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Mt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#_(t){const i=this.#p,n=r=>{this.#p=r,this.#S(r)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Mt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new di({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#T():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#b({highlightOutlines:this.#o.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#T(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#o.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#x([t,i,n,r],l){switch(l){case 90:return[1-i-r,t,r,n];case 180:return[1-t-n,1-i-r,n,r];case 270:return[i,1-t-n,r,n]}return[t,i,n,r]}rotate(t){const{drawLayer:i}=this.parent;let n;this.#h?(t=(t-this.rotation+360)%360,n=se.#x(this.#o.box,t)):n=se.#x([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),i.updateProperties(this.#m,{bbox:se.#x(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),wg(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#N(t){se._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#n,this.#l)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#z(){if(this.#h)return null;const[t,i]=this.pageDimensions,[n,r]=this.pageTranslation,l=this.#s,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:f,width:g,height:y}of l){const b=h*t+n,A=(1-f)*i+r;c[u]=c[u+4]=b,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=b+g*t,c[u+5]=c[u+7]=A-y*i,u+=8}return c}#O(t){return this.#o.serialize(t,this.#D())}static startHighlighting(t,i,{target:n,x:r,y:l}){const{x:c,y:u,width:h,height:f}=n.getBoundingClientRect(),g=new AbortController,y=t.combinedSignal(g),b=A=>{g.abort(),this.#P(t,A)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",te,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",pi,{signal:y}),n.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new eh({x:r,y:l},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#P(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,n){let r=null;if(t instanceof qg){const{data:{quadPoints:x,rect:w,rotation:C,id:_,color:M,opacity:T,popupRef:R,richText:O,contentsObj:N,creationDate:j,modificationDate:V},parent:{page:{pageNumber:$}}}=t;r=t={annotationType:bt.HIGHLIGHT,color:Array.from(M),opacity:T,quadPoints:x,boxes:null,pageIndex:$-1,rect:w.slice(0),rotation:C,annotationElementId:_,id:_,deleted:!1,popupRef:R,richText:O,comment:N?.str||null,creationDate:j,modificationDate:V}}else if(t instanceof mh){const{data:{inkLists:x,rect:w,rotation:C,id:_,color:M,borderStyle:{rawWidth:T},popupRef:R,richText:O,contentsObj:N,creationDate:j,modificationDate:V},parent:{page:{pageNumber:$}}}=t;r=t={annotationType:bt.HIGHLIGHT,color:Array.from(M),thickness:T,inkLists:x,boxes:null,pageIndex:$-1,rect:w.slice(0),rotation:C,annotationElementId:_,id:_,deleted:!1,popupRef:R,richText:O,comment:N?.str||null,creationDate:j,modificationDate:V}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,n);f.color=rt.makeHexColor(...l),f.opacity=h||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[g,y]=f.pageDimensions,[b,A]=f.pageTranslation;if(c){const x=f.#s=[];for(let w=0;w<c.length;w+=8)x.push({x:(c[w]-b)/g,y:1-(c[w+1]-A)/y,width:(c[w+2]-c[w])/g,height:(c[w+1]-c[w+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const x=u[0],w={x:x[0]-b,y:y-(x[1]-A)},C=new eh(w,[0,0,g,y],1,f.#p/2,!0,.001);for(let T=0,R=x.length;T<R;T+=2)w.x=x[T]-b,w.y=y-(x[T+1]-A),C.add(w);const{id:_,clipPathId:M}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#b({highlightOutlines:C.getOutlines(),highlightId:_,clipPathId:M}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(t);return Object.assign(n,{color:i,opacity:this.opacity,thickness:this.#p,quadPoints:this.#z(),outlines:this.#O(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#B(n)?null:(n.id=this.annotationElementId,n)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((n,r)=>n!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Yg{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,n]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,n)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){qt("Not implemented")}}class Bt extends ut{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#n(t,this.parent),this.#h(t.box)}#n(t,i){const{id:n}=i.drawLayer.draw(Bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,i){const n=new Set(Object.keys(t));for(const[r,l]of Object.entries(i))n.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){qt("Not implemented")}static get typesMap(){qt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,i),this._currentParent&&(Bt.#s.updateProperty(n,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)t.push([n,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[n,r]of this.constructor.typesMap)t.push([n,i[r]]);return t}_updateProperty(t,i,n){const r=this._drawingOptions,l=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,n),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#l()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#n(this.#t,t)}}#o([t,i,n,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[i,1-t,n*(c/l),r*(l/c)];case 180:return[1-t,1-i,n,r];case 270:return[1-i,t,n*(c/l),r*(l/c)];default:return[t,i,n,r]}}#d(){const{x:t,y:i,width:n,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-i,t,n*(l/c),r*(c/l)];case 180:return[1-t,1-i,n,r];case 270:return[i,1-t,n*(l/c),r*(c/l)];default:return[t,i,n,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#o(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:n,height:r,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-i-r,t,r,n];case 2:return[1-t-n,1-i-r,n,r];case 3:return[i,1-t-n,r,n];case 4:return[t,i-n*(u/h),r*(h/u),n*(u/h)];case 5:return[1-i,t,n*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),n*(u/h)];case 7:return[i-n*(u/h),1-t-r*(h/u),n*(u/h),r*(h/u)];case 8:return[t-n,i-r,n,r];case 9:return[1-i,t-n,r,n];case 10:return[1-t,1-i,n,r];case 11:return[i-r,1-t,r,n];case 12:return[t-r*(h/u),i,r*(h/u),n*(u/h)];case 13:return[1-i-n*(u/h),t-r*(h/u),n*(u/h),r*(h/u)];case 14:return[1-t,1-i-n*(u/h),r*(h/u),n*(u/h)];case 15:return[i,1-t,n*(u/h),r*(h/u)];default:return[t,i,n,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Bt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const n=super.render();n.classList.add("draw");const r=document.createElement("div");return n.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),n}static createDrawerInstance(t,i,n,r,l){qt("Not implemented")}static startDrawing(t,i,n,r){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(jt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:g}}=t,{width:y,height:b}=l.getBoundingClientRect(),A=Bt.#i=new AbortController,x=t.combinedSignal(A);if(jt.setPointer(f,h),window.addEventListener("pointerup",w=>{jt.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:x}),window.addEventListener("pointercancel",w=>{jt.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:x}),window.addEventListener("pointerdown",w=>{jt.isSamePointerType(w.pointerType)&&(jt.initializeAndAddPointerId(w.pointerId),Bt.#s.isCancellable()&&(Bt.#s.removeLastElement(),Bt.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",pi,{signal:x}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),l.addEventListener("touchmove",w=>{jt.isSameTimeStamp(w.timeStamp)&&te(w)},{signal:x}),t.toggleDrawing(),i._editorUndoBar?.hide(),Bt.#s){t.drawLayer.updateProperties(this._currentDrawId,Bt.#s.startNew(c,u,y,b,g));return}i.updateUIForDefaultProperties(this),Bt.#s=this.createDrawerInstance(c,u,y,b,g),Bt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Bt.#r.toSVGProperties(),Bt.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(jt.isSameTimeStamp(t.timeStamp),!Bt.#s)return;const{offsetX:i,offsetY:n,pointerId:r}=t;if(jt.isSamePointerId(r)){if(jt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Bt.#s.add(i,n)),jt.setTimeStamp(t.timeStamp),te(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Bt.#s=null,Bt.#r=null,jt.clearPointerType(),jt.clearTimeStamp()),Bt.#i&&(Bt.#i.abort(),Bt.#i=null,jt.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Bt.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=Bt.#s,r=this._currentDrawId,l=n.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,n.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:Mt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Mt.DRAW_STEP),!Bt.#s.isEmpty()){const{pageDimensions:[n,r],scale:l}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Bt.#s.getOutlines(n*l,r*l,l,this._INNER_MARGIN),drawingOptions:Bt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,n,r,l,c){qt("Not implemented")}static async deserialize(t,i,n){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,i,n);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,n]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([i,n,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class UA{#t=new Float64Array(6);#e;#s;#i;#r;#a;#n="";#l=0;#c=new gr;#o;#d;constructor(t,i,n,r,l,c){this.#o=n,this.#d=r,this.#i=l,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#s=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return nt._normalizePoint(t,i,this.#o,this.#d,this.#i)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[n,r,l,c]=this.#t.subarray(2,6),u=t-l,h=i-c;return Math.hypot(this.#o*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(n)?(this.#t.set([l,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,r,l,c,t,i],0),this.#e.push(...nt.createBezierPoints(n,r,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const n=this.add(t,i);return n||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,n,r,l){this.#o=n,this.#d=r,this.#i=l,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:c,points:this.#a}),this.#t.set(c,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#a=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#c.removeLastElement();this.#s.pop(),this.#n="";for(let t=0,i=this.#s.length;t<i;t++){const{line:n,points:r}=this.#s[t];this.#e=n,this.#a=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#n}}}toSVGPath(){const t=nt.svgRound(this.#e[4]),i=nt.svgRound(this.#e[5]);if(this.#a.length===2)return this.#n=`${this.#n} M ${t} ${i} Z`,this.#n;if(this.#a.length<=6){const r=this.#n.lastIndexOf("M");this.#n=`${this.#n.slice(0,r)} M ${t} ${i}`,this.#l=6}if(this.#a.length===4){const r=nt.svgRound(this.#e[10]),l=nt.svgRound(this.#e[11]);return this.#n=`${this.#n} L ${r} ${l}`,this.#l=12,this.#n}const n=[];this.#l===0&&(n.push(`M ${t} ${i}`),this.#l=6);for(let r=this.#l,l=this.#e.length;r<l;r+=6){const[c,u,h,f,g,y]=this.#e.slice(r,r+6).map(nt.svgRound);n.push(`C${c} ${u} ${h} ${f} ${g} ${y}`)}return this.#n+=n.join(" "),this.#l=this.#e.length,this.#n}getOutlines(t,i,n,r){const l=this.#s.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#s,t,i,n,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#s=null,this.#n=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class gr extends nt{#t;#e=0;#s;#i;#r;#a;#n;#l;#c;build(t,i,n,r,l,c,u){this.#r=i,this.#a=n,this.#n=r,this.#l=l,this.#c=c,this.#s=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${nt.svgRound(i[4])} ${nt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${nt.svgRound(i[10])} ${nt.svgRound(i[11])}`);continue}for(let n=6,r=i.length;n<r;n+=6){const[l,c,u,h,f,g]=i.subarray(n,n+6).map(nt.svgRound);t.push(`C${l} ${c} ${u} ${h} ${f} ${g}`)}}return t.join("")}serialize([t,i,n,r],l){const c=[],u=[],[h,f,g,y]=this.#d();let b,A,x,w,C,_,M,T,R;switch(this.#l){case 0:R=nt._rescale,b=t,A=i+r,x=n,w=-r,C=t+h*n,_=i+(1-f-y)*r,M=t+(h+g)*n,T=i+(1-f)*r;break;case 90:R=nt._rescaleAndSwap,b=t,A=i,x=n,w=r,C=t+f*n,_=i+h*r,M=t+(f+y)*n,T=i+(h+g)*r;break;case 180:R=nt._rescale,b=t+n,A=i,x=-n,w=r,C=t+(1-h-g)*n,_=i+f*r,M=t+(1-h)*n,T=i+(f+y)*r;break;case 270:R=nt._rescaleAndSwap,b=t+n,A=i+r,x=-n,w=-r,C=t+(1-f-y)*n,_=i+(1-h-g)*r,M=t+(1-f)*n,T=i+(1-h)*r;break}for(const{line:O,points:N}of this.#i)c.push(R(O,b,A,x,w,l?new Array(O.length):null)),u.push(R(N,b,A,x,w,l?new Array(N.length):null));return{lines:c,points:u,rect:[C,_,M,T]}}static deserialize(t,i,n,r,l,{paths:{lines:c,points:u},rotation:h,thickness:f}){const g=[];let y,b,A,x,w;switch(h){case 0:w=nt._rescale,y=-t/n,b=i/r+1,A=1/n,x=-1/r;break;case 90:w=nt._rescaleAndSwap,y=-i/r,b=-t/n,A=1/r,x=1/n;break;case 180:w=nt._rescale,y=t/n+1,b=-i/r,A=-1/n,x=1/r;break;case 270:w=nt._rescaleAndSwap,y=i/r+1,b=t/n+1,A=-1/r,x=-1/n;break}if(!c){c=[];for(const _ of u){const M=_.length;if(M===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(M===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const T=new Float32Array(3*(M-2));c.push(T);let[R,O,N,j]=_.subarray(0,4);T.set([NaN,NaN,NaN,NaN,R,O],0);for(let V=4;V<M;V+=2){const $=_[V],J=_[V+1];T.set(nt.createBezierPoints(R,O,N,j,$,J),(V-2)*3),[R,O,N,j]=[N,j,$,J]}}}for(let _=0,M=c.length;_<M;_++)g.push({line:w(c[_].map(T=>T??NaN),y,b,A,x),points:w(u[_].map(T=>T??NaN),y,b,A,x)});const C=new this.prototype.constructor;return C.build(g,n,r,1,h,f,l),C}#o(t=this.#c){const i=this.#s+t/2*this.#n;return this.#l%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,n,r]=this.#t,[l,c]=this.#o(0);return[t+l,i+c,n-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)rt.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,g,y,b,A,x]=r.subarray(u,u+6);rt.bezierBoundingBox(l,c,f,g,y,b,A,x,t),l=A,c=x}}const[i,n]=this.#o();t[0]=De(t[0]-i,0,1),t[1]=De(t[1]-n,0,1),t[2]=De(t[2]+i,0,1),t[3]=De(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,n]=this.#o();this.#c=t;const[r,l]=this.#o(),[c,u]=[r-i,l-n],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],n){const[r,l]=this.#o();this.#r=t,this.#a=i,this.#n=n;const[c,u]=this.#o(),h=c-r,f=u-l,g=this.#t;return g[0]-=h,g[1]-=f,g[2]+=2*h,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(nt.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let n=0,r=0,l=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,l=-t/i,u=t;break;case 180:n=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,l=t/i,h=i;break;default:return""}return`matrix(${n} ${r} ${l} ${c} ${nt.svgRound(u)} ${nt.svgRound(h)})`}getPathResizingSVGProperties([t,i,n,r]){const[l,c]=this.#o(),[u,h,f,g]=this.#t;if(Math.abs(f-l)<=nt.PRECISION||Math.abs(g-c)<=nt.PRECISION){const w=t+n/2-(u+f/2),C=i+r/2-(h+g/2);return{path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${w} ${C})`}}}const y=(n-2*l)/(f-2*l),b=(r-2*c)/(g-2*c),A=f/n,x=g/r;return{path:{"transform-origin":`${nt.svgRound(u)} ${nt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${x}) translate(${nt.svgRound(l)} ${nt.svgRound(c)}) scale(${y} ${b}) translate(${nt.svgRound(-l)} ${nt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,n,r]){const[l,c]=this.#o(),u=this.#t,[h,f,g,y]=u;if(u[0]=t,u[1]=i,u[2]=n,u[3]=r,Math.abs(g-l)<=nt.PRECISION||Math.abs(y-c)<=nt.PRECISION){const C=t+n/2-(h+g/2),_=i+r/2-(f+y/2);for(const{line:M,points:T}of this.#i)nt._translate(M,C,_,M),nt._translate(T,C,_,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(n-2*l)/(g-2*l),A=(r-2*c)/(y-2*c),x=-b*(h+l)+t+l,w=-A*(f+c)+i+c;if(b!==1||A!==1||x!==0||w!==0)for(const{line:C,points:_}of this.#i)nt._rescale(C,x,w,b,A,C),nt._rescale(_,x,w,b,A,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],n){const[r,l]=n,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===l)for(const{line:f,points:g}of this.#i)nt._translate(f,u,h,f),nt._translate(g,u,h,g);else{const f=this.#r/r,g=this.#a/l;this.#r=r,this.#a=l;for(const{line:y,points:b}of this.#i)nt._rescale(y,u,h,f,g,y),nt._rescale(b,u,h,f,g,b);c[2]*=f,c[3]*=g}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t[0])} ${nt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class no extends Yg{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new no(this._viewParameters);return t.updateAll(this),t}}class yh extends Bt{static _type="ink";static _editorType=bt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){ut.initialize(t,i),this._defaultDrawingOptions=new no(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return yt(this,"typesMap",new Map([[Mt.INK_THICKNESS,"stroke-width"],[Mt.INK_COLOR,"stroke"],[Mt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,n,r,l){return new UA(t,i,n,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,n,r,l,c){return gr.deserialize(t,i,n,r,l,c)}static async deserialize(t,i,n){let r=null;if(t instanceof mh){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:g,opacity:y,borderStyle:{rawWidth:b},popupRef:A,richText:x,contentsObj:w,creationDate:C,modificationDate:_},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:bt.INK,color:Array.from(g),thickness:b,opacity:y,paths:{points:c},boxes:null,pageIndex:M-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:x,comment:w?.str||null,creationDate:C,modificationDate:_}}const l=await super.deserialize(t,i,n);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new cr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Mt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:n}=this;i.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:n}){this._drawingOptions=yh.getDefaultDrawingOptions({stroke:rt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:n}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:ut._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:i,points:n}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:n,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==n||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class ih extends gr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Gl=8,Ja=3;class qn{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,n,r){return n-=t,r-=i,n===0?r>0?0:4:n===1?r+6:2-r}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,n,r,l,c,u){const h=this.#e(n,r,l,c);for(let f=0;f<8;f++){const g=(-f+h-u+16)%8,y=this.#s[2*g],b=this.#s[2*g+1];if(t[(n+y)*i+(r+b)]!==0)return g}return-1}static#r(t,i,n,r,l,c,u){const h=this.#e(n,r,l,c);for(let f=0;f<8;f++){const g=(f+h+u+16)%8,y=this.#s[2*g],b=this.#s[2*g+1];if(t[(n+y)*i+(r+b)]!==0)return g}return-1}static#a(t,i,n,r){const l=t.length,c=new Int32Array(l);for(let g=0;g<l;g++)c[g]=t[g]<=r?1:0;for(let g=1;g<n-1;g++)c[g*i]=c[g*i+i-1]=0;for(let g=0;g<i;g++)c[g]=c[i*n-1-g]=0;let u=1,h;const f=[];for(let g=1;g<n-1;g++){h=1;for(let y=1;y<i-1;y++){const b=g*i+y,A=c[b];if(A===0)continue;let x=g,w=y;if(A===1&&c[b-1]===0)u+=1,w-=1;else if(A>=1&&c[b+1]===0)u+=1,w+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const C=[y,g],_=w===y+1,M={isHole:_,points:C,id:u,parent:0};f.push(M);let T;for(const tt of f)if(tt.id===h){T=tt;break}T?T.isHole?M.parent=_?T.parent:h:M.parent=_?h:T.parent:M.parent=_?h:0;const R=this.#i(c,i,g,y,x,w,0);if(R===-1){c[b]=-u,c[b]!==1&&(h=Math.abs(c[b]));continue}let O=this.#s[2*R],N=this.#s[2*R+1];const j=g+O,V=y+N;x=j,w=V;let $=g,J=y;for(;;){const tt=this.#r(c,i,$,J,x,w,1);O=this.#s[2*tt],N=this.#s[2*tt+1];const it=$+O,pt=J+N;C.push(pt,it);const ht=$*i+J;if(c[ht+1]===0?c[ht]=-u:c[ht]===1&&(c[ht]=u),it===g&&pt===y&&$===j&&J===V){c[b]!==1&&(h=Math.abs(c[b]));break}else x=$,w=J,$=it,J=pt}}}return f}static#n(t,i,n,r){if(n-i<=4){for(let j=i;j<n-2;j+=2)r.push(t[j],t[j+1]);return}const l=t[i],c=t[i+1],u=t[n-4]-l,h=t[n-3]-c,f=Math.hypot(u,h),g=u/f,y=h/f,b=g*c-y*l,A=h/u,x=1/f,w=Math.atan(A),C=Math.cos(w),_=Math.sin(w),M=x*(Math.abs(C)+Math.abs(_)),T=x*(1-M+M**2),R=Math.max(Math.atan(Math.abs(_+C)*T),Math.atan(Math.abs(_-C)*T));let O=0,N=i;for(let j=i+2;j<n-2;j+=2){const V=Math.abs(b-g*t[j+1]+y*t[j]);V>O&&(N=j,O=V)}O>(f*R)**2?(this.#n(t,i,N+2,r),this.#n(t,N,n,r)):r.push(l,c)}static#l(t){const i=[],n=t.length;return this.#n(t,0,n,i),i.push(t[n-2],t[n-1]),i.length<=4?null:i}static#c(t,i,n,r,l,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let w=0;w<c;w++){const C=(w-f)**2;for(let _=0;_<c;_++)u[w*c+_]=Math.exp((C+(_-f)**2)/h)}const g=new Float32Array(256),y=-2*l**2;for(let w=0;w<256;w++)g[w]=Math.exp(w**2/y);const b=t.length,A=new Uint8Array(b),x=new Uint32Array(256);for(let w=0;w<n;w++)for(let C=0;C<i;C++){const _=w*i+C,M=t[_];let T=0,R=0;for(let N=0;N<c;N++){const j=w+N-f;if(!(j<0||j>=n))for(let V=0;V<c;V++){const $=C+V-f;if($<0||$>=i)continue;const J=t[j*i+$],tt=u[N*c+V]*g[Math.abs(J-M)];T+=J*tt,R+=tt}}const O=A[_]=Math.round(T/R);x[O]++}return[A,x]}static#o(t){const i=new Uint32Array(256);for(const n of t)i[n]++;return i}static#d(t){const i=t.length,n=new Uint8ClampedArray(i>>2);let r=-1/0,l=1/0;for(let u=0,h=n.length;u<h;u++){const f=n[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,h=n.length;u<h;u++)n[u]=(n[u]-l)*c;return n}static#h(t){let i,n=-1/0,r=-1/0;const l=t.findIndex(h=>h!==0);let c=l,u=l;for(i=l;i<256;i++){const h=t[i];h>n&&(i-c>r&&(r=i-c,u=i-1),n=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:n,height:r}=t,{maxDim:l}=this.#t;let c=n,u=r;if(n>l||r>l){let b=n,A=r,x=Math.log2(Math.max(n,r)/l);const w=Math.floor(x);x=x===w?w-1:w;for(let _=0;_<x;_++){c=Math.ceil(b/2),u=Math.ceil(A/2);const M=new OffscreenCanvas(c,u);M.getContext("2d").drawImage(t,0,0,b,A,0,0,c,u),b=c,A=u,t!==i&&t.close(),t=M.transferToImageBitmap()}const C=Math.min(l/c,l/u);c=Math.round(c*C),u=Math.round(u*C)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const g=f.getImageData(0,0,c,u).data;return[this.#d(g),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:n,fontWeight:r},l,c,u,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const y=200,b=g.font=`${n} ${r} ${y}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:x,actualBoundingBoxAscent:w,actualBoundingBoxDescent:C,fontBoundingBoxAscent:_,fontBoundingBoxDescent:M,width:T}=g.measureText(t),R=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(x)||0,T)*R),N=Math.ceil(Math.max(Math.abs(w)+Math.abs(C)||y,Math.abs(_)+Math.abs(M)||y)*R);f=new OffscreenCanvas(O,N),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,N),g.fillStyle="black",g.fillText(t,O*(R-1)/2,N*(3-R)/2);const j=this.#d(g.getImageData(0,0,O,N).data),V=this.#o(j),$=this.#h(V),J=this.#a(j,O,N,$);return this.processDrawnLines({lines:{curves:J,width:O,height:N},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,n,r,l){const[c,u,h]=this.#f(t),[f,g]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(g),b=this.#a(f,u,h,y);return this.processDrawnLines({lines:{curves:b,width:u,height:h},pageWidth:i,pageHeight:n,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:n,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([i,n]=[n,i]);const{curves:h,width:f,height:g}=t,y=t.thickness??0,b=[],A=Math.min(i/f,n/g),x=A/i,w=A/n,C=[];for(const{points:M}of h){const T=c?this.#l(M):M;if(!T)continue;C.push(T);const R=T.length,O=new Float32Array(R),N=new Float32Array(3*(R===2?2:R-2));if(b.push({line:N,points:O}),R===2){O[0]=T[0]*x,O[1]=T[1]*w,N.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[j,V,$,J]=T;j*=x,V*=w,$*=x,J*=w,O.set([j,V,$,J],0),N.set([NaN,NaN,NaN,NaN,j,V],0);for(let tt=4;tt<R;tt+=2){const it=O[tt]=T[tt]*x,pt=O[tt+1]=T[tt+1]*w;N.set(nt.createBezierPoints(j,V,$,J,it,pt),(tt-2)*3),[j,V,$,J]=[$,J,it,pt]}}if(b.length===0)return null;const _=u?new ih:new gr;return _.build(b,i,n,1,r,u?0:y,l),{outline:_,newCurves:C,areContours:u,thickness:y,width:f,height:g}}static async compressSignature({outlines:t,areContours:i,thickness:n,width:r,height:l}){let c=1/0,u=-1/0,h=0;for(const T of t){h+=T.length;for(let R=2,O=T.length;R<O;R++){const N=T[R]-T[R-2];c=Math.min(c,N),u=Math.max(u,N)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const g=t.length,y=Gl+Ja*g,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=r,b[A++]=l,b[A++]=i?0:1,b[A++]=Math.max(0,Math.floor(n??0)),b[A++]=g,b[A++]=f.BYTES_PER_ELEMENT;for(const T of t)b[A++]=T.length-2,b[A++]=T[0],b[A++]=T[1];const x=new CompressionStream("deflate-raw"),w=x.writable.getWriter();await w.ready,w.write(b);const C=f.prototype.constructor;for(const T of t){const R=new C(T.length-2);for(let O=2,N=T.length;O<N;O++)R[O-2]=T[O]-T[O-2];w.write(R)}w.close();const _=await new Response(x.readable).arrayBuffer(),M=new Uint8Array(_);return bg(M)}static async decompressSignature(t){try{const i=i0(t),{readable:n,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const T of n)c||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),c.set(T,u),u+=T.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],y=h[3],b=h[4]===0,A=h[5],x=h[6],w=h[7],C=[],_=(Gl+Ja*x)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(w){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(c.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(c.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(c.buffer,_);break}u=0;for(let T=0;T<x;T++){const R=h[Ja*T+Gl],O=new Float32Array(R+2);C.push(O);for(let N=0;N<Ja-1;N++)O[N]=h[Ja*T+Gl+N+1];for(let N=0;N<R;N++)O[N+2]=O[N]+M[u++]}return{areContours:b,thickness:A,outlines:C,width:g,height:y}}catch(i){return gt(`decompressSignature: ${i}`),null}}}class bh extends Yg{constructor(){super(),super.updateProperties({fill:ut._defaultLineColor,"stroke-width":0})}clone(){const t=new bh;return t.updateAll(this),t}}class vh extends no{constructor(t){super(t),super.updateProperties({stroke:ut._defaultLineColor,"stroke-width":1})}clone(){const t=new vh(this._viewParameters);return t.updateAll(this),t}}class Ti extends Bt{#t=!1;#e=null;#s=null;#i=null;static _type="signature";static _editorType=bt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){ut.initialize(t,i),this._defaultDrawingOptions=new bh,this._defaultDrawnSignatureOptions=new vh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return yt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:f}=this.#s,{rawDims:{pageWidth:g,pageHeight:y},rotation:b}=this.parent.viewport,A=qn.processDrawnLines({lines:r,pageWidth:g,pageHeight:y,rotation:b,innerMargin:Ti._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:n,width:r,height:l}=this.#s,c=Math.max(r,l),u=qn.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,n,r){const{x:l,y:c}=this,{outline:u}=this.#s=t;this.#t=u instanceof ih,this.description=n;let h;this.#t?h=Ti.getDefaultDrawingOptions():(h=Ti._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let g=i/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:n},rotation:r}=this.parent.viewport;return qn.process(t,i,n,r,Ti._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:n,pageHeight:r},rotation:l}=this.parent.viewport;return qn.extractContoursFromText(t,i,n,r,l,Ti._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:n},rotation:r}=this.parent.viewport;return qn.processDrawnLines({lines:t,pageWidth:i,pageHeight:n,rotation:r,innerMargin:Ti._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Ti.getDefaultDrawingOptions():(this._drawingOptions=Ti._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:n}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:i,points:n},l.uuid=this.#i,l.isCopy=!0):l.lines=i,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,i,n,r,l,c){return c.areContours?ih.deserialize(t,i,n,r,l,c):gr.deserialize(t,i,n,r,l,c)}static async deserialize(t,i,n){const r=await super.deserialize(t,i,n);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class IA extends ut{#t=null;#e=null;#s=null;#i=null;#r=null;#a="";#n=null;#l=!1;#c=null;#o=!1;#d=!1;static _type="stamp";static _editorType=bt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){ut.initialize(t,i)}static isHandlingMimeForPasting(t){return Yu.includes(t)}static paste(t,i){i.pasteEditor({mode:bt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#o=t.isSvg),t.file&&(this.#a=t.file.name),this.#m()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#n){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await n.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(n).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Yu.join(",");const i=this._uiManager._signal;this.#s=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}n()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#n?.remove(),this.#n=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#n===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#r||this.#e||this.#l)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#l||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:n,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,r&&(this.#t=r),this.#l=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:i,height:n}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,n=this.height*l;else if(i>c*r||n>c*l){const h=Math.min(c*r/i,c*l/n);i*=h,n*=h}this._uiManager.enableWaiting(!1);const u=this.#n=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=n/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,n=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Di;let u=this.#t,h=r,f=l,g=null;if(i){if(r>i||l>i){const N=Math.min(i/r,i/l);h=Math.floor(r*N),f=Math.floor(l*N)}g=document.createElement("canvas");const b=g.width=Math.ceil(h*c.sx),A=g.height=Math.ceil(f*c.sy);this.#o||(u=this.#u(b,A));const x=g.getContext("2d");x.filter=this._uiManager.hcmFilter;let w="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":o0.isDarkMode&&(w="#8f8f9d",C="#42414d");const _=15,M=_*c.sx,T=_*c.sy,R=new OffscreenCanvas(M*2,T*2),O=R.getContext("2d");O.fillStyle=w,O.fillRect(0,0,M*2,T*2),O.fillStyle=C,O.fillRect(0,0,M,T),O.fillRect(M,T,M,T),x.fillStyle=x.createPattern(R,"repeat"),x.fillRect(0,0,b,A),x.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let y=null;if(n){let b,A;if(c.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const C=Math.min(t/r,t/l);b=Math.floor(r*C),A=Math.floor(l*C),this.#o||(u=this.#u(b,A))}const w=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,b,A),y={width:b,height:A,data:w.getImageData(0,0,b,A).data}}return{canvas:g,width:h,height:f,imageData:y}}#u(t,i){const{width:n,height:r}=this.#t;let l=n,c=r,u=this.#t;for(;l>2*t||c>2*i;){const h=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const g=new OffscreenCanvas(l,c);g.getContext("2d").drawImage(u,0,0,h,f,0,0,l,c),u=g.transferToImageBitmap()}return u}#p(){const[t,i]=this.parentDimensions,{width:n,height:r}=this,l=new Di,c=Math.ceil(n*t*l.sx),u=Math.ceil(r*i*l.sy),h=this.#n;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#o?this.#t:this.#u(c,u),g=h.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#o){const[i,n]=this.pageDimensions,r=Math.round(this.width*i*Jn.PDF_TO_CSS_UNITS),l=Math.round(this.height*n*Jn.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,n){let r=null,l=!1;if(t instanceof Vg){const{data:{rect:w,rotation:C,id:_,structParent:M,popupRef:T,richText:R,contentsObj:O,creationDate:N,modificationDate:j},container:V,parent:{page:{pageNumber:$}},canvas:J}=t;let tt,it;J?(delete t.canvas,{id:tt,bitmap:it}=n.imageManager.getFromCanvas(V.id,J),J.remove()):(l=!0,t._hasNoCanvas=!0);const pt=(await i._structTree.getAriaAttributes(`${Vn}${_}`))?.get("aria-label")||"";r=t={annotationType:bt.STAMP,bitmapId:tt,bitmap:it,pageIndex:$-1,rect:w.slice(0),rotation:C,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:pt},isSvg:!1,structParent:M,popupRef:T,richText:R,comment:O?.str||null,creationDate:N,modificationDate:j}}const c=await super.deserialize(t,i,n),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:g,isSvg:y,accessibilityData:b}=t;l?(n.addMissingCanvas(t.id,c),c.#l=!0):g&&n.imageManager.isValidId(g)?(c.#e=g,h&&(c.#t=h)):c.#i=f,c.#o=y;const[A,x]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/x,b&&(c.altTextData=b),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#o});if(this.addComment(n),t)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(n.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(n);return u.isSame?null:(u.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(i===null)return n;i.stamps||=new Map;const c=this.#o?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:n}),n.bitmap=this.#y(!1);else if(this.#o){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return n}#v(t){const{pageIndex:i,accessibilityData:{altText:n}}=this._initialData,r=t.pageIndex===i,l=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Qi{#t;#e=!1;#s=null;#i=null;#r=null;#a=new Map;#n=!1;#l=!1;#c=!1;#o=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([me,yh,IA,se,Ti].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:n,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:g}){const y=[...Qi.#p.values()];if(!Qi._initialized){Qi._initialized=!0;for(const b of y)b.initialize(g,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=i,this.div=n,this.#t=l,this.#s=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===bt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case bt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case bt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case bt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===bt.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const n of Qi.#p.values())i.toggle(`${n._type}Editing`,t===n._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const i=this.#s;if(i)for(const n of i.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const r=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:f}=l,g=this.#m;if(f-g>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const x=new RegExp(`^${ar}[0-9]+$`);for(const C of b)if(x.test(C.id)){A=C.id;break}if(!A)return;const w=this.#a.get(A);w?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),w.dblclick(l))},{signal:r,capture:!0})}const t=this.#s,i=[];if(t){const r=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=l.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of Qi.#p.values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#l=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:n}=xe.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),se.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),ut.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:i,undo:n,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return Qi.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:n,offsetY:r}=this.#_(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:n,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await Qi.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,n={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...n});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#_(){const{x:t,y:i,width:n,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,i+r),f=(l+u)/2-t,g=(c+h)/2-i,[y,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=xe.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#n||(this.#n=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#u.getMode();if(n===bt.STAMP||n===bt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===bt.HIGHLIGHT&&this.enableTextSelection(),this.#n){this.#n=!1;return}const{isMac:i}=xe.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#n=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const n=this.#u.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#o){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#o=new AbortController;const i=this.#u.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#o?(this.#u.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,n){const r=this.#u.findParent(i,n);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Zs(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Zs(this.div,{rotation:n}),i!==n)for(const r of this.#a.values())r.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class we{#t=null;#e=new Map;#s=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return yt(this,"_svgFactory",new Ql)}static#r(t,[i,n,r,l]){const{style:c}=t;c.top=`${100*n}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=we._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#n(t,i){const n=we._svgFactory.createElement("clipPath");t.append(n);const r=`clip_${i}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const l=we._svgFactory.createElement("use");return n.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),r}#l(t,i){for(const[n,r]of Object.entries(i))r===null?t.removeAttribute(n):t.setAttribute(n,r)}draw(t,i=!1,n=!1){const r=we.#i++,l=this.#a(),c=we._svgFactory.createElement("defs");l.append(c);const u=we._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#s.set(r,u);const f=n?this.#n(c,h):null,g=we._svgFactory.createElement("use");return l.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const n=we.#i++,r=this.#a(),l=we._svgFactory.createElement("defs");r.append(l);const c=we._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${n}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const y=we._svgFactory.createElement("mask");l.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=we._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=we._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=we._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return r.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(n,r),n}finalizeDraw(t,i){this.#s.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:n,bbox:r,rootClass:l,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(n&&this.#l(u,n),r&&we.#r(u,r),l){const{classList:h}=u;for(const[f,g]of Object.entries(l))h.toggle(f,g)}if(c){const f=u.firstElementChild.firstElementChild;this.#l(f,c)}}}updateParent(t,i){if(i===this)return;const n=this.#e.get(t);n&&(i.#t.append(n),this.#e.delete(t),i.#e.set(t,n))}remove(t){this.#s.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:th};globalThis.pdfjsLib={AbortException:Cs,AnnotationEditorLayer:Qi,AnnotationEditorParamsType:Mt,AnnotationEditorType:bt,AnnotationEditorUIManager:Ts,AnnotationLayer:gh,AnnotationMode:xs,AnnotationType:ce,applyOpacity:u0,build:yA,ColorPicker:di,createValidAbsoluteUrl:pg,CSSConstants:c0,DOMSVGFactory:Ql,DrawLayer:we,FeatureTest:xe,fetchData:hr,findContrastColor:h0,getDocument:zg,getFilenameFromUrl:s0,getPdfFilenameFromUrl:n0,getRGB:fr,getUuid:yg,getXfaPageViewport:r0,GlobalWorkerOptions:Wn,ImageKind:ql,InvalidPDFException:Vu,isDataScheme:eo,isPdfFile:rh,isValidExplicitDest:S0,MathClamp:De,noContextMenu:pi,normalizeUnicode:t0,OPS:rr,OutputScale:Di,PasswordResponses:Vv,PDFDataRangeTransport:Pg,PDFDateString:Xu,PDFWorker:or,PermissionFlag:qv,PixelsPerInch:Jn,RenderingCancelledException:ah,renderRichText:Ag,ResponseException:Kl,setLayerDimensions:Zs,shadow:yt,SignatureExtractor:qn,stopEvent:te,SupportedImageMimeTypes:Yu,TextLayer:Te,TouchManager:io,updateUrlHash:mg,Util:rt,VerbosityLevel:Zl,version:gA,XfaLayer:vg};const HA="/gaptrack/assets/pdf.worker.min-CXgfMxHN.mjs";Wn.workerSrc=HA;function GA({onParse:p,isProcessing:t,error:i}){const[n,r]=et.useState("upload"),[l,c]=et.useState(""),[u,h]=et.useState(!1),f=et.useRef(null),g=async _=>{const M=await _.arrayBuffer(),T=await zg({data:M}).promise;let R="";for(let O=1;O<=T.numPages;O++){const V=(await(await T.getPage(O)).getTextContent()).items.map($=>$.str).join(" ");R+=V+`
`}return R.trim()},y=async _=>{if(!_)return;if(!["text/plain","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(_.type)&&!_.name.endsWith(".txt")){alert("Please upload a PDF, DOCX, or TXT file");return}try{let T="";if(_.type==="text/plain"||_.name.endsWith(".txt"))T=await _.text();else if(_.type==="application/pdf"){if(T=await g(_),!T.trim()){alert("Could not extract text from this PDF. It may be scanned/image-based. Please try pasting the text instead.");return}}else{alert('DOCX parsing coming soon! For now, please copy the text from your document and use the "Paste Text" tab.');return}T.trim()&&p(T)}catch(T){console.error("Error reading file:",T),alert("Could not read file. Please try pasting the text instead.")}},b=_=>{_.preventDefault(),h(!0)},A=_=>{_.preventDefault(),h(!1)},x=_=>{_.preventDefault(),h(!1);const M=_.dataTransfer.files[0];y(M)},w=_=>{const M=_.target.files[0];y(M)},C=()=>{l.trim()&&p(l)};return t?S.jsx("div",{className:"resume-upload",children:S.jsxs("div",{className:"processing-overlay",children:[S.jsx("div",{className:"spinner"}),S.jsx("p",{className:"text-lg font-bold",children:"Analyzing your resume..."}),S.jsx("p",{className:"text-light",children:"This may take a few seconds"})]})}):S.jsxs("div",{className:"resume-upload",children:[i&&S.jsxs("div",{className:"upload-error",children:[S.jsx("strong",{children:"Error:"})," ",i]}),S.jsxs("div",{className:"upload-tabs",children:[S.jsx("button",{type:"button",className:`upload-tab ${n==="upload"?"active":""}`,onClick:()=>r("upload"),children:"Upload File"}),S.jsx("button",{type:"button",className:`upload-tab ${n==="paste"?"active":""}`,onClick:()=>r("paste"),children:"Paste Text"})]}),n==="upload"&&S.jsxs("div",{className:`drop-zone ${u?"dragging":""}`,onDragOver:b,onDragLeave:A,onDrop:x,onClick:()=>f.current?.click(),children:[S.jsx("span",{className:"drop-zone-icon",children:"+"}),S.jsxs("div",{className:"drop-zone-text",children:[S.jsx("p",{children:"Drop your resume here"}),S.jsx("p",{children:"or click to browse (PDF, TXT)"})]}),S.jsx("input",{type:"file",ref:f,className:"file-input",accept:".txt,.pdf,.docx",onChange:w})]}),n==="paste"&&S.jsxs("div",{className:"paste-area",children:[S.jsx(Yl,{placeholder:`Paste your resume text here...

Example:
John Doe
Software Engineer | john@email.com

EXPERIENCE
Senior Developer at Tech Corp (2020-Present)
- Built scalable microservices
- Led team of 5 developers

SKILLS
JavaScript, React, Node.js, Python`,value:l,onChange:c,rows:12}),S.jsx("p",{className:"paste-hint",children:"Tip: Copy all text from your resume PDF/document and paste above"}),S.jsx("div",{className:"upload-actions",children:S.jsx(ue,{variant:"primary",onClick:C,disabled:!l.trim(),children:"Analyze Resume"})})]})]})}const qA=[{value:"applied",label:"Applied"},{value:"screening",label:"Screening"},{value:"interview",label:"Interview"},{value:"offer",label:"Offer"},{value:"rejected",label:"Rejected"}],VA=200;function XA({job:p,contacts:t=[],resume:i,onSubmit:n,onParseJD:r,analyzeGap:l,isProcessing:c,error:u}){const[h,f]=et.useState(""),[g,y]=et.useState(""),[b,A]=et.useState(""),[x,w]=et.useState(""),[C,_]=et.useState("applied"),[M,T]=et.useState(""),[R,O]=et.useState(""),[N,j]=et.useState(""),[V,$]=et.useState([]),[J,tt]=et.useState(null),[it,pt]=et.useState(!1),[ht,vt]=et.useState(null),[B,G]=et.useState(!1),Z=et.useRef({company:!1,role:!1,location:!1,salary:!1});et.useEffect(()=>{p&&(f(p.company||""),y(p.role||""),A(p.location||""),w(p.salary||""),_(p.status||"applied"),T(p.jobDescription||""),O(p.link||""),j(p.notes||""),$(p.linkedContacts||[]),tt(p.parsedJD||null),vt(p.gapAnalysis||null),pt(!!p.parsedJD))},[p]);const ft=async Q=>{T(Q),Q.length>=VA&&!it&&(pt(!0),setTimeout(async()=>{const Nt=await r(Q);if(Nt.success&&Nt.data&&(St(Nt.data),i&&l)){G(!0);const Rt=await l(i,Nt.data);Rt.success&&vt(Rt.data),G(!1)}},100))},St=Q=>{tt(Q),Q.company&&!Z.current.company&&f(Q.company),Q.role&&!Z.current.role&&y(Q.role),Q.location&&!Z.current.location&&A(Q.location),Q.salary&&!Z.current.salary&&w(Q.salary)},k=Q=>{Z.current.company=!0,f(Q)},H=Q=>{Z.current.role=!0,y(Q)},q=Q=>{Z.current.location=!0,A(Q)},W=Q=>{Z.current.salary=!0,w(Q)},st=Q=>{$(Nt=>Nt.includes(Q)?Nt.filter(Rt=>Rt!==Q):[...Nt,Q])},ot=Q=>{if(Q.preventDefault(),!h.trim()||!g.trim()){alert("Company and Role are required");return}n({id:p?.id,company:h.trim(),role:g.trim(),location:b.trim()||null,salary:x.trim()||null,status:C,jobDescription:M.trim()||null,parsedJD:J,link:R.trim()||null,notes:N.trim()||null,linkedContacts:V,gapAnalysis:ht})};return c&&!B?S.jsx("div",{className:"add-application",children:S.jsxs("div",{className:"add-processing",children:[S.jsx("div",{className:"spinner"}),S.jsx("p",{className:"text-lg font-bold",children:"Analyzing job description..."}),S.jsx("p",{className:"text-light",children:"Extracting requirements and keywords"})]})}):S.jsxs("div",{className:"add-application",children:[u&&S.jsxs("div",{className:"form-error",children:[S.jsx("strong",{children:"Error:"})," ",u]}),S.jsxs("form",{className:"add-form",onSubmit:ot,children:[S.jsxs("div",{className:"form-group jd-input-group",children:[S.jsxs("label",{className:"form-label",children:["Paste Job Description",S.jsx("span",{className:"form-label-hint",children:" - AI will auto-fill the form"})]}),S.jsx(Yl,{placeholder:`Paste the entire job posting here (from LinkedIn, Indeed, etc.)

The AI will automatically extract:
- Company name
- Job title/role
- Location
- Salary (if mentioned)
- Requirements & skills`,value:M,onChange:ft,rows:6}),c&&S.jsxs("div",{className:"auto-parse-status",children:[S.jsx("span",{className:"spinner-small"}),"Extracting job details..."]}),J&&!c&&S.jsx("div",{className:"auto-parse-status success",children:"Job details extracted and filled below"})]}),(ht||B)&&S.jsx("div",{className:"match-preview",children:B?S.jsxs("div",{className:"match-analyzing",children:[S.jsx("span",{className:"spinner-small"}),"Analyzing match..."]}):S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"match-score-large",style:{background:ht.matchScore>=70?"var(--color-success)":ht.matchScore>=50?"var(--color-warning)":"var(--color-error)"},children:[ht.matchScore,"% Match"]}),S.jsx("p",{className:"match-summary",children:ht.summary}),ht.gaps?.length>0&&S.jsx("div",{className:"match-gaps",children:S.jsxs("span",{className:"gaps-count",children:[ht.gaps.length," gap",ht.gaps.length!==1?"s":""," to address"]})})]})}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Company *"}),S.jsx(Ie,{placeholder:"e.g., Google",value:h,onChange:k,required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Role *"}),S.jsx(Ie,{placeholder:"e.g., Senior Software Engineer",value:g,onChange:H,required:!0})]})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Location"}),S.jsx(Ie,{placeholder:"e.g., Remote, San Francisco",value:b,onChange:q})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Salary"}),S.jsx(Ie,{placeholder:"e.g., $150k - $200k",value:x,onChange:W})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Status"}),S.jsx("div",{className:"status-options",children:qA.map(Q=>S.jsx("button",{type:"button",className:`status-option ${C===Q.value?"active":""}`,onClick:()=>_(Q.value),children:Q.label},Q.value))})]}),t.length>0&&S.jsxs("div",{className:"form-group",children:[S.jsxs("label",{className:"form-label",children:["Link Contacts",S.jsx("span",{className:"form-label-hint",children:" - Who to contact for this job"})]}),S.jsx("div",{className:"contact-chips",children:t.map(Q=>S.jsxs("button",{type:"button",className:`contact-chip ${V.includes(Q.id)?"selected":""}`,onClick:()=>st(Q.id),children:[S.jsx("span",{className:"contact-chip-name",children:Q.name}),Q.role&&S.jsx("span",{className:"contact-chip-role",children:Q.role}),Q.linkedin&&S.jsx("span",{className:"contact-chip-linkedin",children:"in"})]},Q.id))})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Job Link (LinkedIn, etc.)"}),S.jsx(Ie,{placeholder:"https://linkedin.com/jobs/view/...",value:R,onChange:O})]}),J&&S.jsxs("div",{className:"jd-preview",children:[S.jsx("p",{className:"jd-preview-title",children:"AI Analysis Results"}),S.jsxs("div",{className:"jd-requirements",children:[J.requirements?.mustHave?.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("h4",{children:"Must Have"}),S.jsx("ul",{className:"must-have",children:J.requirements.mustHave.map((Q,Nt)=>S.jsx("li",{children:Q},Nt))})]}),J.requirements?.niceToHave?.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("h4",{children:"Nice to Have"}),S.jsx("ul",{className:"nice-to-have",children:J.requirements.niceToHave.map((Q,Nt)=>S.jsx("li",{children:Q},Nt))})]}),J.keywords?.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("h4",{children:"Keywords"}),S.jsx("p",{className:"text-sm",children:J.keywords.join(", ")})]})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Notes"}),S.jsx(Yl,{placeholder:"Any notes about this application...",value:N,onChange:j,rows:3})]}),S.jsx("div",{className:"form-actions",children:S.jsx(ue,{type:"submit",variant:"primary",children:p?"Update Application":"Add Application"})})]})]})}function YA({contact:p,onSave:t,onCancel:i}){const[n,r]=et.useState({name:"",email:"",phone:"",company:"",role:"",linkedin:"",notes:""});et.useEffect(()=>{p&&r({name:p.name||"",email:p.email||"",phone:p.phone||"",company:p.company||"",role:p.role||"",linkedin:p.linkedin||"",notes:p.notes||""})},[p]);const l=u=>h=>{r(f=>({...f,[u]:h}))},c=u=>{if(u.preventDefault(),!n.name.trim()){alert("Name is required");return}t(n)};return S.jsxs("form",{className:"contact-form",onSubmit:c,children:[S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Name *"}),S.jsx(Ie,{placeholder:"John Smith",value:n.name,onChange:l("name"),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Role"}),S.jsx(Ie,{placeholder:"Recruiter, Hiring Manager...",value:n.role,onChange:l("role")})]})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Email"}),S.jsx(Ie,{type:"email",placeholder:"john@company.com",value:n.email,onChange:l("email")})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Phone"}),S.jsx(Ie,{placeholder:"+1 555-123-4567",value:n.phone,onChange:l("phone")})]})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Company"}),S.jsx(Ie,{placeholder:"Company name",value:n.company,onChange:l("company")})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"LinkedIn"}),S.jsx(Ie,{placeholder:"linkedin.com/in/username",value:n.linkedin,onChange:l("linkedin")})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Notes"}),S.jsx(Yl,{placeholder:"How you met, conversation topics, follow-up dates...",value:n.notes,onChange:l("notes"),rows:3})]}),S.jsxs("div",{className:"form-actions",children:[S.jsx(ue,{type:"button",variant:"outline",onClick:i,children:"Cancel"}),S.jsx(ue,{type:"submit",variant:"primary",children:p?"Update Contact":"Add Contact"})]})]})}function KA({contact:p,onEdit:t,onDelete:i}){const{name:n,email:r,phone:l,company:c,role:u,linkedin:h,notes:f}=p;return S.jsxs("div",{className:"contact-card",children:[S.jsxs("div",{className:"contact-header",children:[S.jsx("div",{className:"contact-avatar",children:n.charAt(0).toUpperCase()}),S.jsxs("div",{className:"contact-info",children:[S.jsx("h3",{className:"contact-name",children:n}),u&&S.jsx("p",{className:"contact-role",children:u}),c&&S.jsx("p",{className:"contact-company",children:c})]})]}),S.jsxs("div",{className:"contact-details",children:[r&&S.jsx("a",{href:`mailto:${r}`,className:"contact-link",children:r}),l&&S.jsx("a",{href:`tel:${l}`,className:"contact-link",children:l}),h&&S.jsx("a",{href:h.startsWith("http")?h:`https://${h}`,target:"_blank",rel:"noopener noreferrer",className:"contact-link",children:"LinkedIn"})]}),f&&S.jsx("p",{className:"contact-notes",children:f}),S.jsxs("div",{className:"contact-actions",children:[S.jsx(ue,{variant:"outline",size:"sm",onClick:()=>t(p),children:"Edit"}),S.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>i(p.id),children:"Delete"})]})]})}const Iu=[{value:"applied",label:"Applied",color:"var(--color-accent)"},{value:"screening",label:"Screening",color:"var(--color-accent-light)"},{value:"interview",label:"Interview",color:"var(--color-primary-light)"},{value:"offer",label:"Offer",color:"var(--color-success)"},{value:"rejected",label:"Rejected",color:"var(--color-error)"}];function $A({job:p,contacts:t=[],onStatusChange:i,onDelete:n,onEdit:r}){const[l,c]=et.useState(!1),[u,h]=et.useState(!1),{company:f,role:g,location:y,status:b,link:A,gapAnalysis:x,parsedJD:w,linkedContacts:C=[]}=p,_=C.map(N=>t.find(j=>j.id===N)).filter(Boolean),M=x?.matchScore||null,T=N=>N>=70?"var(--color-success)":N>=50?"var(--color-warning)":"var(--color-error)",R=Iu.find(N=>N.value===b)||Iu[0],O=N=>{i(p.id,N),h(!1)};return S.jsxs("div",{className:`job-card ${l?"expanded":""}`,children:[S.jsxs("div",{className:"job-card-header",onClick:()=>c(!l),children:[S.jsxs("div",{className:"job-card-main",children:[S.jsxs("div",{className:"job-card-title",children:[S.jsx("h3",{className:"job-role",children:g}),S.jsx("span",{className:"job-company",children:f})]}),y&&S.jsx("p",{className:"job-location",children:y}),_.length>0&&S.jsxs("div",{className:"job-contacts",children:[_.slice(0,2).map(N=>S.jsxs("span",{className:"job-contact-tag",children:[N.name,N.linkedin&&S.jsx("a",{href:N.linkedin.startsWith("http")?N.linkedin:`https://${N.linkedin}`,target:"_blank",rel:"noopener noreferrer",className:"contact-linkedin-link",onClick:j=>j.stopPropagation(),children:"in"})]},N.id)),_.length>2&&S.jsxs("span",{className:"job-contact-more",children:["+",_.length-2," more"]})]})]}),S.jsxs("div",{className:"job-card-meta",children:[M!==null&&S.jsxs("div",{className:"match-badge",style:{background:T(M)},children:[M,"%"]}),S.jsxs("div",{className:"status-dropdown-wrapper",children:[S.jsxs("button",{className:"status-badge",style:{background:R.color},onClick:N=>{N.stopPropagation(),h(!u)},children:[R.label,S.jsx("span",{className:"dropdown-arrow",children:""})]}),u&&S.jsx("div",{className:"status-dropdown",children:Iu.map(N=>S.jsx("button",{className:`status-option ${N.value===b?"active":""}`,style:{"--status-color":N.color},onClick:j=>{j.stopPropagation(),O(N.value)},children:N.label},N.value))})]}),S.jsx("span",{className:`expand-arrow ${l?"expanded":""}`,children:""})]})]}),l&&S.jsxs("div",{className:"job-card-details",children:[x?S.jsxs(S.Fragment,{children:[x.summary&&S.jsx("p",{className:"gap-summary",children:x.summary}),S.jsxs("div",{className:"gap-columns",children:[x.strengths?.length>0&&S.jsxs("div",{className:"gap-section strengths",children:[S.jsx("h4",{children:"Your Strengths"}),S.jsx("ul",{children:x.strengths.map((N,j)=>S.jsxs("li",{children:[S.jsx("strong",{children:N.skill}),N.relevance&&S.jsx("span",{children:N.relevance})]},j))})]}),x.gaps?.length>0&&S.jsxs("div",{className:"gap-section gaps",children:[S.jsx("h4",{children:"Gaps to Address"}),S.jsx("ul",{children:x.gaps.map((N,j)=>S.jsxs("li",{children:[S.jsx("strong",{children:N.requirement}),N.suggestion&&S.jsx("span",{children:N.suggestion})]},j))})]})]}),w?.requirements&&S.jsxs("div",{className:"requirements-section",children:[S.jsx("h4",{children:"Requirements"}),S.jsxs("div",{className:"requirements-lists",children:[w.requirements.mustHave?.length>0&&S.jsxs("div",{children:[S.jsx("strong",{children:"Must Have:"}),S.jsx("span",{children:w.requirements.mustHave.join(", ")})]}),w.requirements.niceToHave?.length>0&&S.jsxs("div",{children:[S.jsx("strong",{children:"Nice to Have:"}),S.jsx("span",{children:w.requirements.niceToHave.join(", ")})]})]})]})]}):S.jsx("p",{className:"no-analysis",children:"No gap analysis available. Add a resume to see how you match."}),S.jsxs("div",{className:"job-card-actions",children:[A&&S.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"action-btn",onClick:N=>N.stopPropagation(),children:"Open Link"}),S.jsx("button",{className:"action-btn",onClick:N=>{N.stopPropagation(),r(p)},children:"Edit"}),S.jsx("button",{className:"action-btn danger",onClick:N=>{N.stopPropagation(),window.confirm("Delete this application?")&&n(p.id)},children:"Delete"})]})]})]})}const cg=[{id:"applied",label:"Applied",color:"var(--color-accent)"},{id:"screening",label:"Screening",color:"var(--color-accent-light)"},{id:"interview",label:"Interview",color:"var(--color-primary-light)"},{id:"offer",label:"Offer",color:"var(--color-success)"},{id:"rejected",label:"Rejected",color:"var(--color-error)"}];function QA({jobs:p,contacts:t=[],onStatusChange:i,onDeleteJob:n,onEditJob:r}){const[l,c]=et.useState(null),[u,h]=et.useState(null),f=cg.reduce((_,M)=>(_[M.id]=p.filter(T=>T.status===M.id),_),{}),g=_=>!_.linkedContacts||_.linkedContacts.length===0?[]:_.linkedContacts.map(M=>t.find(T=>T.id===M)).filter(Boolean),y=(_,M)=>{c(M),_.dataTransfer.effectAllowed="move"},b=(_,M)=>{_.preventDefault(),_.dataTransfer.dropEffect="move",h(M)},A=()=>{h(null)},x=(_,M)=>{_.preventDefault(),l&&l.status!==M&&i(l.id,M),c(null),h(null)},w=()=>{c(null),h(null)},C=_=>_>=70?"var(--color-success)":_>=50?"var(--color-warning)":"var(--color-error)";return S.jsx("div",{className:"kanban-board",children:cg.map(_=>S.jsxs("div",{className:`kanban-column ${u===_.id?"drag-over":""}`,onDragOver:M=>b(M,_.id),onDragLeave:A,onDrop:M=>x(M,_.id),children:[S.jsxs("div",{className:"column-header",style:{borderBottomColor:_.color},children:[S.jsx("span",{className:"column-title",children:_.label}),S.jsx("span",{className:"column-count",children:f[_.id].length})]}),S.jsxs("div",{className:"column-cards",children:[f[_.id].map(M=>{const T=g(M);return S.jsxs("div",{className:`kanban-card ${l?.id===M.id?"dragging":""}`,draggable:!0,onDragStart:R=>y(R,M),onDragEnd:w,onClick:()=>r(M),children:[S.jsxs("div",{className:"kanban-card-header",children:[S.jsx("span",{className:"kanban-company",children:M.company}),M.gapAnalysis?.matchScore&&S.jsxs("span",{className:"kanban-score",style:{background:C(M.gapAnalysis.matchScore)},children:[M.gapAnalysis.matchScore,"%"]})]}),S.jsx("h4",{className:"kanban-role",children:M.role}),M.location&&S.jsx("p",{className:"kanban-location",children:M.location}),T.length>0&&S.jsxs("div",{className:"kanban-contacts",children:[T.slice(0,2).map(R=>S.jsxs("span",{className:"contact-tag",children:[R.name,R.linkedin&&S.jsx("span",{className:"contact-linkedin-badge",children:"in"})]},R.id)),T.length>2&&S.jsxs("span",{className:"contact-more",children:["+",T.length-2]})]})]},M.id)}),f[_.id].length===0&&S.jsx("div",{className:"column-empty",children:"Drop here"})]})]},_.id))})}function WA({jobs:p,contacts:t=[],viewMode:i,onAddJob:n,onStatusChange:r,onDeleteJob:l,onEditJob:c}){return!p||p.length===0?S.jsxs("div",{className:"jobs-empty",children:[S.jsx("div",{className:"empty-icon",children:"+"}),S.jsx("h2",{children:"No jobs yet"}),S.jsx("p",{children:"Add your first job application to start tracking"}),S.jsx(ue,{variant:"primary",size:"lg",onClick:n,children:"Add Job"})]}):i==="kanban"?S.jsxs("div",{className:"jobs-view",children:[S.jsxs("div",{className:"jobs-header",children:[S.jsxs("h2",{children:[p.length," Application",p.length!==1?"s":""]}),S.jsx(ue,{variant:"primary",onClick:n,children:"+ Add Job"})]}),S.jsx(QA,{jobs:p,contacts:t,onStatusChange:r,onDeleteJob:l,onEditJob:c})]}):S.jsxs("div",{className:"jobs-view",children:[S.jsxs("div",{className:"jobs-header",children:[S.jsxs("h2",{children:[p.length," Application",p.length!==1?"s":""]}),S.jsx(ue,{variant:"primary",onClick:n,children:"+ Add Job"})]}),S.jsx("div",{className:"jobs-list",children:p.map(u=>S.jsx($A,{job:u,contacts:t,onStatusChange:r,onDelete:l,onEdit:c},u.id))})]})}function ZA({resume:p,contacts:t,onUpdateResume:i,onAddContact:n,onEditContact:r,onDeleteContact:l}){const[c,u]=et.useState("summary");return S.jsxs("div",{className:"profile-view",children:[S.jsxs("section",{className:"profile-section",children:[S.jsxs("div",{className:"section-header",children:[S.jsx("h2",{children:"Resume"}),S.jsxs("div",{className:"section-actions",children:[p&&S.jsxs("div",{className:"view-toggle-small",children:[S.jsx("button",{className:c==="summary"?"active":"",onClick:()=>u("summary"),children:"Summary"}),S.jsx("button",{className:c==="full"?"active":"",onClick:()=>u("full"),children:"Full"})]}),S.jsx(ue,{variant:"secondary",size:"sm",onClick:i,children:p?"Update":"Upload Resume"})]})]}),p?S.jsx(fi,{padding:"md",className:"resume-card",children:c==="summary"?S.jsxs("div",{className:"resume-summary",children:[S.jsxs("div",{className:"summary-row",children:[S.jsx("span",{className:"summary-label",children:"Skills"}),S.jsxs("span",{className:"summary-value",children:[p.skills?.slice(0,8).map(h=>typeof h=="string"?h:h.name).join(", "),p.skills?.length>8&&` +${p.skills.length-8} more`]})]}),p.experience?.length>0&&S.jsxs("div",{className:"summary-row",children:[S.jsx("span",{className:"summary-label",children:"Experience"}),S.jsxs("span",{className:"summary-value",children:[p.experience.length," position",p.experience.length!==1?"s":"",p.yearsOfExperience&&` (${p.yearsOfExperience} years)`]})]}),p.parsedAt&&S.jsxs("div",{className:"summary-row",children:[S.jsx("span",{className:"summary-label",children:"Updated"}),S.jsx("span",{className:"summary-value",children:new Date(p.parsedAt).toLocaleDateString()})]})]}):S.jsxs("div",{className:"resume-full",children:[p.skills?.length>0&&S.jsxs("div",{className:"resume-section",children:[S.jsx("h4",{children:"Skills"}),S.jsx("div",{className:"skill-tags",children:p.skills.map((h,f)=>S.jsxs("span",{className:"skill-tag",children:[typeof h=="string"?h:h.name,h.level&&S.jsxs("em",{children:[" (",h.level,")"]})]},f))})]}),p.experience?.length>0&&S.jsxs("div",{className:"resume-section",children:[S.jsx("h4",{children:"Experience"}),p.experience.map((h,f)=>S.jsxs("div",{className:"experience-item",children:[S.jsx("strong",{children:h.title||h.role}),h.company&&S.jsxs("span",{children:[" at ",h.company]}),(h.startDate||h.duration)&&S.jsx("span",{className:"experience-date",children:h.startDate&&h.endDate?`${h.startDate} - ${h.endDate}`:h.duration}),h.description&&S.jsx("p",{className:"experience-desc",children:h.description})]},f))]}),p.education?.length>0&&S.jsxs("div",{className:"resume-section",children:[S.jsx("h4",{children:"Education"}),p.education.map((h,f)=>S.jsxs("div",{className:"education-item",children:[S.jsx("strong",{children:h.degree||h.field}),h.school&&S.jsxs("span",{children:[" - ",h.school]}),h.year&&S.jsxs("span",{className:"education-year",children:[" (",h.year,")"]})]},f))]}),p.certifications?.length>0&&S.jsxs("div",{className:"resume-section",children:[S.jsx("h4",{children:"Certifications"}),S.jsx("ul",{className:"cert-list",children:p.certifications.map((h,f)=>S.jsx("li",{children:typeof h=="string"?h:h.name},f))})]})]})}):S.jsxs(fi,{padding:"lg",className:"resume-empty",children:[S.jsx("div",{className:"empty-icon",children:"+"}),S.jsx("h3",{children:"No resume uploaded"}),S.jsx("p",{children:"Upload your resume to see how you match with jobs"}),S.jsx(ue,{variant:"primary",onClick:i,children:"Upload Resume"})]})]}),S.jsxs("section",{className:"profile-section",children:[S.jsxs("div",{className:"section-header",children:[S.jsx("h2",{children:"Contacts"}),S.jsx(ue,{variant:"secondary",size:"sm",onClick:n,children:"+ Add Contact"})]}),t?.length>0?S.jsx("div",{className:"contacts-grid",children:t.map(h=>S.jsx(KA,{contact:h,onEdit:r,onDelete:l},h.id))}):S.jsxs(fi,{padding:"md",className:"contacts-empty",children:[S.jsx("p",{children:"No contacts yet. Add recruiters and hiring managers to track."}),S.jsx(ue,{variant:"outline",size:"sm",onClick:n,children:"Add First Contact"})]})]})]})}function JA(){const{data:p,isLoading:t,error:i,needsSetup:n,setupFileStorage:r,openExistingFile:l,updateAndSave:c,addApplication:u,isFileSystemSupported:h}=Rv(),{parseResume:f,parseJobDescription:g,analyzeGap:y,isProcessing:b,error:A}=fg(p?.settings),[x,w]=et.useState("jobs"),[C,_]=et.useState("list"),[M,T]=et.useState(!1),[R,O]=et.useState(!1),[N,j]=et.useState(!1),[V,$]=et.useState(!1),[J,tt]=et.useState(null),[it,pt]=et.useState(null),ht=async q=>{console.log("Starting resume parse, text length:",q.length);const W=await f(q);console.log("Parse result:",W),W.success?(await c("resume",{...W.data,rawText:q,parsedAt:new Date().toISOString()}),j(!1)):(console.error("Resume parse failed:",W.error),alert("Failed to parse resume: "+(W.error||"Unknown error")))},vt=async q=>{let W=null;if(p?.resume&&q.parsedJD){const st=await y(p.resume,q.parsedJD);st.success&&(W=st.data)}await u({...q,gapAnalysis:W}),O(!1),pt(null)},B=async q=>g(q),G=async(q,W)=>{const ot=(p?.applications||[]).map(Q=>Q.id===q?{...Q,status:W,updatedAt:new Date().toISOString()}:Q);await c("applications",ot)},Z=async q=>{if(window.confirm("Delete this application?")){const W=(p?.applications||[]).filter(st=>st.id!==q);await c("applications",W)}},ft=async q=>{pt(q),O(!0)},St=async(q,W)=>{const ot=(p?.applications||[]).map(Q=>Q.id===q?{...Q,...W,updatedAt:new Date().toISOString()}:Q);await c("applications",ot)},k=async q=>{const W=p?.contacts||[];if(J){const st=W.map(ot=>ot.id===J.id?{...ot,...q,updatedAt:new Date().toISOString()}:ot);await c("contacts",st)}else{const st={...q,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await c("contacts",[...W,st])}$(!1),tt(null)},H=async q=>{if(window.confirm("Delete this contact?")){const W=(p?.contacts||[]).filter(st=>st.id!==q);await c("contacts",W)}};if(t)return S.jsxs("div",{className:"app",children:[S.jsx(Hu,{}),S.jsx(Nu,{children:S.jsx(fi,{padding:"lg",className:"text-center",children:S.jsx("p",{className:"text-lg",children:"Loading..."})})})]});if(n)return S.jsxs("div",{className:"app",children:[S.jsx(Hu,{}),S.jsx(Nu,{size:"sm",children:S.jsxs(fi,{padding:"lg",children:[S.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Welcome to GapTrack!"}),S.jsx("p",{className:"text-light mb-6",children:"Your data stays on your computer. Choose where to save it:"}),i&&S.jsx("div",{className:"mb-4 p-4 text-error",style:{background:"var(--color-error-light)",borderRadius:"var(--radius-md)"},children:i}),h?S.jsxs("div",{className:"flex flex-col gap-4",children:[S.jsx(ue,{variant:"primary",size:"lg",className:"w-full",onClick:r,children:"Create New Save File"}),S.jsx(ue,{variant:"secondary",size:"lg",className:"w-full",onClick:l,children:"Open Existing File"}),S.jsxs("p",{className:"text-sm text-light text-center mt-4",children:["Your data is saved to a JSON file you control.",S.jsx("br",{}),"Put it in Google Drive, iCloud or Dropbox to sync across devices."]})]}):S.jsxs("div",{className:"flex flex-col gap-4",children:[S.jsx("p",{className:"text-sm text-light",children:"Your browser doesn't support the File System API. Data will be saved in your browser's local storage."}),S.jsx(ue,{variant:"primary",size:"lg",className:"w-full",onClick:r,children:"Get Started"})]})]})})]});if(!p?.settings?.aiProvider){const q=async W=>{await c("settings",W)};return S.jsxs("div",{className:"app",children:[S.jsx(Hu,{}),S.jsx(Nu,{size:"sm",children:S.jsx(fi,{padding:"lg",children:S.jsx(jm,{settings:p?.settings,onSave:q})})})]})}return S.jsxs(Tv,{currentView:x,onNavigate:w,onOpenSettings:()=>T(!0),resumeExists:!!p?.resume,applicationCount:p?.applications?.length||0,viewMode:C,onViewModeChange:_,children:[x==="jobs"&&S.jsx(WA,{jobs:p?.applications||[],contacts:p?.contacts||[],viewMode:C,onAddJob:()=>{pt(null),O(!0)},onStatusChange:G,onDeleteJob:Z,onEditJob:ft,onUpdateJob:St}),x==="profile"&&S.jsx(ZA,{resume:p?.resume,contacts:p?.contacts||[],onUpdateResume:()=>j(!0),onAddContact:()=>{tt(null),$(!0)},onEditContact:q=>{tt(q),$(!0)},onDeleteContact:H}),S.jsx(tr,{isOpen:N,onClose:()=>j(!1),title:"Upload Resume",size:"lg",children:S.jsx(GA,{onParse:ht,isProcessing:b,error:A})}),S.jsx(tr,{isOpen:V,onClose:()=>{$(!1),tt(null)},title:J?"Edit Contact":"Add Contact",size:"md",children:S.jsx(YA,{contact:J,onSave:k,onCancel:()=>{$(!1),tt(null)}})}),S.jsx(tr,{isOpen:R,onClose:()=>{O(!1),pt(null)},title:it?"Edit Application":"Add Application",size:"lg",children:S.jsx(XA,{job:it,contacts:p?.contacts||[],resume:p?.resume,onSubmit:vt,onParseJD:B,analyzeGap:y,isProcessing:b,error:A})}),S.jsx(tr,{isOpen:M,onClose:()=>T(!1),title:"AI Settings",size:"md",children:S.jsx(jm,{settings:p?.settings,onSave:async q=>{await c("settings",q),T(!1)}})})]})}function Hu(){return S.jsxs("header",{className:"text-center p-8",children:[S.jsx("h1",{className:"text-4xl font-display uppercase text-inverse",children:"GapTrack"}),S.jsx("p",{className:"text-lg text-inverse mt-2",children:"AI-powered job application tracker"})]})}Cv.createRoot(document.getElementById("root")).render(S.jsx(et.StrictMode,{children:S.jsx(JA,{})}));
